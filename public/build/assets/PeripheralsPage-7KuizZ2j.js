import{r as j,j as e,L as I,R as O,a as y}from"./app-BdGx2X0T.js";import{B as m}from"./button-C0-2xfes.js";import{C as V,a as M}from"./card-_0ogs2YA.js";import{S as $,a as H,b as U,c as q}from"./avatar-CLlMTQWK.js";import{S as k}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{N as K}from"./Notification-CMlLXP0_.js";import{T as X,a as Y,b as w,c as o,d as G,e as a}from"./table-Bg2kyTN2.js";import{B as J,a as Q,b as W,c as E,d as Z}from"./breadcrumb-DwOvr2qq.js";import{A as ee}from"./app-sidebar-CYBVYhy6.js";import{I as re}from"./input-CzzdLosd.js";import se from"./EditPeripheralModal-BOtgHUnE.js";import{P as le,a as ie,b as ne,S as f,c as b,d as v,e as g,f as n}from"./select-D8rV8Fiw.js";import{F as te}from"./funnel-DEYVzH9D.js";import{X as ae}from"./index-DnNXT5lu.js";import"./index-Dmx73SBc.js";import"./index-BrDiuL1I.js";import"./createLucideIcon-Bpqk_Xnu.js";import"./index-cmw4DGXn.js";import"./dropdown-menu-C6_C5jz3.js";import"./index-D9iplL8v.js";import"./chevron-right-Dx8nbVNV.js";import"./index-SDV-gwQA.js";import"./sparkles-Ug-xBo4R.js";import"./user-B7V3IuMm.js";import"./dialog-CQww-v0p.js";import"./label-UVI62JdK.js";import"./index-Ddm0PL9t.js";function oe({filters:i,filterOptions:u,onApplyFilters:c}){const[h,p]=j.useState(""),x=()=>{const s={type:void 0,condition:void 0,room_id:void 0,unit_code:void 0};p(""),c(s)};return e.jsxs(le,{children:[e.jsx(ie,{asChild:!0,children:e.jsxs(m,{variant:"outline",size:"sm",children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),"Filters"]})}),e.jsx(ne,{className:"w-72",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(f,{value:h,onValueChange:p,children:[e.jsx(b,{children:e.jsx(v,{placeholder:"Select filter field"})}),e.jsxs(g,{children:[e.jsx(n,{value:"type",children:"Type"}),e.jsx(n,{value:"condition",children:"Condition"}),e.jsx(n,{value:"room",children:"Room"}),e.jsx(n,{value:"unit",children:"Unit"})]})]}),h==="type"&&e.jsxs(f,{value:i.type||"all",onValueChange:s=>c({...i,type:s==="all"?void 0:s}),children:[e.jsx(b,{children:e.jsx(v,{placeholder:"Select Type"})}),e.jsxs(g,{children:[e.jsx(n,{value:"all",children:"All"}),u.types.map(s=>e.jsx(n,{value:s,children:s},s))]})]}),h==="condition"&&e.jsxs(f,{value:i.condition||"all",onValueChange:s=>c({...i,condition:s==="all"?void 0:s}),children:[e.jsx(b,{children:e.jsx(v,{placeholder:"Select Condition"})}),e.jsxs(g,{children:[e.jsx(n,{value:"all",children:"All"}),u.conditions.map(s=>e.jsx(n,{value:s,children:s},s))]})]}),h==="room"&&e.jsxs(f,{value:i.room_id||"all",onValueChange:s=>c({...i,room_id:s==="all"?void 0:s}),children:[e.jsx(b,{children:e.jsx(v,{placeholder:"Select Room"})}),e.jsxs(g,{children:[e.jsx(n,{value:"all",children:"All"}),Object.entries(u.rooms).map(([s,C])=>e.jsxs(n,{value:s,children:["Room ",C]},s))]})]}),h==="unit"&&e.jsxs(f,{value:i.unit_code||"all",onValueChange:s=>c({...i,unit_code:s==="all"?void 0:s}),children:[e.jsx(b,{children:e.jsx(v,{placeholder:"Select Unit"})}),e.jsxs(g,{children:[e.jsx(n,{value:"all",children:"All"}),u.units.map(s=>e.jsx(n,{value:s,children:s},s))]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(m,{size:"sm",variant:"outline",onClick:x,className:"flex items-center gap-1",children:[e.jsx(ae,{className:"h-4 w-4"}),"Reset All"]})})]})})]})}const ce=[{label:"Functional",color:"bg-green-500"},{label:"Defective",color:"bg-red-500"},{label:"Intermittent Issue",color:"bg-yellow-500"},{label:"Needs Cleaning",color:"bg-blue-500"},{label:"For Replacement",color:"bg-orange-500"},{label:"For Disposal",color:"bg-gray-500"}];function Fe({peripherals:i,search:u,existingRooms:c,existingUnits:h,filters:p={}}){const[x,s]=j.useState(u||""),[C,_]=j.useState(null),[t,P]=j.useState(1),N=10,z=j.useMemo(()=>{const r=l=>[...new Set(l.filter(d=>d))].sort();return{types:r(i.map(l=>l.type)),conditions:r(i.map(l=>l.condition)),rooms:Object.fromEntries(c.map(l=>[String(l.id),l.room_number])),units:r(i.map(l=>l.unit_code))}},[i,c]);function T(r){const l=Object.fromEntries(Object.entries({...r,search:x||void 0}).filter(([,d])=>d!==""&&d!==void 0));y.get("/admin/peripherals",l,{preserveState:!0,replace:!0})}function D(){s(""),y.get("/admin/peripherals",{},{preserveState:!0,replace:!0})}const F=r=>{r.key==="Enter"&&T(p)},B=j.useMemo(()=>{if(!x)return i;const r=x.toLowerCase();return i.filter(l=>[l.peripheral_code,l.type,l.serial_number,l.condition,l.room?.room_number,l.unit_code].filter(Boolean).some(d=>d.toLowerCase().includes(r)))},[i,x]),S=Math.ceil(B.length/N)||1,A=B.slice((t-1)*N,t*N);function L(r){k.fire({title:"Are you sure?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(l=>{l.isConfirmed&&y.delete(`/admin/peripherals/${r}`,{onSuccess:()=>{k.fire({icon:"success",title:"Deleted!",text:"Peripheral deleted successfully.",timer:2e3,showConfirmButton:!1})}})})}function R(r){return ce.find(l=>l.label.toLowerCase()===r?.toLowerCase())||{label:r,color:"bg-slate-400"}}return e.jsxs($,{children:[e.jsx(ee,{}),e.jsxs(H,{children:[e.jsx("header",{className:"sticky top-0 z-20 bg-white border-b px-6 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{}),e.jsx(q,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(J,{children:e.jsx(Q,{children:e.jsxs(W,{children:[e.jsx(E,{href:"#","aria-current":"page",children:"Assets"}),e.jsx(Z,{}),e.jsx(E,{href:"/admin/peripherals","aria-current":"page",className:"font-semibold text-foreground",children:"Peripherals"})]})})}),e.jsx("div",{className:"flex-1"}),e.jsx(K,{})]})}),e.jsx("main",{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-5",children:"Peripherals"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(oe,{filters:p,filterOptions:z,onApplyFilters:T,onReset:D}),e.jsx(re,{placeholder:"Search peripherals...",value:x,onChange:r=>s(r.target.value),onKeyDown:F,className:"w-64"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(I,{href:"/admin/peripherals/create",children:e.jsx(m,{children:"Add Peripheral"})})})]}),e.jsx(V,{children:e.jsxs(M,{children:[e.jsxs(X,{children:[e.jsx(Y,{children:e.jsxs(w,{children:[e.jsx(o,{children:"#"}),e.jsx(o,{children:"Peripheral Code"}),e.jsx(o,{children:"Type"}),e.jsx(o,{children:"Room"}),e.jsx(o,{children:"Units"}),e.jsx(o,{children:"Brand"}),e.jsx(o,{children:"Model"}),e.jsx(o,{children:"Serial Number"}),e.jsx(o,{children:"Condition"}),e.jsx(o,{children:"Actions"})]})}),e.jsx(G,{children:A.length>0?A.map((r,l)=>e.jsxs(w,{children:[e.jsx(a,{children:(t-1)*N+l+1}),e.jsx(a,{children:r.peripheral_code}),e.jsx(a,{children:r.type}),e.jsx(a,{children:r.room?`ROOM ${r.room.room_number}`:"N/A"}),e.jsx(a,{children:r.unit?r.unit.unit_code:"N/A"}),e.jsx(a,{children:r.brand}),e.jsx(a,{children:r.model}),e.jsx(a,{children:r.serial_number}),e.jsx(a,{children:r.condition?e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium text-white ${R(r.condition).color}`,children:R(r.condition).label}):"N/A"}),e.jsxs(a,{className:"space-x-2",children:[e.jsx(I,{href:`/admin/peripherals/${r.id}`,children:e.jsx(m,{variant:"secondary",size:"sm",children:"View"})}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>_(r),children:"Edit"}),e.jsx(m,{variant:"destructive",size:"sm",onClick:()=>L(r.id),children:"Delete"})]})]},r.id)):e.jsx(w,{children:e.jsx(a,{colSpan:"8",className:"text-center",children:"No peripherals found."})})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",t," of ",S]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{size:"sm",variant:"outline",disabled:t===1,onClick:()=>P(t-1),children:"Previous"}),Array.from({length:S},(r,l)=>l+1).filter(r=>r===1||r===S?!0:r>=t-2&&r<=t+2).map((r,l,d)=>e.jsxs(O.Fragment,{children:[l>0&&d[l]-d[l-1]>1&&e.jsx("span",{className:"px-2",children:"..."}),e.jsx(m,{size:"sm",variant:t===r?"default":"outline",onClick:()=>P(r),children:r})]},r)),e.jsx(m,{size:"sm",variant:"outline",disabled:t===S,onClick:()=>P(t+1),children:"Next"})]})]})]})})]})}),C&&e.jsx(se,{peripheral:C,rooms:c,units:h,onClose:()=>_(null)})]})]})}export{Fe as default};
