import{r as v,j as e,L as P,b as N}from"./app-CWC0bpof.js";import{B as u}from"./button-aNfch2jA.js";import{C as B,a as k}from"./card--kQ8u1ak.js";import{S as V,a as D,b as I,c as E}from"./index-B7hcqN0Y.js";import{S as z}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{T as L,a as q,b as _,c,d as O,e as n}from"./table-C68DV-XP.js";import{B as H,a as M,b as F,c as R,d as $}from"./breadcrumb-9SjAWATG.js";import{A as K}from"./app-sidebar-DPNnAKfW.js";import{I as U}from"./input-WWtXY93I.js";import{P as X,a as Y,F as G,b as J,S as j,c as b,d as f,e as y,f as x}from"./select-D_tpQaFO.js";import{X as Q}from"./index-DySz9kAo.js";import"./index-BPU2-vgW.js";import"./index-CtiwVrLH.js";import"./index-ODbjVI-n.js";import"./dropdown-menu-DkN7cKsI.js";import"./index-Bi2mbzM4.js";import"./chevron-right-C2OYrkf8.js";import"./index-BJV9HLPs.js";import"./index-DwVepA8B.js";function W({filters:s,filterOptions:p,onApplyFilters:g}){const[o,d]=v.useState(""),[r,t]=v.useState("");v.useEffect(()=>{s.condition?(d("condition"),t(s.condition)):s.room?(d("room"),t(s.room)):s.faculty?(d("faculty"),t(s.faculty)):s.reportable_type?(d("reportable_type"),t(s.reportable_type)):(d(""),t(""))},[s]);const m=a=>{const i=a==="all"?"":a;t(i);let C={...s};o&&(C[o]=i),g(C)},S=[{value:"condition",label:"Condition"},{value:"room",label:"Room"},{value:"faculty",label:"Faculty"},{value:"reportable_type",label:"Report Type"}];return e.jsxs(X,{children:[e.jsx(Y,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4"}),"Filter",(s.condition||s.room||s.faculty||s.reportable_type)&&e.jsx(Q,{className:"h-4 w-4 ml-1 cursor-pointer",onClick:a=>{a.stopPropagation(),a.preventDefault(),d(""),t(""),g({})}})]})}),e.jsxs(J,{className:"w-[calc(100vw-2rem)] sm:w-[400px] p-4",children:[e.jsx("h4",{className:"font-medium mb-3 text-lg",children:"Filter Options"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs(j,{value:o,onValueChange:a=>{d(a),t("")},children:[e.jsx(b,{className:"w-full",children:e.jsx(f,{placeholder:"Select Field"})}),e.jsx(y,{children:S.map(a=>e.jsx(x,{value:a.value,children:a.label},a.value))})]}),o==="condition"&&e.jsxs(j,{value:r||"all",onValueChange:m,children:[e.jsx(b,{className:"w-full",children:e.jsx(f,{placeholder:"Select Condition"})}),e.jsxs(y,{children:[e.jsx(x,{value:"all",children:"All"}),p.conditions.map((a,i)=>e.jsx(x,{value:a,children:a},i))]})]}),o==="room"&&e.jsxs(j,{value:r||"all",onValueChange:m,children:[e.jsx(b,{className:"w-full",children:e.jsx(f,{placeholder:"Select Room"})}),e.jsxs(y,{children:[e.jsx(x,{value:"all",children:"All"}),Object.entries(p.rooms).map(([a,i])=>e.jsxs(x,{value:a,children:["Room ",i]},a))]})]}),o==="faculty"&&e.jsxs(j,{value:r||"all",onValueChange:m,children:[e.jsx(b,{className:"w-full",children:e.jsx(f,{placeholder:"Select Faculty"})}),e.jsxs(y,{children:[e.jsx(x,{value:"all",children:"All"}),Object.entries(p.faculties).map(([a,i])=>e.jsx(x,{value:a,children:i},a))]})]}),o==="reportable_type"&&e.jsxs(j,{value:r||"all",onValueChange:m,children:[e.jsx(b,{className:"w-full",children:e.jsx(f,{placeholder:"Select Type"})}),e.jsxs(y,{children:[e.jsx(x,{value:"all",children:"All"}),p.reportable_types.map(a=>e.jsx(x,{value:a,children:a},a))]})]})]})]})]})}function ye({reports:s,filters:p={},filterOptions:g}){const[o,d]=v.useState(p.search||""),[r,t]=v.useState(1),m=10,S=Math.ceil(s.length/m),a=s.slice((r-1)*m,r*m);function i(l){const h=Object.fromEntries(Object.entries(l).filter(([Z,w])=>w!==""&&w!==void 0));N.get("/faculty/reports",{...h,search:o||void 0})}function C(){d(""),N.get(route("admin.reports.index"))}function T(l){l.key==="Enter"&&i(p)}function A(l){z.fire({title:"Are you sure?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!"}).then(h=>{h.isConfirmed&&N.delete(`/admin/faculty-reports/${l}`)})}return e.jsxs(V,{children:[e.jsx(K,{}),e.jsxs(D,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx(I,{}),e.jsx(E,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(H,{children:e.jsxs(M,{children:[e.jsx(F,{children:e.jsx(R,{href:"#",children:"Reports"})}),e.jsx($,{}),e.jsx(F,{children:e.jsx(R,{href:"/admin/faculty-reports",className:"font-semibold text-foreground",children:"Faculty Reports"})})]})})]}),e.jsx("main",{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-5",children:"Faculty Reports"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-4",children:[e.jsx(W,{filters:p,filterOptions:g,onApplyFilters:i,onResetFilters:C}),e.jsx(U,{placeholder:"Search reports...",value:o,onChange:l=>d(l.target.value),onKeyDown:T,className:"flex-1 min-w-0 sm:max-w-xs w-full"})]}),e.jsx(B,{children:e.jsxs(k,{children:[e.jsxs(L,{children:[e.jsx(q,{children:e.jsxs(_,{children:[e.jsx(c,{children:"#"}),e.jsx(c,{children:"Faculty"}),e.jsx(c,{children:"Reports Type"}),e.jsx(c,{children:"Reports ID"}),e.jsx(c,{children:"Type"}),e.jsx(c,{children:"Code"}),e.jsx(c,{children:"Condition"}),e.jsx(c,{children:"Remarks"}),e.jsx(c,{children:"Room"}),e.jsx(c,{children:"Date"}),e.jsx(c,{children:"Actions"})]})}),e.jsx(O,{children:a.length>0?a.map((l,h)=>e.jsxs(_,{children:[e.jsx(n,{children:(r-1)*m+h+1}),e.jsx(n,{children:l.user?.name||"N/A"}),e.jsx(n,{children:l.reportable_type}),e.jsx(n,{children:l.reportable_id}),e.jsx(n,{children:l.reportable_type==="peripheral"?l.reportable?.type:l.reportable_type==="system_unit"?"System Unit":l.reportable_type==="equipment"?l.reportable?.equipment_type:"N/A"}),e.jsx(n,{children:l.reportable_type==="peripheral"?l.reportable?.peripheral_code:l.reportable_type==="system_unit"?l.reportable?.unit_code:l.reportable_type==="equipment"?l.reportable?.equipment_code:"N/A"}),e.jsx(n,{children:l.condition}),e.jsx(n,{children:l.remarks}),e.jsxs(n,{children:["ROOM ",l.room?l.room.room_number:"N/A"]}),e.jsx(n,{children:new Date(l.created_at).toLocaleDateString()}),e.jsxs(n,{className:"space-x-2",children:[e.jsx(P,{href:`/admin/faculty-reports/${l.id}/edit`,children:e.jsx(u,{variant:"outline",size:"sm",children:"Edit"})}),e.jsx(u,{variant:"destructive",size:"sm",onClick:()=>A(l.id),children:"Delete"})]})]},l.id)):e.jsx(_,{children:e.jsx(n,{colSpan:"11",className:"text-center",children:"No reports found."})})})]}),e.jsxs("div",{className:"flex justify-center mt-4 space-x-2",children:[e.jsx(u,{variant:"outline",size:"sm",disabled:r===1,onClick:()=>t(r-1),children:"Previous"}),[...Array(S)].map((l,h)=>e.jsx(u,{variant:r===h+1?"default":"outline",size:"sm",onClick:()=>t(h+1),children:h+1},h)),e.jsx(u,{variant:"outline",size:"sm",disabled:r===S,onClick:()=>t(r+1),children:"Next"})]})]})})]})})]})]})}export{ye as default};
