import{r as h,j as e,a as se,b as te,H as ae,L as k}from"./app-DOsJYAZr.js";import{B as x}from"./button-BJkAWaq5.js";import{T as le,a as ne,b as P,c as w,d as ie,e as f}from"./table-CkEycEh3.js";import{I as T}from"./input-C5mRaj1H.js";import{P as oe,a as re,b as de}from"./popover-zRhSgj5j.js";import{S as v,a as C,b as S,c as _,d as j}from"./select-DLOsxY-u.js";import{G as A}from"./guest-room-view.sidebar-Y1WsNwOk.js";import{D as L,a as O,b as $,c as W,d as ce}from"./dialog-C5XhxJTd.js";import{T as he}from"./textarea-COTwfoAA.js";import{C as me}from"./circle-check-DdJ536VA.js";import{M as xe}from"./package-Dku13-pT.js";import{E as R}from"./eye-DRggNl4S.js";import{F as ue}from"./file-text-D02FcxvD.js";import{F as pe}from"./funnel-6pbpbGBA.js";import{X as G}from"./index-DUfoXKAx.js";import"./index-BCvnxMa-.js";import"./utils-CBfrqCZ4.js";import"./index-B0seKdI2.js";import"./index-azXK0IiM.js";import"./dropdown-menu-DvBtlFDx.js";import"./createLucideIcon-BCibPqi-.js";import"./index-BPrBitMd.js";import"./chevron-right-DloDiWLc.js";import"./index-BdLiMkF_.js";import"./index-iH8E8t8T.js";import"./chevron-down-C7-3JduT.js";import"./monitor-bJMhAkil.js";import"./mouse-Bh1uIxFI.js";function je({open:s,onOpenChange:n,room:a,item:p,section:m,onSuccess:i}){const[r,c]=h.useState({condition:"",remarks:"",photo:null}),l=d=>{const b={"system-units":"system_unit",peripherals:"peripheral",equipment:"equipment"};d.preventDefault();const t=new FormData;t.append("reportable_type",b[m]||m),t.append("reportable_id",p.id),t.append("room_id",a.id),t.append("condition",r.condition),t.append("remarks",r.remarks),r.photo&&t.append("photo",r.photo),se.post(route("reports.store"),t,{onSuccess:()=>{n(!1),i&&i()}})};return e.jsx(L,{open:s,onOpenChange:n,children:e.jsxs(O,{className:"max-w-md w-[95%] rounded-2xl p-6",children:[e.jsxs($,{children:[e.jsx(W,{children:"Report Item"}),e.jsx(ce,{children:"Fill out the details below to report an issue with this item."})]}),e.jsxs("form",{onSubmit:l,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Condition"}),e.jsx(T,{placeholder:"Enter or select condition...",className:"mt-1",value:r.condition,onChange:d=>c({...r,condition:d.target.value})}),e.jsx("div",{className:"flex gap-2 mt-2 flex-wrap",children:["Working","Needs Maintenance","Defective"].map(d=>e.jsx(x,{type:"button",variant:"outline",size:"sm",onClick:()=>c({...r,condition:d}),className:`${r.condition===d?"bg-primary text-white":""}`,children:d},d))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Remarks"}),e.jsx(he,{placeholder:"Enter remarks...",className:"mt-1",value:r.remarks,onChange:d=>c({...r,remarks:d.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Upload Photo"}),e.jsx(T,{type:"file",accept:"image/*",capture:"environment",className:"mt-1",onChange:d=>c({...r,photo:d.target.files[0]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(x,{type:"submit",className:"bg-[hsl(142,34%,51%)] text-white hover:bg-[hsl(142,34%,45%)]",children:"Save"})})]})]})})}function ge({open:s,onClose:n}){return e.jsx(L,{open:s,onOpenChange:n,children:e.jsxs(O,{className:"max-w-sm w-[90%] p-6 rounded-2xl shadow-xl text-center",children:[e.jsx("button",{onClick:n,className:"absolute right-4 top-4 text-gray-400 hover:text-gray-600"}),e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx(me,{className:"w-16 h-16 text-green-500"})}),e.jsx($,{children:e.jsx(W,{className:"text-lg font-semibold text-center",children:"Reported successfully"})})]})})}function fe({page:s,pageCount:n,onPageChange:a}){return e.jsxs("div",{className:"flex justify-end items-center gap-2",children:[e.jsx(x,{size:"sm",disabled:s===1,onClick:()=>a(s-1),className:`flex items-center gap-1
          bg-[hsl(142,34%,51%)] text-white
          hover:bg-[hsl(142,34%,45%)]
          disabled:bg-gray-200 disabled:text-gray-400 disabled:cursor-not-allowed`,children:"Previous"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",s," of ",n]}),e.jsx(x,{size:"sm",disabled:s===n,onClick:()=>a(s+1),className:`flex items-center gap-1
          bg-[hsl(142,34%,51%)] text-white
          hover:bg-[hsl(142,34%,45%)]
          disabled:bg-gray-200 disabled:text-gray-400 disabled:cursor-not-allowed`,children:"Next"})]})}function be({filters:s,filterOptions:n,activeSection:a,onApplyFilters:p}){const[m,i]=h.useState(""),[r,c]=h.useState("");h.useEffect(()=>{s.condition?(i("condition"),c(s.condition)):s.unit_code&&(a==="system-units"||a==="peripherals")?(i("unit_code"),c(s.unit_code)):s.type&&(a==="peripherals"||a==="equipments")&&(i("type"),c(s.type))},[s,a]);const l=t=>{const u=t==="all"?"":t;c(u),m==="condition"?p(u,s.unit_code,s.search):m==="unit_code"?p(s.condition,u,s.search):m==="type"&&p(s.condition,s.unit_code,u,s.search)},d=()=>{i(""),c(""),p("","",s.search||"","")},b=()=>{const t=[{value:"condition",label:"Condition"}];return(a==="system-units"||a==="peripherals")&&t.push({value:"unit_code",label:"Unit Code"}),(a==="peripherals"||a==="equipments")&&t.push({value:"type",label:"Type"}),t};return e.jsxs(oe,{children:[e.jsx(re,{asChild:!0,children:e.jsxs(x,{className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",children:[e.jsx(pe,{className:"h-4 w-4"}),"Filter",(s.condition||(a==="system-units"||a==="peripherals")&&s.unit_code)&&e.jsx(G,{className:"h-4 w-4 ml-1 cursor-pointer",onClick:t=>{t.stopPropagation(),d()}})]})}),e.jsxs(de,{className:"w-[calc(100vw-2rem)] sm:w-[400px] p-4",align:"start",sideOffset:10,children:[e.jsx("h4",{className:"font-medium mb-3 text-lg",children:"Filter Options"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs(v,{value:m,onValueChange:t=>{i(t),c("")},children:[e.jsx(C,{className:"w-full",children:e.jsx(S,{placeholder:"Select Field"})}),e.jsx(_,{children:b().map(t=>e.jsx(j,{value:t.value,children:t.label},t.value))})]}),m==="condition"&&e.jsxs(v,{value:r||"all",onValueChange:l,children:[e.jsx(C,{className:"w-full",children:e.jsx(S,{placeholder:"Select Condition"})}),e.jsxs(_,{children:[e.jsx(j,{value:"all",children:"All"}),n.conditions.map(t=>e.jsx(j,{value:t,children:t},t))]})]}),m==="unit_code"&&(a==="system-units"||a==="peripherals")&&e.jsxs(v,{value:r||"all",onValueChange:l,children:[e.jsx(C,{className:"w-full",children:e.jsx(S,{placeholder:"Select Unit"})}),e.jsxs(_,{children:[e.jsx(j,{value:"all",children:"All"}),n.unit_codes.map(t=>e.jsx(j,{value:t,children:t},t))]})]}),m==="type"&&(a==="equipments"||a==="peripherals")&&e.jsxs(v,{value:r||"all",onValueChange:t=>{const u=t==="all"?"":t;c(u),p(s.condition,s.unit_code,s.search,u)},children:[e.jsx(C,{className:"w-full",children:e.jsx(S,{placeholder:"Select Type"})}),e.jsxs(_,{children:[e.jsx(j,{value:"all",children:"All"}),n.types?.map(t=>e.jsx(j,{value:t,children:t},t))]})]}),(s.condition||(a==="system-units"||a==="peripherals")&&s.unit_code||(a==="equipments"||a==="peripherals")&&s.type)&&e.jsx("div",{className:"flex justify-end",children:e.jsxs(x,{size:"sm",variant:"outline",onClick:d,className:"flex items-center gap-1 text-red-600 hover:bg-red-50 w-auto",children:[e.jsx(G,{className:"h-4 w-4"}),"Reset"]})})]})]})]})}function Je({room:s,equipments:n,systemUnits:a,peripherals:p,section:m,filters:i={},filterOptions:r={conditions:[],unit_codes:[],types:[]}}){const{auth:c}=te().props,[l,d]=h.useState(m||"dashboard"),[b,t]=h.useState(!1),[u,q]=h.useState(!1),[X,F]=h.useState(!1),[J,K]=h.useState(null),[V,Q]=h.useState(i?.condition||""),[z,Y]=h.useState(i?.unit_code||""),[E,D]=h.useState(i?.search||""),[N,M]=h.useState(1),y=10,I=l==="system-units"?a:l==="peripherals"?p:l==="equipments"?n:[];h.useEffect(()=>{l==="dashboard"&&(window.location.href=route("guest.ScannedRoom.dashboard",{roomPath:s.room_path}))},[l]);const H=Math.ceil(I.length/y),U=I.slice((N-1)*y,N*y);h.useEffect(()=>{M(1),Q(i.condition||""),Y(i.unit_code||""),D(i.search||"")},[l,i]);const B=(o=V,g=z,Z=E,ee=i?.type||"")=>{window.location.href=route("guest.room.show",{roomPath:s.room_path,section:l,condition:o||void 0,unit_code:(l==="system-units"||l==="peripherals")&&g||void 0,search:Z||void 0,type:ee||void 0})};return e.jsxs(e.Fragment,{children:[e.jsx(ae,{title:`Room - ${s.room_name}`}),e.jsxs("div",{className:"flex h-screen overflow-hidden",children:[e.jsx("div",{className:"hidden md:flex",children:e.jsx(A,{room:s,active:l,user:c.user,onSelect:o=>{window.location.href=route("guest.room.show",{roomPath:s.room_path,section:o})}})}),b&&e.jsxs("div",{className:"fixed inset-0 z-40 flex md:hidden",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:()=>t(!1)}),e.jsx("div",{className:"relative z-50 w-64 shadow-lg",style:{backgroundColor:"hsl(142,34%,51%)"},children:e.jsx(A,{room:s,active:l,user:c.user,onSelect:o=>{window.location.href=route("guest.room.show",{roomPath:s.room_path,section:o}),t(!1)}})})]}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-y-auto bg-gray-50",children:[" ",e.jsxs("div",{className:"p-4 border-b md:hidden flex items-center justify-between shadow-sm",style:{backgroundColor:"hsl(142,34%,51%)"},children:[e.jsx(x,{variant:"outline",size:"icon",onClick:()=>t(!0),className:"bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",children:e.jsx(xe,{className:"h-5 w-5"})}),e.jsx("h2",{className:"text-xl font-semibold text-white",children:s.room_name})]}),e.jsxs("div",{className:"p-5 max-w-full md:max-w-5xl lg:max-w-7xl mx-auto w-full",children:[" ",e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:l==="system-units"?"System Units":l==="peripherals"?"Peripherals":"Equipments"})}),e.jsxs("div",{className:"rounded-lg border overflow-hidden shadow-sm bg-white",children:[e.jsx("div",{className:"flex flex-col sm:flex-row gap-2 sm:justify-between sm:items-center p-4 border-b",children:e.jsxs("div",{className:"flex gap-2 items-center w-full sm:w-auto",children:[e.jsx(be,{filters:i,filterOptions:r,activeSection:l,onApplyFilters:B}),e.jsx(T,{placeholder:"Search...",value:E,onChange:o=>{const g=o.target.value;D(g),B(V,z,g)},className:`flex-1 min-w-0 sm:max-w-xs w-full
                                            border-[hsl(142,34%,51%)] text-[hsl(142,34%,20%)]
                                            focus:border-[hsl(142,34%,45%)] focus:ring-[hsl(142,34%,45%)]
                                            placeholder:text-[hsl(142,34%,40%)]`})]})}),e.jsxs(le,{className:"min-w-full divide-y divide-gray-200",children:[e.jsx(ne,{className:"bg-gray-50",children:e.jsxs(P,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] hover:bg-[hsl(142,34%,80%)] h-10",children:[e.jsx(w,{className:"w-20 text-center text-gray-600",children:"No"}),e.jsx(w,{className:"text-gray-600  whitespace-nowrap",children:l==="system-units"?"Pc Code":l==="peripherals"?"Peripheral Code":"Equipment Code"}),l!=="system-units"&&e.jsx(w,{className:"text-gray-600",children:"Type"}),e.jsx(w,{className:"text-gray-600",children:"Condition"}),e.jsx(w,{className:"text-gray-600",children:"Actions"})]})}),e.jsx(ie,{className:"divide-y divide-gray-200",children:U.length>0?U.map((o,g)=>(console.log("Equipment item:",o),e.jsxs(P,{children:[e.jsx(f,{className:"text-center",children:(N-1)*y+g+1}),e.jsx(f,{className:"font-medium text-gray-900 whitespace-nowrap",children:o.name}),l!=="system-units"&&e.jsx(f,{className:"text-gray-700",children:o.type}),e.jsx(f,{children:e.jsx(we,{condition:o.condition})}),e.jsxs(f,{className:"flex gap-2 py-3",children:[l==="system-units"&&e.jsx(k,{href:route("guest.units.show",{room:s.id,unit:o.id}),children:e.jsxs(x,{size:"sm",variant:"outline",className:"flex items-center gap-1 text-[hsl(142,34%,51%)] border-[hsl(142,34%,51%)] hover:bg-[hsl(142,34%,51%)] hover:text-white",children:[e.jsx(R,{className:"h-4 w-4"})," ","View"]})}),l==="peripherals"&&e.jsx(k,{href:route("guest.peripherals.show",{room:s.id,peripheral:o.id}),children:e.jsxs(x,{size:"sm",variant:"outline",className:"flex items-center gap-1 text-[hsl(142,34%,51%)] border-[hsl(142,34%,51%)] hover:bg-[hsl(142,34%,51%)] hover:text-white",children:[e.jsx(R,{className:"h-4 w-4"})," ","View"]})}),l==="equipments"&&(console.log("Room ID:",s.id,"Equipment ID:",o.id),e.jsx(k,{href:route("guest.equipments.show",{room:s.id,equipment:o.id}),children:e.jsxs(x,{size:"sm",variant:"outline",className:"flex items-center gap-1 text-[hsl(142,34%,51%)] border-[hsl(142,34%,51%)] hover:bg-[hsl(142,34%,51%)] hover:text-white",children:[e.jsx(R,{className:"h-4 w-4"})," ","View"]})})),e.jsxs(x,{size:"sm",variant:"outline",className:"flex items-center gap-1 text-[hsl(142,34%,51%)] border-[hsl(142,34%,51%)] hover:bg-[hsl(142,34%,45%)] hover:text-white",onClick:()=>{K(o),q(!0)},children:[e.jsx(ue,{className:"h-4 w-4"})," ","Report"]})]})]},o.id))):e.jsx(P,{children:e.jsx(f,{colSpan:l==="system-units"?4:5,className:"text-center text-muted-foreground py-4",children:"No data found."})})})]}),H>1&&e.jsx("div",{className:"flex justify-end p-4 bg-gray-50",children:e.jsx(fe,{page:N,pageCount:H,onPageChange:M})})]})]})]})]})]}),u&&e.jsx(je,{open:u,onOpenChange:q,item:J,section:l,room:s,onSuccess:()=>F(!0)}),e.jsx(ge,{open:X,onClose:()=>F(!1),message:"Report submitted successfully!"})]})}function we({condition:s}){if(!s)return null;const n=s.toLowerCase().trim();let a="bg-gray-100 text-gray-800";return n.includes("not working")||n.includes("broken")||n.includes("defect")?a="bg-red-100 text-red-800":n.includes("maint")||n.includes("pending")||n.includes("check")?a="bg-amber-100 text-amber-800":(n.includes("good")||n.includes("functional")||n==="working")&&(a="bg-green-100 text-green-800"),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold whitespace-nowrap ${a}`,children:s})}export{Je as default};
