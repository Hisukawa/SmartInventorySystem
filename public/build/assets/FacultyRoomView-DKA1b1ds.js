import{r as d,j as e,a as se,b as te,H as ae,L as R}from"./app-Bif1K73z.js";import{B as u}from"./button-yugozLbP.js";import{T as le,a as ne,b as M,c as w,d as ie,e as b}from"./table-DM4ldjbO.js";import{I as E}from"./input-CnyA52Eh.js";import{P as oe,a as re,b as ce}from"./popover-CZTeceBw.js";import{S as P,a as T,b as q,c as F,d as f}from"./select-BfUrKUsu.js";import{F as B}from"./faculty-room-view-sidebar-DiXcPSo6.js";import{D as O,a as $,b as K,c as W,d as de}from"./dialog-jFrBKFJE.js";import{T as he}from"./textarea-DGnmoAEW.js";import{C as me}from"./circle-check-Bfj1UjN1.js";import{M as xe}from"./package-ci3X5zW6.js";import{E as z}from"./eye-BZZFDEcw.js";import{c as ue}from"./createLucideIcon-B-LV7fAy.js";import{F as pe}from"./funnel-CU69GMBk.js";import{X as L}from"./index-Ddvtospl.js";import"./index-BfaenBt4.js";import"./utils-CBfrqCZ4.js";import"./index-DCMODdWn.js";import"./index-Gi3Vjw4Z.js";import"./dropdown-menu-vvZpvqSa.js";import"./index-CFNXv0Rk.js";import"./chevron-right-Dctvbwe4.js";import"./index-BZRZlgyj.js";import"./index-C34Bu8gc.js";import"./chevron-down-DgLfBM0j.js";import"./monitor-D9AYQO7C.js";import"./mouse-DC8noTEV.js";/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ge=ue("file-text",je);function fe({open:s,onOpenChange:n,room:l,item:p,section:x,onSuccess:o}){const[r,h]=d.useState({condition:"",remarks:"",photo:null}),t=c=>{const y={"system-units":"system_unit",peripherals:"peripheral",equipment:"equipment"};c.preventDefault();const m=new FormData;m.append("reportable_type",y[x]||x),m.append("reportable_id",p.id),m.append("room_id",l.id),m.append("condition",r.condition),m.append("remarks",r.remarks),r.photo&&m.append("photo",r.photo),se.post(route("reports.store"),m,{onSuccess:()=>{n(!1),o&&o()}})};return e.jsx(O,{open:s,onOpenChange:n,children:e.jsxs($,{className:"max-w-md w-[95%] rounded-2xl p-6",children:[e.jsxs(K,{children:[e.jsx(W,{children:"Report Item"}),e.jsx(de,{children:"Fill out the details below to report an issue with this item."})]}),e.jsxs("form",{onSubmit:t,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Condition"}),e.jsx(E,{placeholder:"Enter or select condition...",className:"mt-1",value:r.condition,onChange:c=>h({...r,condition:c.target.value})}),e.jsx("div",{className:"flex gap-2 mt-2 flex-wrap",children:["Working","Needs Maintenance","Defective"].map(c=>e.jsx(u,{type:"button",variant:"outline",size:"sm",onClick:()=>h({...r,condition:c}),className:`${r.condition===c?"bg-primary text-white":""}`,children:c},c))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Remarks"}),e.jsx(he,{placeholder:"Enter remarks...",className:"mt-1",value:r.remarks,onChange:c=>h({...r,remarks:c.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Upload Photo"}),e.jsx(E,{type:"file",accept:"image/*",capture:"environment",className:"mt-1",onChange:c=>h({...r,photo:c.target.files[0]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(u,{type:"submit",className:"bg-[hsl(142,34%,51%)] text-white hover:bg-[hsl(142,34%,45%)]",children:"Save"})})]})]})})}function be({open:s,onClose:n}){return e.jsx(O,{open:s,onOpenChange:n,children:e.jsxs($,{className:"max-w-sm w-[90%] p-6 rounded-2xl shadow-xl text-center",children:[e.jsx("button",{onClick:n,className:"absolute right-4 top-4 text-gray-400 hover:text-gray-600"}),e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx(me,{className:"w-16 h-16 text-green-500"})}),e.jsx(K,{children:e.jsx(W,{className:"text-lg font-semibold text-center",children:"Reported successfully"})})]})})}function ye({page:s,pageCount:n,onPageChange:l}){return e.jsxs("div",{className:"flex justify-end items-center gap-2",children:[e.jsx(u,{size:"sm",disabled:s===1,onClick:()=>l(s-1),className:`flex items-center gap-1
          bg-[hsl(142,34%,51%)] text-white
          hover:bg-[hsl(142,34%,45%)]
          disabled:bg-gray-200 disabled:text-gray-400 disabled:cursor-not-allowed`,children:"Previous"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",s," of ",n]}),e.jsx(u,{size:"sm",disabled:s===n,onClick:()=>l(s+1),className:`flex items-center gap-1
          bg-[hsl(142,34%,51%)] text-white
          hover:bg-[hsl(142,34%,45%)]
          disabled:bg-gray-200 disabled:text-gray-400 disabled:cursor-not-allowed`,children:"Next"})]})}function we({filters:s,filterOptions:n,activeSection:l,onApplyFilters:p}){const[x,o]=d.useState(""),[r,h]=d.useState("");d.useEffect(()=>{s.condition?(o("condition"),h(s.condition)):s.unit_code&&(l==="system-units"||l==="peripherals")?(o("unit_code"),h(s.unit_code)):s.type&&(l==="peripherals"||l==="equipments")&&(o("type"),h(s.type))},[s,l]);const t=a=>{const g=a==="all"?"":a;h(g),x==="condition"?p(g,s.unit_code,s.search,s.type):x==="unit_code"?p(s.condition,g,s.search,s.type):x==="type"&&p(s.condition,s.unit_code,s.search,g)},c=()=>{o(""),h(""),p("","",s.search||"","")},y=()=>{const a=[{value:"condition",label:"Condition"}];return(l==="system-units"||l==="peripherals")&&a.push({value:"unit_code",label:"Unit Code"}),(l==="equipments"||l==="peripherals")&&a.push({value:"type",label:"Type"}),a},m=()=>l==="equipments"?n.types?.equipments||[]:l==="peripherals"?n.types?.peripherals||[]:[];return e.jsxs(oe,{children:[e.jsx(re,{asChild:!0,children:e.jsxs(u,{className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",children:[e.jsx(pe,{className:"h-4 w-4"}),"Filter",(s.condition||s.unit_code||s.type)&&e.jsx(L,{className:"h-4 w-4 ml-1 cursor-pointer",onClick:a=>{a.stopPropagation(),c()}})]})}),e.jsxs(ce,{className:"w-[calc(100vw-2rem)] sm:w-[400px] p-4",align:"start",sideOffset:10,children:[e.jsx("h4",{className:"font-medium mb-3 text-lg",children:"Filter Options"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs(P,{value:x,onValueChange:a=>{o(a),h("")},children:[e.jsx(T,{className:"w-full",children:e.jsx(q,{placeholder:"Select Field"})}),e.jsx(F,{children:y().map(a=>e.jsx(f,{value:a.value,children:a.label},a.value))})]}),x==="condition"&&e.jsxs(P,{value:r||"all",onValueChange:t,children:[e.jsx(T,{className:"w-full",children:e.jsx(q,{placeholder:"Select Condition"})}),e.jsxs(F,{children:[e.jsx(f,{value:"all",children:"All"}),n.conditions.map(a=>e.jsx(f,{value:a,children:a},a))]})]}),x==="unit_code"&&(l==="system-units"||l==="peripherals")&&e.jsxs(P,{value:r||"all",onValueChange:t,children:[e.jsx(T,{className:"w-full",children:e.jsx(q,{placeholder:"Select Unit Code"})}),e.jsxs(F,{children:[e.jsx(f,{value:"all",children:"All"}),n.unit_codes.map(a=>e.jsx(f,{value:a,children:a},a))]})]}),x==="type"&&(l==="equipments"||l==="peripherals")&&e.jsxs(P,{value:r||"all",onValueChange:t,children:[e.jsx(T,{className:"w-full",children:e.jsx(q,{placeholder:"Select Type"})}),e.jsxs(F,{children:[e.jsx(f,{value:"all",children:"All"}),m().map(a=>e.jsx(f,{value:a,children:a},a))]})]}),(s.condition||s.unit_code||s.type)&&e.jsx("div",{className:"flex justify-end",children:e.jsxs(u,{size:"sm",variant:"outline",onClick:c,className:"flex items-center gap-1 text-red-600 hover:bg-red-50 w-auto",children:[e.jsx(L,{className:"h-4 w-4"}),"Reset"]})})]})]})]})}function Qe({room:s,equipments:n,systemUnits:l,peripherals:p,section:x,filters:o={},filterOptions:r={conditions:[],unit_codes:[],types:[]}}){const{auth:h}=te().props,[t,c]=d.useState(x||"dashboard"),[y,m]=d.useState(!1),[a,g]=d.useState(!1),[X,V]=d.useState(!1),[Z,G]=d.useState(null),[v,J]=d.useState(o?.condition||""),[N,Q]=d.useState(o?.unit_code||""),[C,D]=d.useState(o?.search||""),[S,I]=d.useState(1),k=10,[Ne,Ce]=d.useState(o?.type||""),H=t==="system-units"?l:t==="peripherals"?p:t==="equipments"?n:[];d.useEffect(()=>{t==="dashboard"&&(window.location.href=route("faculty.ScannedRoom.dashboard",{roomPath:s.room_path}))},[t]);const U=Math.ceil(H.length/k),A=H.slice((S-1)*k,S*k);d.useEffect(()=>{I(1),J(o.condition||""),Q(o.unit_code||""),D(o.search||"")},[t,o]);const _=(i=v,j=N,Y=C,ee=o?.type||"")=>{window.location.href=route("faculty.room.show",{roomPath:s.room_path,section:t,condition:i||void 0,unit_code:(t==="system-units"||t==="peripherals")&&j||void 0,search:Y||void 0,type:ee||void 0})};return e.jsxs(e.Fragment,{children:[e.jsx(ae,{title:`Room - ${s.room_name}`}),e.jsxs("div",{className:"flex h-screen overflow-hidden",children:[e.jsx("div",{className:"hidden md:flex",children:e.jsx(B,{room:s,active:t,user:h.user,onSelect:i=>{window.location.href=route("faculty.room.show",{roomPath:s.room_path,section:i})}})}),y&&e.jsxs("div",{className:"fixed inset-0 z-40 flex md:hidden",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:()=>m(!1)}),e.jsx("div",{className:"relative z-50 w-64 shadow-lg",style:{backgroundColor:"hsl(142,34%,51%)"},children:e.jsx(B,{room:s,active:t,user:h.user,onSelect:i=>{window.location.href=route("faculty.room.show",{roomPath:s.room_path,section:i}),m(!1)}})})]}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-y-auto bg-gray-50",children:[" ",e.jsxs("div",{className:"p-4 border-b md:hidden flex items-center justify-between shadow-sm",style:{backgroundColor:"hsl(142,34%,51%)"},children:[e.jsx(u,{variant:"outline",size:"icon",onClick:()=>m(!0),className:"bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",children:e.jsx(xe,{className:"h-5 w-5"})}),e.jsx("h2",{className:"text-xl font-semibold text-white",children:s.room_name})]}),e.jsxs("div",{className:"p-5 max-w-full md:max-w-5xl lg:max-w-7xl mx-auto w-full",children:[" ",e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:t==="system-units"?"System Units":t==="peripherals"?"Peripherals":"Equipments"})}),e.jsxs("div",{className:"rounded-lg border overflow-hidden shadow-sm bg-white",children:[e.jsx("div",{className:"flex flex-col sm:flex-row gap-2 sm:justify-between sm:items-center p-4 border-b",children:e.jsxs("div",{className:"flex gap-2 items-center w-full sm:w-auto",children:[e.jsx(we,{filters:o,filterOptions:r,activeSection:t,onApplyFilters:_}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(E,{placeholder:"Search...",value:C,onChange:i=>{const j=i.target.value;D(j),j.trim()===""&&_(v,N,"")},onKeyDown:i=>{if(i.key==="Enter"){const j=C.trim();_(v,N,j||"")}},className:`flex-1 min-w-0 sm:max-w-xs w-full
      border-[hsl(142,34%,51%)] text-[hsl(142,34%,20%)]
      focus:border-[hsl(142,34%,45%)] focus:ring-[hsl(142,34%,45%)]
      placeholder:text-[hsl(142,34%,40%)]`}),e.jsx(u,{className:"bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>{const i=C.trim();_(v,N,i||"")},children:"Search"})]})]})}),e.jsxs(le,{className:"min-w-full divide-y divide-gray-200",children:[e.jsx(ne,{className:"bg-gray-50",children:e.jsxs(M,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] hover:bg-[hsl(142,34%,80%)] h-10",children:[e.jsx(w,{className:"w-20 text-center text-gray-600",children:"No"}),e.jsx(w,{className:"text-gray-600  whitespace-nowrap",children:t==="system-units"?"Pc Code":t==="peripherals"?"Peripheral Code":"Equipment Code"}),t!=="system-units"&&e.jsx(w,{className:"text-gray-600",children:"Type"}),e.jsx(w,{className:"text-gray-600",children:"Condition"}),e.jsx(w,{className:"text-gray-600",children:"Actions"})]})}),e.jsx(ie,{className:"divide-y divide-gray-200",children:A.length>0?A.map((i,j)=>(console.log("Equipment item:",i),e.jsxs(M,{children:[e.jsx(b,{className:"text-center",children:(S-1)*k+j+1}),e.jsx(b,{className:"font-medium text-gray-900 whitespace-nowrap",children:i.name}),t!=="system-units"&&e.jsx(b,{className:"text-gray-700",children:i.type}),e.jsx(b,{children:e.jsx(ve,{condition:i.condition})}),e.jsxs(b,{className:"flex gap-2 py-3",children:[t==="system-units"&&e.jsx(R,{href:route("faculty.units.show",{roomId:s.id,unitId:i.id}),children:e.jsxs(u,{size:"sm",variant:"outline",className:"flex items-center gap-1 text-[hsl(142,34%,51%)] border-[hsl(142,34%,51%)] hover:bg-[hsl(142,34%,51%)] hover:text-white",children:[e.jsx(z,{className:"h-4 w-4"})," ","View"]})}),t==="peripherals"&&e.jsx(R,{href:route("faculty.peripherals.show",{room:s.id,peripheral:i.id}),children:e.jsxs(u,{size:"sm",variant:"outline",className:"flex items-center gap-1 text-[hsl(142,34%,51%)] border-[hsl(142,34%,51%)] hover:bg-[hsl(142,34%,51%)] hover:text-white",children:[e.jsx(z,{className:"h-4 w-4"})," ","View"]})}),t==="equipments"&&(console.log("Room ID:",s.id,"Equipment ID:",i.id),e.jsx(R,{href:route("faculty.equipments.show",{room:s.id,equipment:i.id}),children:e.jsxs(u,{size:"sm",variant:"outline",className:"flex items-center gap-1 text-[hsl(142,34%,51%)] border-[hsl(142,34%,51%)] hover:bg-[hsl(142,34%,51%)] hover:text-white",children:[e.jsx(z,{className:"h-4 w-4"})," ","View"]})})),e.jsxs(u,{size:"sm",variant:"outline",className:"flex items-center gap-1 text-[hsl(142,34%,51%)] border-[hsl(142,34%,51%)] hover:bg-[hsl(142,34%,45%)] hover:text-white",onClick:()=>{G(i),g(!0)},children:[e.jsx(ge,{className:"h-4 w-4"})," ","Report"]})]})]},i.id))):e.jsx(M,{children:e.jsx(b,{colSpan:t==="system-units"?4:5,className:"text-center text-muted-foreground py-4",children:"No data found."})})})]}),U>1&&e.jsx("div",{className:"flex justify-end p-4 bg-gray-50",children:e.jsx(ye,{page:S,pageCount:U,onPageChange:I})})]})]})]})]})]}),a&&e.jsx(fe,{open:a,onOpenChange:g,item:Z,section:t,room:s,onSuccess:()=>V(!0)}),e.jsx(be,{open:X,onClose:()=>V(!1),message:"Report submitted successfully!"})]})}function ve({condition:s}){if(!s)return null;const n=s.toLowerCase().trim();let l="bg-gray-100 text-gray-800";return n.includes("not working")||n.includes("broken")||n.includes("defect")?l="bg-red-100 text-red-800":n.includes("maint")||n.includes("pending")||n.includes("check")?l="bg-amber-100 text-amber-800":(n.includes("good")||n.includes("functional")||n==="working")&&(l="bg-green-100 text-green-800"),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold whitespace-nowrap ${l}`,children:s})}export{Qe as default};
