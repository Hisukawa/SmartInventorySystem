import{r as n,j as e,u as K,H as X}from"./app-DuLcFkRW.js";import{b as Y,c as J,d as V}from"./card-CqtzaWMr.js";import{I as _}from"./input-DnbGSlp8.js";import{L as I}from"./label-D4JzFQz_.js";import{B as L}from"./button-QxhSem_q.js";import{c as W,e as $,P as E,a as Q,b as D,d as F}from"./index-3Q2Bja-H.js";import{u as Z}from"./index-49CMzTfQ.js";import{u as ee,C as te}from"./index-BRhb6ACy.js";import{c as T}from"./utils-Bmfql_KC.js";import"./index-7XltJxxN.js";var R="Checkbox",[se,xe]=W(R),[re,P]=se(R);function ae(s){const{__scopeCheckbox:i,checked:o,children:f,defaultChecked:d,disabled:t,form:b,name:l,onCheckedChange:m,required:p,value:x="on",internal_do_not_use_render:u}=s,[h,g]=Q({prop:o,defaultProp:d??!1,onChange:m,caller:R}),[v,j]=n.useState(null),[r,c]=n.useState(null),a=n.useRef(!1),N=v?!!b||!!v.closest("form"):!0,k={checked:h,disabled:t,setChecked:g,control:v,setControl:j,name:l,form:b,value:x,hasConsumerStoppedPropagationRef:a,required:p,defaultChecked:w(d)?!1:d,isFormControl:N,bubbleInput:r,setBubbleInput:c};return e.jsx(re,{scope:i,...k,children:ne(u)?u(k):f})}var B="CheckboxTrigger",M=n.forwardRef(({__scopeCheckbox:s,onKeyDown:i,onClick:o,...f},d)=>{const{control:t,value:b,disabled:l,checked:m,required:p,setControl:x,setChecked:u,hasConsumerStoppedPropagationRef:h,isFormControl:g,bubbleInput:v}=P(B,s),j=D(d,x),r=n.useRef(m);return n.useEffect(()=>{const c=t?.form;if(c){const a=()=>u(r.current);return c.addEventListener("reset",a),()=>c.removeEventListener("reset",a)}},[t,u]),e.jsx(E.button,{type:"button",role:"checkbox","aria-checked":w(m)?"mixed":m,"aria-required":p,"data-state":U(m),"data-disabled":l?"":void 0,disabled:l,value:b,...f,ref:j,onKeyDown:F(i,c=>{c.key==="Enter"&&c.preventDefault()}),onClick:F(o,c=>{u(a=>w(a)?!0:!a),v&&g&&(h.current=c.isPropagationStopped(),h.current||c.stopPropagation())})})});M.displayName=B;var S=n.forwardRef((s,i)=>{const{__scopeCheckbox:o,name:f,checked:d,defaultChecked:t,required:b,disabled:l,value:m,onCheckedChange:p,form:x,...u}=s;return e.jsx(ae,{__scopeCheckbox:o,checked:d,defaultChecked:t,disabled:l,required:b,onCheckedChange:p,name:f,form:x,value:m,internal_do_not_use_render:({isFormControl:h})=>e.jsxs(e.Fragment,{children:[e.jsx(M,{...u,ref:i,__scopeCheckbox:o}),h&&e.jsx(q,{__scopeCheckbox:o})]})})});S.displayName=R;var A="CheckboxIndicator",O=n.forwardRef((s,i)=>{const{__scopeCheckbox:o,forceMount:f,...d}=s,t=P(A,o);return e.jsx($,{present:f||w(t.checked)||t.checked===!0,children:e.jsx(E.span,{"data-state":U(t.checked),"data-disabled":t.disabled?"":void 0,...d,ref:i,style:{pointerEvents:"none",...s.style}})})});O.displayName=A;var H="CheckboxBubbleInput",q=n.forwardRef(({__scopeCheckbox:s,...i},o)=>{const{control:f,hasConsumerStoppedPropagationRef:d,checked:t,defaultChecked:b,required:l,disabled:m,name:p,value:x,form:u,bubbleInput:h,setBubbleInput:g}=P(H,s),v=D(o,g),j=Z(t),r=ee(f);n.useEffect(()=>{const a=h;if(!a)return;const N=window.HTMLInputElement.prototype,y=Object.getOwnPropertyDescriptor(N,"checked").set,C=!d.current;if(j!==t&&y){const G=new Event("click",{bubbles:C});a.indeterminate=w(t),y.call(a,w(t)?!1:t),a.dispatchEvent(G)}},[h,j,t,d]);const c=n.useRef(w(t)?!1:t);return e.jsx(E.input,{type:"checkbox","aria-hidden":!0,defaultChecked:b??c.current,required:l,disabled:m,name:p,value:x,form:u,...i,tabIndex:-1,ref:v,style:{...i.style,...r,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});q.displayName=H;function ne(s){return typeof s=="function"}function w(s){return s==="indeterminate"}function U(s){return w(s)?"indeterminate":s?"checked":"unchecked"}const z=n.forwardRef(({className:s,...i},o)=>e.jsx(S,{ref:o,className:T("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...i,children:e.jsx(O,{className:T("flex items-center justify-center text-current"),children:e.jsx(te,{className:"h-4 w-4"})})}));z.displayName=S.displayName;function be({status:s}){const{data:i,setData:o,post:f,processing:d,errors:t,reset:b}=K({email:"",password:"",remember:!1}),l=n.useRef(null),m=n.useRef(null),p=n.useRef(null),[x,u]=n.useState(!1),[h,g]=n.useState(!1);n.useEffect(()=>{navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}}).then(r=>{l.current&&(l.current.srcObject=r,l.current.play())}).catch(r=>console.warn("Camera not available:",r))},[]);const v=()=>{if(!l.current)return;u(!0),g(!0);let r=0;p.current=setInterval(async()=>{if(r>=10){clearInterval(p.current),u(!1),g(!1);return}r++;const c=l.current,a=m.current;a.width=c.videoWidth,a.height=c.videoHeight,a.getContext("2d").drawImage(c,0,0,a.width,a.height);const k=a.toDataURL("image/jpeg").split(",")[1];try{const C=await(await fetch(route("login.face"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({face_descriptor:k})})).json();C.success&&C.role&&(C.role==="admin"?window.location.href="/admin/dashboard":C.role==="faculty"?window.location.href="/faculty/dashboard":C.role==="technician"?window.location.href="/technician/dashboard":window.location.href="/dashboard",clearInterval(p.current),u(!1),g(!1))}catch(y){console.error("Face login error:",y)}},1500)},j=r=>{r.preventDefault(),f(route("login"),{onFinish:()=>b("password")})};return e.jsxs(e.Fragment,{children:[e.jsx(X,{title:"Log in"}),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 px-4",children:e.jsxs("div",{className:"w-full max-w-5xl grid grid-cols-1 md:grid-cols-2 bg-white shadow-lg rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"hidden md:flex flex-col items-center justify-center bg-green-500 text-white p-8 relative",children:[e.jsxs("div",{className:"flex space-x-4 mb-6",children:[e.jsx("div",{className:"w-28 h-28 rounded-full overflow-hidden border-4 border-white bg-white shadow-md",children:e.jsx("img",{src:"logo.png",alt:"Logo 1",className:"w-full h-full object-contain"})}),e.jsx("div",{className:"w-28 h-28 rounded-full overflow-hidden border-4 border-white bg-white shadow-md",children:e.jsx("img",{src:"/ict.png",alt:"Logo 2",className:"w-full h-full object-contain"})})]}),e.jsx("h2",{className:"text-2xl font-bold text-center",children:"ICT INVENTORY SYSTEM MANAGEMENT"}),e.jsx("p",{className:"mt-3 text-sm opacity-90 text-center",children:"Secure • Fast • Organized"})]}),e.jsxs("div",{className:"p-8 flex flex-col justify-center",children:[e.jsxs(Y,{className:"p-0 mb-6",children:[e.jsx(J,{className:"text-2xl font-bold",children:"Login Account"}),e.jsx(V,{children:"Please enter your details or scan your face"})]}),s&&e.jsx("div",{className:"mb-4 text-sm font-medium text-green-600",children:s}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(I,{htmlFor:"email",children:"Email Address"}),e.jsx(_,{id:"email",type:"email",name:"email",value:i.email,autoComplete:"username",onChange:r=>o("email",r.target.value)}),t.email&&e.jsx("p",{className:"text-sm text-red-500",children:t.email})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(I,{htmlFor:"password",children:"Password"}),e.jsx(_,{id:"password",type:"password",name:"password",value:i.password,autoComplete:"current-password",onChange:r=>o("password",r.target.value)}),t.password&&e.jsx("p",{className:"text-sm text-red-500",children:t.password})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(z,{id:"remember",checked:i.remember,onCheckedChange:r=>o("remember",!!r)}),e.jsx("label",{htmlFor:"remember",className:"text-sm text-muted-foreground",children:"Remember me"})]}),e.jsx(L,{type:"submit",className:"w-full mt-2 bg-green-500 hover:bg-green-600 text-white",disabled:d,children:"Login"})]}),e.jsx("hr",{className:"my-6"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(I,{children:"Login with Face"}),e.jsxs("div",{className:"relative w-64 h-64 mx-auto",children:[e.jsx("video",{ref:l,className:"w-full h-full rounded-full border-4 border-green-500 object-cover"}),e.jsx("div",{className:"absolute inset-0 border-4 border-dashed border-green-300 rounded-full pointer-events-none"}),x&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30 text-white font-semibold rounded-full",children:"Scanning..."})]}),e.jsx(L,{type:"button",className:"w-full mt-2 bg-green-600 hover:bg-green-700 text-white",onClick:v,disabled:x||h,children:x||h?"Scanning...":"Login with Face"})]}),e.jsxs("div",{className:"text-center text-sm mt-6",children:["Don’t have an account?"," ",e.jsx("span",{className:"text-gray-600",children:"Please contact the ICT Department Chairperson to request one."})]}),e.jsx("canvas",{ref:m,style:{display:"none"}})]})]})})]})}export{be as default};
