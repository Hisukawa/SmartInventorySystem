import{r,u as T,j as e,a as D,t as f}from"./app-myOy6ArY.js";import{Q as M}from"./index-D45uv18W.js";import{S as ne}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{N as ce}from"./Notification-DY5LSxr-.js";import{T as B,a as de,b as O,c as d,d as me,e as m}from"./table-C-l-9qV0.js";import{B as l}from"./button-GcgfL5IC.js";import{I as j}from"./input-CT3T6SU0.js";import{D as q,a as I,b as xe,c as $}from"./dialog-COXIMVhq.js";import{A as he}from"./app-sidebar-CXMlkqE3.js";import{B as pe,a as ue,b as ge,c as be}from"./breadcrumb-BeyV7HG8.js";import{S as fe,a as je,b as Ne,c as ve}from"./avatar-CI82h3Z_.js";import{P as we}from"./pen-DrSMXE_u.js";import{l as h,E as ye}from"./menu-DM-TXixd.js";import"./bell-iHpRzYKb.js";import"./createLucideIcon-BwLk9yM4.js";import"./utils-CBfrqCZ4.js";import"./index-BUdVvYkI.js";import"./index-137uezbd.js";import"./index-BlQHmAJ4.js";import"./index-C0JhTc6o.js";import"./dropdown-menu-Dn83iH7B.js";import"./index-Bv7VFuWD.js";import"./chevron-right-N6kXSJsm.js";import"./house-CcyZAZfH.js";import"./user-sPmVnrMC.js";import"./log-out-DXofIcUh.js";import"./keyboard-00WxYKZk.js";import"./boxes-Bb2TfiAn.js";import"./users-C6iAcd6h.js";import"./chevron-down-Al0o0DSu.js";import"./index-CyUxXtcE.js";import"./index-2nyVSY52.js";import"./portal-CjwchxKX.js";import"./open-closed-h3GuDbGj.js";import"./with-selector-BWyVqZv8.js";function cs({rooms:t,search:Q}){const[N,A]=r.useState(Q||""),[v,w]=r.useState(!1),[L,x]=r.useState(!1),[P,H]=r.useState(null),[p,y]=r.useState(""),[u,S]=r.useState(""),[U,R]=r.useState(!1),[C,Se]=r.useState(""),{data:F,setData:K,post:V,reset:X,processing:G,errors:_}=T({room_number:""}),{data:J,setData:k,put:W,processing:Y,errors:z,reset:Z}=T({room_number:""}),ee=s=>{s.preventDefault(),V("/admin/rooms",{preserveScroll:!0,onSuccess:()=>{X(),f.success("Room Added",{description:"The room has been added successfully!",duration:2e3})},onError:a=>{a.room_number?f.error("Room already exists!",{description:a.room_number,duration:2500}):f.error("Error",{description:"Something went wrong. Please check your inputs.",duration:2500})}})},se=s=>{s.preventDefault(),W(`/admin/rooms/${P.id}`,{preserveScroll:!0,onSuccess:()=>{x(!1),Z(),ne.fire({icon:"success",title:"Room updated!",showConfirmButton:!1,timer:1500})}})},E=s=>{H(s),k("room_number",s.room_number),x(!0)},te=s=>{s.key==="Enter"&&D.get("/admin/rooms",{search:N})},ae=(s,a)=>{s&&(y(s),S(a))},re=()=>{const s=document.getElementById("qr-download"),i=new XMLSerializer().serializeToString(s),c=new Blob([i],{type:"image/svg+xml;charset=utf-8"}),ie=URL.createObjectURL(c),g=new Image;g.onload=()=>{const o=document.createElement("canvas"),n=o.getContext("2d");o.width=220,o.height=260,n.fillStyle="#fff",n.fillRect(0,0,o.width,o.height),n.drawImage(g,10,10,200,200),n.fillStyle="#000",n.font="bold 16px sans-serif",n.textAlign="center",n.fillText(`ROOM ${u}`,o.width/2,235);const oe=o.toDataURL("image/png"),b=document.createElement("a");b.href=oe,b.download=`room-${u}-qr.png`,b.click()},g.src=ie},le=async()=>{await navigator.clipboard.writeText(p),R(!0),setTimeout(()=>R(!1),2e3)};return e.jsxs(fe,{children:[e.jsx(he,{}),e.jsxs(je,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx(Ne,{}),e.jsx(ve,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(pe,{className:"",children:e.jsx(ue,{children:e.jsx(ge,{children:e.jsx(be,{href:"/admin/rooms","aria-current":"page",className:"font-semibold text-foreground",children:"Room Lists"})})})}),e.jsx("div",{className:"flex-1"}),e.jsx(ce,{})]}),e.jsxs("main",{className:"w-full px-6 py-4 overflow-y-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h1",{className:"text-xl font-bold",children:"Room Management"})}),C&&e.jsx("div",{className:"mb-4 p-3 bg-green-100 text-green-800 rounded shadow text-sm",children:C}),e.jsx(q,{open:L,onOpenChange:x,children:e.jsxs(I,{children:[e.jsx(xe,{children:e.jsx($,{children:"Edit Room"})}),e.jsxs("form",{onSubmit:se,className:"space-y-4",children:[e.jsx(j,{placeholder:"e.g. 101",value:J.room_number,onChange:s=>k("room_number",s.target.value)}),z.room_number&&e.jsx("p",{className:"text-sm text-red-500",children:z.room_number}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>x(!1),children:"Cancel"}),e.jsx(l,{type:"submit",disabled:Y,children:"Update"})]})]})]})}),e.jsxs("div",{className:"flex transition-all duration-700 ease-in-out relative",children:[e.jsxs("div",{className:`flex-1 transition-all duration-700 ease-in-out ${v?"mr-[400px] sm:mr-[500px]":"mr-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 gap-2",children:[e.jsx(j,{placeholder:"Search rooms...",value:N,onChange:s=>A(s.target.value),onKeyDown:te,className:"w-full sm:w-1/3"}),e.jsx(l,{onClick:()=>w(!0),className:"bg-[hsl(142,31%,51%)] hover:bg-[hsl(142,91%,18%)] text-white font-medium",children:"Add Room"})]}),e.jsxs("div",{className:"rounded-xl border shadow-sm overflow-hidden transition-all duration-500",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsx(B,{className:"min-w-full table-auto sm:table-fixed",children:e.jsx(de,{children:e.jsxs(O,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] border-b border-[hsl(142,34%,75%)]",children:[e.jsx(d,{className:"font-semibold sticky top-0 bg-[hsl(142,34%,85%)] z-20 py-3 text-center align-middle",children:"#"}),e.jsx(d,{className:"font-semibold sticky top-0 bg-[hsl(142,34%,85%)] z-20 py-3 text-center align-middle",children:"Room Name"}),e.jsx(d,{className:"font-semibold sticky top-0 bg-[hsl(142,34%,85%)] z-20 py-3 text-center align-middle",children:"Room Code"}),e.jsx(d,{className:"font-semibold sticky top-0 bg-[hsl(142,34%,85%)] z-20 py-3 text-center align-middle",children:"QR Code"}),e.jsx(d,{className:"font-semibold sticky top-0 bg-[hsl(142,34%,85%)] z-20 py-3 text-center align-middle",children:"Actions"})]})})})}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto overflow-x-auto",children:e.jsx(B,{className:"min-w-full table-auto sm:table-fixed",children:e.jsx(me,{children:t.data.map((s,a)=>{const i=typeof s.room_path=="string"?`${window.location.origin}/room/${s.room_path}`:null;return e.jsxs(O,{className:"hover:bg-[hsl(142,34%,96%)] transition-all border-b last:border-0",children:[e.jsx(m,{className:"py-4 font-medium text-gray-700 text-center align-middle",children:(t.current_page-1)*t.per_page+a+1}),e.jsx(m,{className:"py-4 font-medium text-center align-middle",children:`ROOM ${s.room_number}`}),e.jsx(m,{className:"py-4 text-gray-600 text-center align-middle break-words",children:s.room_path}),e.jsx(m,{className:"py-4 text-center align-middle",children:i?e.jsx("div",{className:"inline-block w-16 h-16 bg-white p-1 rounded cursor-pointer shadow-sm hover:shadow transition mx-auto",onClick:c=>{c.stopPropagation(),ae(i,s.room_number)},children:e.jsx(M,{value:i,size:64})}):e.jsx("span",{className:"text-sm text-gray-500",children:"No QR"})}),e.jsx(m,{className:"py-4 text-center align-middle",children:e.jsxs("div",{className:"flex justify-center items-center",children:[e.jsx("div",{className:"hidden sm:flex flex-wrap justify-center items-center gap-2",children:e.jsxs(l,{size:"sm",className:"inline-flex items-center gap-2 py-1.5 px-3 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>E(s),children:[e.jsx(we,{className:"h-4 w-4"})," ","Edit"]})}),e.jsx("div",{className:"sm:hidden relative",children:e.jsxs(h,{children:[e.jsx(h.Button,{className:"py-1.5 px-3 bg-[hsl(142,34%,51%)] text-white rounded inline-flex items-center justify-center",children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx(h.Items,{className:"absolute right-0 mt-2 w-32 bg-white border rounded shadow-lg flex flex-col z-50",children:e.jsx(h.Item,{children:({active:c})=>e.jsx("button",{className:`w-full text-left px-3 py-2 ${c?"bg-gray-100":""}`,onClick:()=>E(s),children:"Edit"})})})]})})]})})]},s.id)})})})}),e.jsxs("div",{className:"mt-3 px-3 py-2 flex flex-col sm:flex-row justify-between items-center gap-3 border-t",children:[e.jsxs("span",{className:"text-sm text-gray-600 text-center sm:text-left",children:["Showing"," ",t.data.length===0?0:(t.current_page-1)*t.per_page+1," ","–"," ",Math.min(t.current_page*t.per_page,t.total)," ","of ",t.total," rooms"]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:t.links.map((s,a)=>{const i=s.label.replace("&laquo;","«").replace("&raquo;","»");return e.jsx(l,{variant:s.active?"default":"outline",size:"sm",className:`min-w-[36px] px-3 py-1 ${s.active?"bg-[hsl(142,34%,45%)] text-white hover:bg-[hsl(142,91%,18%)]":"border-[hsl(142,34%,75%)] text-[hsl(142,34%,25%)] hover:bg-[hsl(142,34%,90%)]"}`,onClick:()=>s.url&&D.visit(s.url,{preserveState:!0,preserveScroll:!0}),disabled:!s.url,dangerouslySetInnerHTML:{__html:i}},a)})})]})]})]}),e.jsxs("div",{className:`fixed top-[56px] right-0 h-[calc(100vh-4rem)] w-[400px] sm:w-[500px] bg-white border-l shadow-lg z-40 p-4 overflow-y-auto transform transition-transform duration-700 ease-in-out ${v?"translate-x-0":"translate-x-full"}`,children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h2",{className:"text-lg font-semibold ",children:"Add Room"})}),e.jsxs("form",{onSubmit:ee,className:"space-y-4",children:[e.jsx(j,{placeholder:"e.g. 101",value:F.room_number,onChange:s=>K("room_number",s.target.value)}),_.room_number&&e.jsx("p",{className:"text-sm text-red-500",children:_.room_number}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>w(!1),children:"Cancel"}),e.jsx(l,{type:"submit",disabled:G,className:"bg-[hsl(142,31%,51%)] hover:bg-[hsl(142,31%,45%)] text-white font-medium",children:"Save"})]})]})]})]}),e.jsx(q,{open:!!p,onOpenChange:()=>{y(""),S("")},children:e.jsxs(I,{className:"max-w-sm text-center",children:[e.jsxs($,{children:["ROOM ",u]}),e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"inline-block p-4 bg-white rounded cursor-pointer",onClick:s=>{s.stopPropagation(),le()},children:[e.jsx(M,{id:"qr-download",value:p,size:200}),e.jsx("p",{className:"text-xs mt-2 text-muted-foreground",children:"Click QR to copy link"})]}),U&&e.jsx("p",{className:"text-green-600 text-sm text-center mt-1",children:"Copied to clipboard!"}),e.jsx(l,{className:"mt-4",onClick:re,children:"Download QR"})]})]})})]})]})]})}export{cs as default};
