import{b as Y,r as j,u as V,j as e,R as Z,a as O}from"./app-X2XQLKS3.js";import{B as p}from"./button-C62_EHzm.js";import{T as J}from"./technician-app-sidebar-C30rbWan.js";import{S as W,a as ee,b as se,c as re}from"./avatar-CEgLhWWb.js";import{c as T}from"./utils-CBfrqCZ4.js";import{I as m}from"./input-Cq2JkAbx.js";import{N as oe}from"./Notification-B4M9gk23.js";import{S as _}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{T as te,a as ae,b as P,c as v,d as le,e as b}from"./table-gmNX_0J6.js";import{B as ne,a as ie,b as ce,c as A,d as de}from"./breadcrumb-BQWS_-1y.js";import{P as me,a as he,b as xe}from"./popover-DjV2oZ4t.js";import{S as M,a as B,b as E,c as I,d as U}from"./select-BpHKBjTl.js";import{D as G,e as ue,a as Q,b as $,c as q}from"./dialog-CSi9K315.js";import{L as C}from"./label-V_itOdbW.js";import{Q as pe}from"./index-BqZIbuVI.js";import{P as je}from"./pen-rAhiXLQh.js";import{Q as ge}from"./qr-code-ghl5xf6y.js";import{T as be}from"./trash-2-uhhfFHrF.js";import{F as fe}from"./funnel-C_-KVArY.js";import{X as k}from"./index-Dz5glkNh.js";import"./index-qYNOf9mi.js";import"./index-BwJb8dSj.js";import"./index-iDKACU5a.js";import"./index-CE5EMy0D.js";import"./index-BhjrTxbN.js";import"./chevron-right-D8htQa18.js";import"./createLucideIcon-0p_GVwJf.js";import"./dropdown-menu-BB3Za7hv.js";import"./index-BIgnMwzR.js";import"./boxes-BWz8K0Ih.js";import"./index-D_NolL6N.js";import"./index-CDj-ShJ8.js";import"./bell-Bcj3VjmY.js";import"./index-DjyIBfzh.js";import"./chevron-down-Ckf9Hflw.js";const L=[{label:"Functional",color:"bg-green-500"},{label:"Defective",color:"bg-red-500"},{label:"Under Maintenance",color:"bg-yellow-500"},{label:"Needs Upgrade",color:"bg-blue-500"},{label:"For Disposal",color:"bg-gray-500"}];function ve(){const{rooms:l}=Y().props,[h,g]=j.useState(!1),{data:i,setData:c,post:d,processing:f,errors:r,reset:S}=V({unit_code:"",processor:"",ram:"",storage:"",gpu:"",motherboard:"",condition:"",room_id:""}),N=o=>{const w=L.find(F=>F.label.toLowerCase()===o.toLowerCase());return w?w.color:"bg-muted"},n=o=>{o.preventDefault(),d("/technician/units/create",{onSuccess:()=>{S(),g(!1),_.fire({title:"System Unit added successfully!",icon:"success",showConfirmButton:!1,timer:1500,customClass:{popup:"technician-success-message"}})},onError:w=>{_.fire({title:w.unit_code||"Error adding unit",icon:"error",showConfirmButton:!0,customClass:{popup:"technician-error-message"}})}})},[a,x]=j.useState("");return j.useEffect(()=>{const o=l.find(w=>`ROOM ${w.room_number}`.toLowerCase()===a.toLowerCase());o?c("room_id",o.id):c("room_id","")},[a]),e.jsxs(G,{open:h,onOpenChange:g,children:[e.jsx(ue,{asChild:!0,children:e.jsx(p,{className:"bg-[hsl(142,31%,51%)] hover:bg-[hsl(142,31%,45%)] text-white font-medium",children:"Add Unit"})}),e.jsxs(Q,{className:"sm:max-w-xl max-h-[90vh] overflow-y-auto",children:[e.jsx($,{children:e.jsx(q,{children:"Add System Unit"})}),e.jsxs("form",{onSubmit:n,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"room_number",children:"Room"}),e.jsx(m,{id:"room_number",list:"room-options",value:a,onChange:o=>x(o.target.value),placeholder:"Search or select room"}),e.jsx("datalist",{id:"room-options",children:l.map(o=>e.jsx("option",{value:`ROOM ${o.room_number}`},o.id))}),r.room_id&&e.jsx("p",{className:"text-sm text-red-500",children:r.room_id})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"unit_code",children:"Pc Code"}),e.jsx(m,{id:"unit_code",name:"unit_code",value:i.unit_code,onChange:o=>c("unit_code",o.target.value),placeholder:"01",required:!0}),r.unit_code&&e.jsx("p",{className:"text-sm text-red-500",children:r.unit_code})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"processor",children:"Processor"}),e.jsx(m,{id:"processor",name:"processor",value:i.processor,onChange:o=>c("processor",o.target.value),placeholder:"Intel Core i5-10400"}),r.processor&&e.jsx("p",{className:"text-sm text-red-500",children:r.processor})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"ram",children:"RAM"}),e.jsx(m,{id:"ram",name:"ram",value:i.ram,onChange:o=>c("ram",o.target.value),placeholder:"16GB DDR5"}),r.ram&&e.jsx("p",{className:"text-sm text-red-500",children:r.ram})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"storage",children:"Storage"}),e.jsx(m,{id:"storage",name:"storage",value:i.storage,onChange:o=>c("storage",o.target.value),placeholder:"512GB NVME SATA SSD"}),r.storage&&e.jsx("p",{className:"text-sm text-red-500",children:r.storage})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"gpu",children:"GPU"}),e.jsx(m,{id:"gpu",name:"gpu",value:i.gpu,onChange:o=>c("gpu",o.target.value),placeholder:"NVIDIA GeForce RTX 5090"}),r.gpu&&e.jsx("p",{className:"text-sm text-red-500",children:r.gpu})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"motherboard",children:"Motherboard"}),e.jsx(m,{id:"motherboard",name:"motherboard",value:i.motherboard,onChange:o=>c("motherboard",o.target.value),placeholder:"ASUS ROG Maximus Z790 Dark Hero (Intel)"}),r.motherboard&&e.jsx("p",{className:"text-sm text-red-500",children:r.motherboard})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"condition",children:"Condition"}),e.jsx(m,{id:"condition",list:"condition-options",value:i.condition,onChange:o=>c("condition",o.target.value),placeholder:"Type or select Condition"}),e.jsx("datalist",{id:"condition-options",children:L.map(o=>e.jsx("option",{value:o.label},o.label))}),i.condition&&e.jsxs("div",{className:"mt-1 text-sm flex items-center gap-2",children:[e.jsx("span",{className:T("inline-block w-3 h-3 rounded-full",N(i.condition))}),e.jsx("span",{className:"capitalize",children:i.condition})]}),r.condition&&e.jsx("p",{className:"text-sm text-red-500",children:r.condition})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(p,{type:"submit",disabled:f,className:"bg-[hsl(142,31%,51%)] hover:bg-[hsl(142,31%,45%)] text-white font-medium",children:"Submit"})})]})]})]})}const z=[{label:"Functional",color:"bg-green-500"},{label:"Defective",color:"bg-red-500"},{label:"Under Maintenance",color:"bg-yellow-500"},{label:"Needs Upgrade",color:"bg-blue-500"},{label:"For Disposal",color:"bg-gray-500"}];function Ne({unit:l,rooms:h,onClose:g}){const{data:i,setData:c,put:d,processing:f,errors:r}=V({unit_code:l.unit_code,processor:l.processor,ram:l.ram,storage:l.storage,gpu:l.gpu,motherboard:l.motherboard,condition:l.condition,room_id:l.room_id}),S=n=>{n.preventDefault(),d(`/technician/units/${l.id}`,{onSuccess:()=>{g(),_.fire({title:"System Unit updated successfully!",icon:"success",showConfirmButton:!1,timer:1500,customClass:{popup:"technician-success-message"}})},onError:a=>{_.fire({title:"Error updating system unit",text:Object.values(a).join(`
`),icon:"error",showConfirmButton:!0,customClass:{popup:"technician-error-message"}})}})},N=n=>{const a=z.find(x=>x.label.toLowerCase()===n.toLowerCase());return a?a.color:"bg-gray-300"};return e.jsx(G,{open:!0,onOpenChange:n=>!n&&g(),children:e.jsxs(Q,{children:[e.jsx($,{children:e.jsxs(q,{children:["Edit ROOM -"," ",h.find(n=>n.id===l.room_id)?.room_number||"N/A"," ","- ",l.unit_code]})}),e.jsxs("form",{onSubmit:S,className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{value:i.unit_code,onChange:n=>c("unit_code",n.target.value),placeholder:"Unit Code"}),r.unit_code&&e.jsx("p",{className:"text-sm text-red-500",children:r.unit_code})]}),e.jsxs("div",{children:[e.jsx(m,{value:i.processor,onChange:n=>c("processor",n.target.value),placeholder:"Processor"}),r.processor&&e.jsx("p",{className:"text-sm text-red-500",children:r.processor})]}),e.jsxs("div",{children:[e.jsx(m,{value:i.ram,onChange:n=>c("ram",n.target.value),placeholder:"RAM"}),r.ram&&e.jsx("p",{className:"text-sm text-red-500",children:r.ram})]}),e.jsxs("div",{children:[e.jsx(m,{value:i.storage,onChange:n=>c("storage",n.target.value),placeholder:"Storage"}),r.storage&&e.jsx("p",{className:"text-sm text-red-500",children:r.storage})]}),e.jsxs("div",{children:[e.jsx(m,{value:i.gpu,onChange:n=>c("gpu",n.target.value),placeholder:"GPU"}),r.gpu&&e.jsx("p",{className:"text-sm text-red-500",children:r.gpu})]}),e.jsxs("div",{children:[e.jsx(m,{value:i.motherboard,onChange:n=>c("motherboard",n.target.value),placeholder:"Motherboard"}),r.motherboard&&e.jsx("p",{className:"text-sm text-red-500",children:r.motherboard})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"condition",children:"Condition"}),e.jsx(m,{id:"condition",list:"condition-options",value:i.condition,onChange:n=>c("condition",n.target.value),placeholder:"Type or select"}),e.jsx("datalist",{id:"condition-options",children:z.map(n=>e.jsx("option",{value:n.label},n.label))}),i.condition&&e.jsxs("div",{className:"mt-1 text-sm flex items-center gap-2",children:[e.jsx("span",{className:T("inline-block w-3 h-3 rounded-full",N(i.condition))}),e.jsx("span",{className:"capitalize",children:i.condition})]}),r.condition&&e.jsx("p",{className:"text-sm text-red-500",children:r.condition})]}),e.jsx(p,{type:"submit",disabled:f,children:"Update"})]})]})})}const Ce=[{label:"Functional",color:"bg-green-500"},{label:"Defective",color:"bg-red-500"},{label:"Under Maintenance",color:"bg-yellow-500"},{label:"Needs Upgrade",color:"bg-blue-500"},{label:"For Disposal",color:"bg-gray-500"}];function Se({filters:l={},filterOptions:h,onApplyFilters:g,onReset:i}){const[c,d]=j.useState(""),[f,r]=j.useState("");j.useEffect(()=>{const x=["unit_code","room_id","processor","ram","storage","gpu","motherboard","condition"].find(o=>!!l[o]);x?(d(x),r(String(l[x]))):(d(""),r(""))},[l]);const S=[{value:"unit_code",label:"Unit Code"},{value:"room_id",label:"Room"},{value:"processor",label:"Processor"},{value:"ram",label:"RAM"},{value:"storage",label:"Storage"},{value:"gpu",label:"GPU"},{value:"motherboard",label:"Motherboard"},{value:"condition",label:"Condition"}];function N(a){const x=a==="all"?"":a;r(x);const o={...l};c&&(o[c]=x),g(o)}const n=Object.values(l).some(a=>!!a);return e.jsxs(me,{children:[e.jsx(he,{asChild:!0,children:e.jsxs(p,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4"}),"Filter",n&&e.jsx(k,{className:"h-4 w-4 ml-1 cursor-pointer",onClick:a=>{a.stopPropagation(),d(""),r(""),i()}})]})}),e.jsxs(xe,{className:"w-[calc(100vw-2rem)] sm:w-[380px] p-4",children:[e.jsx("h4",{className:"font-medium mb-3 text-lg",children:"Filter Options"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs(M,{value:c,onValueChange:a=>{d(a),r("")},children:[e.jsx(B,{className:"w-full",children:e.jsx(E,{placeholder:"Select Field"})}),e.jsx(I,{children:S.map(a=>e.jsx(U,{value:a.value,children:a.label},a.value))})]}),c&&(h[c+"s"]||h[c])&&e.jsxs(M,{value:f||"all",onValueChange:N,children:[e.jsx(B,{className:"w-full",children:e.jsx(E,{placeholder:"Select Value"})}),e.jsxs(I,{children:[e.jsx(U,{value:"all",children:"All"}),Array.isArray(h[c+"s"])?h[c+"s"].map(a=>e.jsx(U,{value:a,children:a},a)):Object.entries(h[c]).map(([a,x])=>e.jsxs(U,{value:a,children:["Room ",x]},a))]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(p,{size:"sm",variant:"outline",onClick:()=>{d(""),r(""),i()},children:[e.jsx(k,{className:"mr-1 h-4 w-4"})," Reset"]})})]})]})]})}function as({units:l,rooms:h,filters:g={}}){const[i,c]=j.useState(g.search||""),[d,f]=j.useState(1),[r,S]=j.useState(null),[N,n]=j.useState(null),a=10,x=j.useMemo(()=>{const s=t=>[...new Set(t.filter(u=>u!==null&&u!==""))].sort();return{rooms:Object.fromEntries(h.map(t=>[String(t.id),t.room_number])),unit_codes:s(l.map(t=>t.unit_code)),processors:s(l.map(t=>t.processor)),rams:s(l.map(t=>t.ram)),storages:s(l.map(t=>t.storage)),gpus:s(l.map(t=>t.gpu)),motherboards:s(l.map(t=>t.motherboard)),conditions:s(l.map(t=>t.condition))}},[l,h]);function o(s){const t=Object.fromEntries(Object.entries({...s,search:i||void 0}).filter(([,u])=>u!==""&&u!==void 0));O.get("/technician/units",t,{preserveState:!0,replace:!0})}function w(){c(""),O.get("/technician/units",{},{preserveState:!0,replace:!0})}function F(s){s.key==="Enter"&&o(g)}const D=j.useMemo(()=>{if(!i)return l;const s=i.toLowerCase();return l.filter(t=>{const u=t.unit_code?.toLowerCase()||"",X=t.room?.room_number?.toLowerCase()||"";return u.includes(s)||X.includes(s)})},[l,i]),y=Math.ceil(D.length/a)||1,R=D.slice((d-1)*a,d*a),H=s=>{const t=Ce.find(u=>u.label.toLowerCase()===(s||"").toLowerCase());return t?t.color:"bg-muted"},K=s=>{_.fire({title:"Are you sure?",text:"This action will permanently delete the system unit.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(t=>{t.isConfirmed&&O.delete(`/technician/units/${s}`,{onSuccess:()=>{_.fire({title:"Deleted!",text:"System unit has been deleted.",icon:"success",timer:1500,showConfirmButton:!1})},onError:u=>{_.fire({title:"Error!",text:"Failed to delete the system unit.",icon:"error"})}})})};return e.jsxs(W,{children:[e.jsx(J,{}),e.jsxs(ee,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx(se,{}),e.jsx(re,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(ne,{children:e.jsx(ie,{children:e.jsxs(ce,{children:[e.jsx(A,{href:"/technician/dashboard",children:"Dashboard"}),e.jsx(de,{}),e.jsx(A,{href:"/technician/units","aria-current":"page",className:"font-semibold text-foreground",children:"System Units"})]})})})]}),e.jsxs("main",{className:"w-full px-6 py-4",children:[e.jsx(oe,{}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"System Units"}),e.jsx(ve,{rooms:h})]}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center justify-between mb-4",children:e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(Se,{filters:g,filterOptions:x,onApplyFilters:o,onReset:w}),e.jsx(m,{placeholder:"Search Unit Code or Room",value:i,onChange:s=>{c(s.target.value),f(1)},onKeyDown:F,className:"w-64"})]})}),e.jsx("div",{className:"overflow-x-auto rounded-lg shadow-lg",children:e.jsxs(te,{children:[e.jsx(ae,{children:e.jsxs(P,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] hover:bg-[hsl(142,34%,80%)] h-10",children:[e.jsx(v,{children:"#"}),e.jsx(v,{children:"Pc Code"}),e.jsx(v,{children:"Room"}),e.jsx(v,{children:"Processor"}),e.jsx(v,{children:"RAM"}),e.jsx(v,{children:"Storage"}),e.jsx(v,{children:"GPU"}),e.jsx(v,{children:"Motherboard"}),e.jsx(v,{children:"Condition"}),e.jsx(v,{children:"Actions"})]})}),e.jsx(le,{children:R.length>0?R.map((s,t)=>e.jsxs(P,{children:[e.jsx(b,{children:(d-1)*a+t+1}),e.jsx(b,{children:s.unit_code}),e.jsxs(b,{children:["ROOM ",s.room?.room_number||"N/A"]}),e.jsx(b,{children:s.processor}),e.jsx(b,{children:s.ram}),e.jsx(b,{children:s.storage}),e.jsx(b,{children:s.gpu}),e.jsx(b,{children:s.motherboard}),e.jsx(b,{children:s.condition&&e.jsxs("div",{className:"mt-1 text-sm flex items-center gap-2",children:[e.jsx("span",{className:T("inline-block w-3 h-3 rounded-full",H(s.condition))}),e.jsx("span",{className:"capitalize",children:s.condition})]})}),e.jsx(b,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(p,{size:"sm",className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>S(s),children:[e.jsx(je,{className:"h-4 w-4"}),"Edit"]}),e.jsxs(p,{size:"sm",className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>n(s),children:[e.jsx(ge,{className:"h-4 w-4"}),"QR"]}),e.jsxs(p,{size:"sm",variant:"destructive",className:"flex items-center gap-2",onClick:()=>K(s.id),children:[e.jsx(be,{className:"h-4 w-4"}),"Delete"]})]})})]},s.id)):e.jsx(P,{children:e.jsx(b,{colSpan:10,className:"text-center py-4",children:"No matching units found."})})})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",d," of ",y]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(p,{size:"sm",variant:"outline",disabled:d===1,onClick:()=>f(s=>s-1),children:"Previous"}),Array.from({length:y},(s,t)=>t+1).filter(s=>s===1||s===y?!0:s>=d-2&&s<=d+2).map((s,t,u)=>e.jsxs(Z.Fragment,{children:[t>0&&u[t]-u[t-1]>1&&e.jsx("span",{className:"px-1",children:"..."}),e.jsx(p,{size:"sm",variant:d===s?"default":"outline",onClick:()=>f(s),children:s})]},s)),e.jsx(p,{size:"sm",variant:"outline",disabled:d===y,onClick:()=>f(s=>s+1),children:"Next"})]})]})]})]}),r&&e.jsx(Ne,{unit:r,rooms:h,open:!!r,onClose:()=>S(null)}),N&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg text-center",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4",children:["QR Code - ",N.unit_code]}),e.jsx(pe,{value:`Unit: ${N.unit_code}`,size:200}),e.jsx("div",{className:"mt-4",children:e.jsx(p,{variant:"outline",onClick:()=>n(null),children:"Close"})})]})})]})}export{as as default};
