import{r as S,u as E,j as e,a as A,R as I}from"./app-BowO8ytr.js";import{B as N}from"./button-RbJUcQ--.js";import{A as L}from"./app-sidebar-D8ddkO_4.js";import{S as D,a as O,b as $,c as G}from"./index-DX_S1sRs.js";import{c as q}from"./createLucideIcon-C96xW_RT.js";import H from"./AddUnitModal-B-TFHhMs.js";import K from"./EditUnitModal-DshvVbft.js";import{S as R}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{I as X}from"./input-D5rdKzFL.js";import{T as Y,a as J,b as U,c as u,d as Q,e as x}from"./table-D4vbcprt.js";import"./index-D8PXKADT.js";import{B as W,a as Z,b as ee,c as T,d as se}from"./breadcrumb-D0gO2SAU.js";import{P as le,a as ae,b as re,S as p,c as b,d as g,e as f,f as o}from"./select-B1MFqEP6.js";import{F as oe}from"./funnel-B0KVC3lJ.js";import{X as B}from"./index-DxLdAQnU.js";import"./index-DPv7gmFg.js";import"./chevron-right-ID94ckL7.js";import"./dropdown-menu-D0h7hzW-.js";import"./index-DxBxXBFl.js";import"./index-DFjAK8pm.js";import"./index-7BIbAGtT.js";import"./index-Bgf-Vbb9.js";import"./index-B1EsQG3e.js";import"./dialog-PXpo6fUF.js";import"./label-DCi5K2g3.js";import"./index-XBxHNwNB.js";const ne=[{label:"Functional",color:"bg-green-500"},{label:"Defective",color:"bg-red-500"},{label:"Under Maintenance",color:"bg-yellow-500"},{label:"Needs Upgrade",color:"bg-blue-500"},{label:"For Disposal",color:"bg-gray-500"}];function ce({filters:r={},filterOptions:i,onApplyFilters:w,onReset:v}){const[c,n]=S.useState(""),[d,j]=S.useState("");S.useEffect(()=>{const h=["unit_code","room_id","processor","ram","storage","gpu","motherboard","condition"].find(C=>!!r[C]);h?(n(h),j(String(r[h]))):(n(""),j(""))},[r]);const y=[{value:"unit_code",label:"Unit Code"},{value:"room_id",label:"Room"},{value:"processor",label:"Processor"},{value:"ram",label:"RAM"},{value:"storage",label:"Storage"},{value:"gpu",label:"GPU"},{value:"motherboard",label:"Motherboard"},{value:"condition",label:"Condition"}];function m(l){const h=l==="all"?"":l;j(h);const C={...r};c&&(C[c]=h),w(C)}const _=!!r.unit_code||!!r.room_id||!!r.processor||!!r.ram||!!r.storage||!!r.gpu||!!r.motherboard||!!r.condition;return e.jsxs(le,{children:[e.jsx(ae,{asChild:!0,children:e.jsxs(N,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4"}),"Filter",_&&e.jsx(B,{className:"h-4 w-4 ml-1 cursor-pointer",onClick:l=>{l.stopPropagation(),n(""),j(""),v()}})]})}),e.jsxs(re,{className:"w-[calc(100vw-2rem)] sm:w-[380px] p-4",children:[e.jsx("h4",{className:"font-medium mb-3 text-lg",children:"Filter Options"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs(p,{value:c,onValueChange:l=>{n(l),j("")},children:[e.jsx(b,{className:"w-full",children:e.jsx(g,{placeholder:"Select Field"})}),e.jsx(f,{children:y.map(l=>e.jsx(o,{value:l.value,children:l.label},l.value))})]}),c==="unit_code"&&e.jsxs(p,{value:d||"all",onValueChange:m,children:[e.jsx(b,{className:"w-full",children:e.jsx(g,{placeholder:"Select Unit Code"})}),e.jsxs(f,{children:[e.jsx(o,{value:"all",children:"All"}),i.unit_codes.map(l=>e.jsx(o,{value:l,children:l},l))]})]}),c==="room_id"&&e.jsxs(p,{value:d||"all",onValueChange:m,children:[e.jsx(b,{className:"w-full",children:e.jsx(g,{placeholder:"Select Room"})}),e.jsxs(f,{children:[e.jsx(o,{value:"all",children:"All"}),Object.entries(i.rooms).map(([l,h])=>e.jsxs(o,{value:l,children:["Room ",h]},l))]})]}),c==="processor"&&e.jsxs(p,{value:d||"all",onValueChange:m,children:[e.jsx(b,{className:"w-full",children:e.jsx(g,{placeholder:"Select Processor"})}),e.jsxs(f,{children:[e.jsx(o,{value:"all",children:"All"}),i.processors.map(l=>e.jsx(o,{value:l,children:l},l))]})]}),c==="ram"&&e.jsxs(p,{value:d||"all",onValueChange:m,children:[e.jsx(b,{className:"w-full",children:e.jsx(g,{placeholder:"Select RAM"})}),e.jsxs(f,{children:[e.jsx(o,{value:"all",children:"All"}),i.rams.map(l=>e.jsx(o,{value:l,children:l},l))]})]}),c==="storage"&&e.jsxs(p,{value:d||"all",onValueChange:m,children:[e.jsx(b,{className:"w-full",children:e.jsx(g,{placeholder:"Select Storage"})}),e.jsxs(f,{children:[e.jsx(o,{value:"all",children:"All"}),i.storages.map(l=>e.jsx(o,{value:l,children:l},l))]})]}),c==="gpu"&&e.jsxs(p,{value:d||"all",onValueChange:m,children:[e.jsx(b,{className:"w-full",children:e.jsx(g,{placeholder:"Select GPU"})}),e.jsxs(f,{children:[e.jsx(o,{value:"all",children:"All"}),i.gpus.map(l=>e.jsx(o,{value:l,children:l},l))]})]}),c==="motherboard"&&e.jsxs(p,{value:d||"all",onValueChange:m,children:[e.jsx(b,{className:"w-full",children:e.jsx(g,{placeholder:"Select Motherboard"})}),e.jsxs(f,{children:[e.jsx(o,{value:"all",children:"All"}),i.motherboards.map(l=>e.jsx(o,{value:l,children:l},l))]})]}),c==="condition"&&e.jsxs(p,{value:d||"all",onValueChange:m,children:[e.jsx(b,{className:"w-full",children:e.jsx(g,{placeholder:"Select Condition"})}),e.jsxs(f,{children:[e.jsx(o,{value:"all",children:"All"}),i.conditions.map(l=>e.jsx(o,{value:l,children:l},l))]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(N,{size:"sm",variant:"outline",onClick:()=>{n(""),j(""),v()},children:[e.jsx(B,{className:"mr-1 h-4 w-4"})," Reset"]})})]})]})]})}function Be({units:r,rooms:i,filters:w={}}){const[v,c]=S.useState(w.search||""),[n,d]=S.useState(1),[j,y]=S.useState(null),m=10,{delete:_}=E(),l=S.useMemo(()=>{const s=a=>[...new Set(a.filter(t=>t!==null&&t!==""))].sort();return{rooms:Object.fromEntries(i.map(a=>[String(a.id),a.room_number])),unit_codes:s(r.map(a=>a.unit_code)),processors:s(r.map(a=>a.processor)),rams:s(r.map(a=>a.ram)),storages:s(r.map(a=>a.storage)),gpus:s(r.map(a=>a.gpu)),motherboards:s(r.map(a=>a.motherboard)),conditions:s(r.map(a=>a.condition))}},[r,i]);function h(s){const a=Object.fromEntries(Object.entries({...s,search:v||void 0}).filter(([,t])=>t!==""&&t!==void 0));A.get("/system-units",a,{preserveState:!0,replace:!0})}function C(){c(""),A.get("/system-units",{},{preserveState:!0,replace:!0})}function M(s){s.key==="Enter"&&h(w)}const F=S.useMemo(()=>{if(!v)return r;const s=v.toLowerCase();return r.filter(a=>{const t=a.unit_code?.toLowerCase()||"",z=a.room?.room_number?.toLowerCase()||"";return t.includes(s)||z.includes(s)})},[r,v]),P=Math.ceil(F.length/m)||1,V=F.slice((n-1)*m,n*m),k=s=>{const a=ne.find(t=>t.label.toLowerCase()===(s||"").toLowerCase());return a?a.color:"bg-muted"};return e.jsxs(D,{children:[e.jsx(L,{}),e.jsxs(O,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx($,{}),e.jsx(G,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(W,{children:e.jsx(Z,{children:e.jsxs(ee,{children:[e.jsx(T,{href:"#","aria-current":"page",children:"Assets"}),e.jsx(se,{}),e.jsx(T,{href:"/units","aria-current":"page",className:"font-semibold text-foreground",children:"System Unit Lists"})]})})})]}),e.jsxs("main",{className:"w-full px-6 py-4",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"System Units"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(ce,{filters:w,filterOptions:l,onApplyFilters:h,onReset:C}),e.jsx(X,{placeholder:"Search Unit Code or Room",value:v,onChange:s=>{c(s.target.value),d(1)},onKeyDown:M,className:"w-64"})]}),e.jsx(H,{rooms:i})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Y,{children:[e.jsx(J,{children:e.jsxs(U,{className:"h-10",children:[e.jsx(u,{className:"px-2 py-1",children:"#"}),e.jsx(u,{className:"px-2 py-1",children:"Unit Code"}),e.jsx(u,{className:"px-2 py-1",children:"Room"}),e.jsx(u,{className:"px-2 py-1",children:"Processor"}),e.jsx(u,{className:"px-2 py-1",children:"RAM"}),e.jsx(u,{className:"px-2 py-1",children:"Storage"}),e.jsx(u,{className:"px-2 py-1",children:"GPU"}),e.jsx(u,{className:"px-2 py-1",children:"Motherboard"}),e.jsx(u,{className:"px-2 py-1",children:"Condition"}),e.jsx(u,{className:"px-2 py-1",children:"Actions"})]})}),e.jsx(Q,{children:V.length>0?V.map((s,a)=>e.jsxs(U,{children:[e.jsx(x,{children:(n-1)*m+a+1}),e.jsx(x,{children:s.unit_code}),e.jsxs(x,{children:["ROOM"," ",s.room?.room_number||"N/A"]}),e.jsx(x,{children:s.processor}),e.jsx(x,{children:s.ram}),e.jsx(x,{children:s.storage}),e.jsx(x,{children:s.gpu}),e.jsx(x,{children:s.motherboard}),e.jsx(x,{children:s.condition&&e.jsxs("div",{className:"mt-1 text-sm flex items-center gap-2",children:[e.jsx("span",{className:q("inline-block w-3 h-3 rounded-full",k(s.condition))}),e.jsx("span",{className:"capitalize",children:s.condition})]})}),e.jsx(x,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(N,{size:"sm",variant:"secondary",onClick:()=>A.visit(`/system-units/view/${s.unit_code}`),children:"View"}),e.jsx(N,{size:"sm",variant:"secondary",onClick:()=>y(s),children:"Edit"}),e.jsx(N,{size:"sm",variant:"destructive",onClick:()=>{R.fire({title:`Delete ${s.unit_code}?`,text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(t=>{t.isConfirmed&&_(`/system-units/${s.id}`,{onSuccess:()=>{R.fire("Deleted!",`Unit ${s.unit_code} has been deleted.`,"success")}})})},children:"Delete"})]})})]},s.id)):e.jsx(U,{children:e.jsx(x,{colSpan:10,className:"text-center py-4",children:"No matching units found."})})})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",n," of ",P]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(N,{size:"sm",variant:"outline",disabled:n===1,onClick:()=>d(s=>s-1),children:"Previous"}),Array.from({length:P},(s,a)=>a+1).filter(s=>s===1||s===P?!0:s>=n-2&&s<=n+2).map((s,a,t)=>e.jsxs(I.Fragment,{children:[a>0&&t[a]-t[a-1]>1&&e.jsx("span",{className:"px-1",children:"..."}),e.jsx(N,{size:"sm",variant:n===s?"default":"outline",onClick:()=>d(s),children:s})]},s)),e.jsx(N,{size:"sm",variant:"outline",disabled:n===P,onClick:()=>d(s=>s+1),children:"Next"})]})]}),j&&e.jsx(K,{unit:j,rooms:i,onClose:()=>y(null)})]})]})]})}export{Be as default};
