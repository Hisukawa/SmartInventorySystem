import{u as M,j as e,r as g,L as R,R as O,a as k}from"./app-3vLMqhnz.js";import{B as u}from"./button-wZybxZUW.js";import{C as I,a as U}from"./card-C8OiHDsj.js";import{S as V,a as H,b as $,c as q}from"./avatar-C8cC5PNR.js";import{S as D}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{T as K,a as X,b as F,c as x,d as Y,e as m}from"./table-CigXlLP5.js";import{B as G,a as J,b as Q,c as A,d as W}from"./breadcrumb-iL8OPzII.js";import{T as Z}from"./technician-app-sidebar-CwoPMFna.js";import{I as B}from"./input-B89NL6q8.js";import{D as ee,a as se,b as ie,c as re}from"./dialog-DxTsVUa2.js";import{L as C}from"./label-59ajZ3Yc.js";import{c as le}from"./utils-CBfrqCZ4.js";import{P as ne,a as te,b as ae}from"./popover-7bU8L_23.js";import{S as _,a as S,b as y,c as w,d as c}from"./select--ad95f2R.js";import{E as oe}from"./eye-CyrIoDJM.js";import{P as ce}from"./pen-zPdEaDAL.js";import{T as de}from"./trash-2-B_ZmyTNi.js";import{F as me}from"./funnel-8_BO4L4q.js";import{X as he}from"./index-Ct6C1Q_B.js";import"./index-CfpO-yTh.js";import"./index-DvTIV6Gf.js";import"./index-a14Y7yQe.js";import"./dropdown-menu-DHX_ivd9.js";import"./index-Cezy_WIn.js";import"./createLucideIcon-C80kBUb2.js";import"./chevron-right-Dvw-UYj9.js";import"./index-58HsG08c.js";import"./index-CWMewDmF.js";import"./index-UnmQjHTy.js";import"./house-CDK9ky9w.js";import"./user-Cdut0ewx.js";import"./log-out-CN7z4qzL.js";import"./boxes-BWmRsK1C.js";import"./index-3PW5GnMA.js";import"./chevron-down-Beg7KCp0.js";const L=[{label:"Functional",color:"bg-green-500"},{label:"Defective",color:"bg-red-500"},{label:"Under Maintenance",color:"bg-yellow-500"},{label:"Needs Upgrade",color:"bg-blue-500"},{label:"For Disposal",color:"bg-gray-500"}];function xe({peripheral:n,rooms:d=[],units:o=[],onClose:h}){const{data:a,setData:j,put:i,processing:b,errors:t}=M({type:n?.type||"",serial_number:n?.serial_number||"",condition:n?.condition||"",room_id:n?.room_id||"",unit_id:n?.unit_id||""}),N=l=>{l.preventDefault(),i(route("technician.update",n.id),{onSuccess:()=>{D.fire({icon:"success",title:"Updated!",text:"Peripheral updated successfully.",timer:2e3,showConfirmButton:!1}),h()},onError:v=>{D.fire({icon:"error",title:"Error",text:v?.type||"Failed to update peripheral. Please check your input."})}})},f=l=>{const v=L.find(P=>P.label.toLowerCase()===l.toLowerCase());return v?v.color:"bg-gray-300"};return e.jsx(ee,{open:!0,onOpenChange:l=>!l&&h(),children:e.jsxs(se,{className:"max-w-lg",children:[e.jsx(ie,{children:e.jsxs(re,{children:["Edit Peripheral â€“ ",n?.peripheral_code]})}),e.jsxs("form",{onSubmit:N,className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"type",children:"Type"}),e.jsx(B,{id:"type",value:a.type,onChange:l=>j("type",l.target.value),placeholder:"e.g. Keyboard, Mouse, Monitor"}),t.type&&e.jsx("p",{className:"text-sm text-red-500",children:t.type})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"serial_number",children:"Serial Number"}),e.jsx(B,{id:"serial_number",value:a.serial_number,onChange:l=>j("serial_number",l.target.value),placeholder:"Serial Number"}),t.serial_number&&e.jsx("p",{className:"text-sm text-red-500",children:t.serial_number})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"condition",children:"Condition"}),e.jsx(B,{id:"condition",list:"condition-options",value:a.condition,onChange:l=>j("condition",l.target.value),placeholder:"Type or select"}),e.jsx("datalist",{id:"condition-options",children:L.map(l=>e.jsx("option",{value:l.label},l.label))}),a.condition&&e.jsxs("div",{className:"mt-1 text-sm flex items-center gap-2",children:[e.jsx("span",{className:le("inline-block w-3 h-3 rounded-full",f(a.condition))}),e.jsx("span",{className:"capitalize",children:a.condition})]}),t.condition&&e.jsx("p",{className:"text-sm text-red-500",children:t.condition})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"room_id",children:"Room"}),e.jsxs("select",{id:"room_id",className:"w-full border rounded-md p-2",value:a.room_id,onChange:l=>j("room_id",l.target.value),children:[e.jsx("option",{value:"",children:"Select Room"}),d.length>0?d.map(l=>e.jsx("option",{value:l.id,children:l.room_number},l.id)):e.jsx("option",{disabled:!0,children:"No rooms available"})]}),t.room_id&&e.jsx("p",{className:"text-sm text-red-500",children:t.room_id})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"unit_id",children:"Unit"}),e.jsxs("select",{id:"unit_id",className:"w-full border rounded-md p-2",value:a.unit_id,onChange:l=>j("unit_id",l.target.value),children:[e.jsx("option",{value:"",children:"Select Unit"}),o.length>0?o.map(l=>e.jsx("option",{value:l.id,children:l.unit_code},l.id)):e.jsx("option",{disabled:!0,children:"No units available"})]}),t.unit_id&&e.jsx("p",{className:"text-sm text-red-500",children:t.unit_id})]}),e.jsx(u,{type:"submit",disabled:b,children:"Update"})]})]})})}function ue({filters:n,filterOptions:d,onApplyFilters:o}){const[h,a]=g.useState(""),j=()=>{const i={type:void 0,condition:void 0,room_id:void 0,unit_code:void 0};a(""),o(i)};return e.jsxs(ne,{children:[e.jsx(te,{asChild:!0,children:e.jsxs(u,{variant:"outline",size:"sm",children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),"Filters"]})}),e.jsx(ae,{className:"w-72",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(_,{value:h,onValueChange:a,children:[e.jsx(S,{children:e.jsx(y,{placeholder:"Select filter field"})}),e.jsxs(w,{children:[e.jsx(c,{value:"type",children:"Type"}),e.jsx(c,{value:"condition",children:"Condition"}),e.jsx(c,{value:"room",children:"Room"}),e.jsx(c,{value:"unit",children:"Unit"})]})]}),h==="type"&&e.jsxs(_,{value:n.type||"all",onValueChange:i=>o({...n,type:i==="all"?void 0:i}),children:[e.jsx(S,{children:e.jsx(y,{placeholder:"Select Type"})}),e.jsxs(w,{children:[e.jsx(c,{value:"all",children:"All"}),d.types.map(i=>e.jsx(c,{value:i,children:i},i))]})]}),h==="condition"&&e.jsxs(_,{value:n.condition||"all",onValueChange:i=>o({...n,condition:i==="all"?void 0:i}),children:[e.jsx(S,{children:e.jsx(y,{placeholder:"Select Condition"})}),e.jsxs(w,{children:[e.jsx(c,{value:"all",children:"All"}),d.conditions.map(i=>e.jsx(c,{value:i,children:i},i))]})]}),h==="room"&&e.jsxs(_,{value:n.room_id||"all",onValueChange:i=>o({...n,room_id:i==="all"?void 0:i}),children:[e.jsx(S,{children:e.jsx(y,{placeholder:"Select Room"})}),e.jsxs(w,{children:[e.jsx(c,{value:"all",children:"All"}),Object.entries(d.rooms).map(([i,b])=>e.jsxs(c,{value:i,children:["Room ",b]},i))]})]}),h==="unit"&&e.jsxs(_,{value:n.unit_code||"all",onValueChange:i=>o({...n,unit_code:i==="all"?void 0:i}),children:[e.jsx(S,{children:e.jsx(y,{placeholder:"Select Unit"})}),e.jsxs(w,{children:[e.jsx(c,{value:"all",children:"All"}),d.units.map(i=>e.jsx(c,{value:i,children:i},i))]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(u,{size:"sm",variant:"outline",onClick:j,className:"flex items-center gap-1",children:[e.jsx(he,{className:"h-4 w-4"}),"Reset All"]})})]})})]})}function Je({peripherals:n,existingRooms:d,existingUnits:o,filters:h={}}){const[a,j]=g.useState(""),[i,b]=g.useState(null),[t,N]=g.useState(1),f=10,l=g.useMemo(()=>{const s=r=>[...new Set(r.filter(p=>p))].sort();return{types:s(n.map(r=>r.type)),conditions:s(n.map(r=>r.condition)),rooms:Object.fromEntries(d.map(r=>[String(r.id),r.room_number])),units:s(o.map(r=>r.unit_code))}},[n,d,o]);function v(s){const r=Object.fromEntries(Object.entries({...s,search:a||void 0}).filter(([,p])=>p!==""&&p!==void 0));k.get("/technician/peripherals",r,{preserveState:!0,replace:!0})}const P=g.useMemo(()=>{if(!a)return n;const s=a.toLowerCase();return n.filter(r=>[r.peripheral_code,r.type,r.serial_number,r.condition,r.room?.room_number,r.unit?.unit_code].filter(Boolean).some(p=>p.toLowerCase().includes(s)))},[n,a]),T=Math.ceil(P.length/f)||1,E=P.slice((t-1)*f,t*f);function z(s){D.fire({title:"Are you sure?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(r=>{r.isConfirmed&&k.delete(`/technician/peripherals/${s}`,{onSuccess:()=>{D.fire({icon:"success",title:"Deleted!",text:"Peripheral deleted successfully.",timer:2e3,showConfirmButton:!1})}})})}return e.jsxs(V,{children:[e.jsx(Z,{}),e.jsxs(H,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx($,{}),e.jsx(q,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(G,{children:e.jsx(J,{children:e.jsxs(Q,{children:[e.jsx(A,{href:"/technician/dashboard",children:"Dashboard"}),e.jsx(W,{}),e.jsx(A,{href:"/technician/peripherals","aria-current":"page",className:"font-semibold text-foreground",children:"Peripherals"})]})})}),e.jsx("div",{className:"flex-1"})]}),e.jsx("main",{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-5",children:"Technician Peripherals"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(ue,{filters:h,filterOptions:l,onApplyFilters:v}),e.jsx(B,{placeholder:"Search peripherals...",value:a,onChange:s=>j(s.target.value),className:"w-64"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(R,{href:"/technician/peripherals/create",children:e.jsx(u,{className:"bg-[hsl(142,31%,51%)] hover:bg-[hsl(142,31%,45%)] text-white font-medium",children:"Add Peripheral"})})})]}),e.jsx(I,{children:e.jsxs(U,{className:"p-0",children:[e.jsxs(K,{children:[e.jsx(X,{children:e.jsxs(F,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] hover:bg-[hsl(142,34%,80%)] h-10",children:[e.jsx(x,{children:"#"}),e.jsx(x,{children:"Peripheral Code"}),e.jsx(x,{children:"Type"}),e.jsx(x,{children:"Brand"}),e.jsx(x,{children:"Model"}),e.jsx(x,{children:"Serial Number"}),e.jsx(x,{children:"Condition"}),e.jsx(x,{children:"Room"}),e.jsx(x,{children:"Unit"}),e.jsx(x,{children:"Actions"})]})}),e.jsx(Y,{children:E.length>0?E.map((s,r)=>e.jsxs(F,{children:[e.jsx(m,{children:(t-1)*f+r+1}),e.jsx(m,{children:s.peripheral_code}),e.jsx(m,{children:s.type}),e.jsx(m,{children:s.brand}),e.jsx(m,{children:s.model}),e.jsx(m,{children:s.serial_number}),e.jsx(m,{children:s.condition}),e.jsx(m,{children:s.room?`ROOM ${s.room.room_number}`:"N/A"}),e.jsx(m,{children:s.unit?s.unit.unit_code:"N/A"}),e.jsxs(m,{className:"space-x-2 flex items-center",children:[e.jsx(R,{href:`/technician/peripherals/${s.id}`,children:e.jsxs(u,{size:"sm",className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",children:[e.jsx(oe,{className:"h-4 w-4"}),"View"]})}),e.jsxs(u,{size:"sm",className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>b(s),children:[e.jsx(ce,{className:"h-4 w-4"}),"Edit"]}),e.jsxs(u,{size:"sm",variant:"destructive",className:"flex items-center gap-2",onClick:()=>z(s.id),children:[e.jsx(de,{className:"h-4 w-4"}),"Delete"]})]})]},s.id)):e.jsx(F,{children:e.jsx(m,{colSpan:"10",className:"text-center",children:"No peripherals found."})})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",t," of ",T]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{size:"sm",variant:"outline",disabled:t===1,onClick:()=>N(t-1),children:"Previous"}),Array.from({length:T},(s,r)=>r+1).filter(s=>s===1||s===T?!0:s>=t-2&&s<=t+2).map((s,r,p)=>e.jsxs(O.Fragment,{children:[r>0&&p[r]-p[r-1]>1&&e.jsx("span",{className:"px-2",children:"..."}),e.jsx(u,{size:"sm",variant:t===s?"default":"outline",onClick:()=>N(s),children:s})]},s)),e.jsx(u,{size:"sm",variant:"outline",disabled:t===T,onClick:()=>N(t+1),children:"Next"})]})]})]})})]})}),i&&e.jsx(xe,{peripheral:i,rooms:d,units:o,onClose:()=>b(null)})]})]})}export{Je as default};
