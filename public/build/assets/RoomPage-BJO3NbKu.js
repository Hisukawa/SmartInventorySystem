import{r as a,u as z,j as e,a as j}from"./app-CvYAaXE4.js";import{Q as k}from"./index-DE4RW4fQ.js";import{S as g}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{N as le}from"./Notification-Dci1R-5w.js";import{T as ce,a as de,b as E,c,d as me,e as d}from"./table-CTrDeHFm.js";import{B as t}from"./button-ByIpfzLT.js";import{I as b}from"./input-CfVp7Oww.js";import{D as M,a as O,b as xe,c as q}from"./dialog-BOvLvhDx.js";import{A as ue}from"./app-sidebar-W3OsBovA.js";import{B as pe,a as he,b as fe,c as je}from"./breadcrumb-CGKBgSLU.js";import{S as ge,a as be,b as ve,c as we}from"./index-Dt3N524-.js";import"./createLucideIcon-CGz97te6.js";import"./index-BlnhrZ5s.js";import"./index-DVY2WT84.js";import"./index-BYeNgevf.js";import"./index-BuAS3bmi.js";import"./chevron-right-C0_gjrgv.js";import"./dropdown-menu-FMNMyDeg.js";import"./index-BBWrwkiU.js";import"./index-BJ4fUgmt.js";function Fe({rooms:l,search:I}){const[v,Q]=a.useState(I||""),[w,S]=a.useState(!1),[A,m]=a.useState(!1),[L,$]=a.useState(null),[x,N]=a.useState(""),[u,y]=a.useState(""),[H,R]=a.useState(!1),[C,_]=a.useState(""),{data:P,setData:U,post:F,reset:K,processing:X,errors:T}=z({room_number:""}),{data:Y,setData:D,put:G,processing:J,errors:B,reset:V}=z({room_number:""}),W=s=>{s.preventDefault(),F("/admin/rooms",{preserveScroll:!0,onSuccess:()=>{K(),_("Room added successfully!"),setTimeout(()=>_(""),5e3)}})},Z=s=>{s.preventDefault(),G(`/admin/rooms/${L.id}`,{preserveScroll:!0,onSuccess:()=>{m(!1),V(),g.fire({icon:"success",title:"Room updated!",showConfirmButton:!1,timer:1500})}})},ee=s=>{$(s),D("room_number",s.room_number),m(!0)},se=s=>{s.key==="Enter"&&j.get("/admin/rooms",{search:v})},te=(s,r)=>{s&&(N(s),y(r))},re=()=>{const s=document.getElementById("qr-download"),o=new XMLSerializer().serializeToString(s),p=new Blob([o],{type:"image/svg+xml;charset=utf-8"}),ne=URL.createObjectURL(p),h=new Image;h.onload=()=>{const n=document.createElement("canvas"),i=n.getContext("2d");n.width=220,n.height=260,i.fillStyle="#fff",i.fillRect(0,0,n.width,n.height),i.drawImage(h,10,10,200,200),i.fillStyle="#000",i.font="bold 16px sans-serif",i.textAlign="center",i.fillText(`ROOM ${u}`,n.width/2,235);const ie=n.toDataURL("image/png"),f=document.createElement("a");f.href=ie,f.download=`room-${u}-qr.png`,f.click()},h.src=ne},ae=async()=>{await navigator.clipboard.writeText(x),R(!0),setTimeout(()=>R(!1),2e3)},oe=s=>{g.fire({title:"Are you sure?",text:"This room will be permanently deleted.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(r=>{r.isConfirmed&&j.delete(`/admin/rooms/${s}`,{preserveScroll:!0,onSuccess:()=>{g.fire({icon:"success",title:"Deleted!",text:"The room has been deleted.",timer:1500,showConfirmButton:!1})}})})};return e.jsxs(ge,{children:[e.jsx(ue,{}),e.jsxs(be,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx(ve,{}),e.jsx(we,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(pe,{className:"",children:e.jsx(he,{children:e.jsx(fe,{children:e.jsx(je,{href:"/admin/rooms","aria-current":"page",className:"font-semibold text-foreground",children:"Room Lists"})})})}),e.jsx("div",{className:"flex-1"}),e.jsx(le,{})]}),e.jsxs("main",{className:"w-full px-6 py-4 overflow-y-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h1",{className:"text-xl font-bold",children:"Room Management"})}),C&&e.jsx("div",{className:"mb-4 p-3 bg-green-100 text-green-800 rounded shadow text-sm",children:C}),e.jsx(M,{open:A,onOpenChange:m,children:e.jsxs(O,{children:[e.jsx(xe,{children:e.jsx(q,{children:"Edit Room"})}),e.jsxs("form",{onSubmit:Z,className:"space-y-4",children:[e.jsx(b,{placeholder:"e.g. 101",value:Y.room_number,onChange:s=>D("room_number",s.target.value)}),B.room_number&&e.jsx("p",{className:"text-sm text-red-500",children:B.room_number}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(t,{type:"button",variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsx(t,{type:"submit",disabled:J,children:"Update"})]})]})]})}),e.jsxs("div",{className:"flex transition-all duration-700 ease-in-out relative",children:[e.jsxs("div",{className:`flex-1 transition-all duration-700 ease-in-out ${w?"mr-[400px] sm:mr-[500px]":"mr-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 gap-2",children:[e.jsx(b,{placeholder:"Search rooms...",value:v,onChange:s=>Q(s.target.value),onKeyDown:se,className:"w-full sm:w-1/3"}),e.jsx(t,{onClick:()=>S(!0),children:"Add Room"})]}),e.jsx("div",{children:e.jsxs("div",{className:"rounded-md border transition-all duration-700 ease-in-out",children:[e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:e.jsxs(ce,{children:[e.jsx(de,{children:e.jsxs(E,{children:[e.jsx(c,{children:"#"}),e.jsx(c,{children:"Room Name"}),e.jsx(c,{children:"Room Code"}),e.jsx(c,{children:"QR Code"}),e.jsx(c,{children:"Actions"})]})}),e.jsx(me,{children:l.data.map((s,r)=>{const o=typeof s.room_path=="string"?`${window.location.origin}/room/${s.room_path}`:null;return e.jsxs(E,{children:[e.jsx(d,{children:(l.current_page-1)*l.per_page+r+1}),e.jsxs(d,{children:["ROOM"," ",s.room_number]}),e.jsx(d,{children:s.room_path}),e.jsx(d,{children:o?e.jsx("div",{className:"w-16 h-16 bg-white p-1 rounded cursor-pointer m-1",onClick:p=>{p.stopPropagation(),te(o,s.room_number)},children:e.jsx(k,{value:o,size:64})}):e.jsx("span",{className:"text-sm text-gray-500",children:"No QR"})}),e.jsxs(d,{children:[e.jsx(t,{variant:"outline",size:"sm",onClick:()=>ee(s),className:"mr-2",children:"Edit"}),e.jsx(t,{variant:"destructive",size:"sm",onClick:()=>oe(s.id),children:"Delete"})]})]},s.id)})})]})}),e.jsxs("div",{className:"mt-2 flex flex-col sm:flex-row justify-between items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground m-2",children:["Page ",l.current_page," of"," ",l.last_page]}),e.jsx("div",{className:"flex flex-wrap justify-center items-center gap-2",children:l.links.map((s,r)=>{const o=s.label.replace("&laquo;","«").replace("&raquo;","»");return e.jsx(t,{variant:s.active?"default":"ghost",size:"sm",className:"min-w-[36px] px-3 py-1",onClick:()=>s.url&&j.visit(s.url,{preserveState:!0,preserveScroll:!0}),disabled:!s.url,dangerouslySetInnerHTML:{__html:o}},r)})})]})]})})]}),e.jsxs("div",{className:`fixed top-[56px] right-0 h-[calc(100vh-4rem)] w-[400px] sm:w-[500px] bg-white border-l shadow-lg z-40 p-4 overflow-y-auto transform transition-transform duration-700 ease-in-out ${w?"translate-x-0":"translate-x-full"}`,children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h2",{className:"text-lg font-semibold",children:"Add Room"})}),e.jsxs("form",{onSubmit:W,className:"space-y-4",children:[e.jsx(b,{placeholder:"e.g. 101",value:P.room_number,onChange:s=>U("room_number",s.target.value)}),T.room_number&&e.jsx("p",{className:"text-sm text-red-500",children:T.room_number}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(t,{type:"button",variant:"outline",onClick:()=>S(!1),children:"Cancel"}),e.jsx(t,{type:"submit",disabled:X,children:"Save"})]})]})]})]}),e.jsx(M,{open:!!x,onOpenChange:()=>{N(""),y("")},children:e.jsxs(O,{className:"max-w-sm text-center",children:[e.jsxs(q,{children:["ROOM ",u]}),e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"inline-block p-4 bg-white rounded cursor-pointer",onClick:s=>{s.stopPropagation(),ae()},children:[e.jsx(k,{id:"qr-download",value:x,size:200}),e.jsx("p",{className:"text-xs mt-2 text-muted-foreground",children:"Click QR to copy link"})]}),H&&e.jsx("p",{className:"text-green-600 text-sm text-center mt-1",children:"Copied to clipboard!"}),e.jsx(t,{className:"mt-4",onClick:re,children:"Download QR"})]})]})})]})]})]})}export{Fe as default};
