import{u as M,j as e,r as g,L as k,R as O,a as A}from"./app-y5BW-1yv.js";import{B as u}from"./button-DK-NKz8k.js";import{C as I,a as U}from"./card-DdKvUO3J.js";import{S as V,a as H,b as $,c as q}from"./index-SsKSEojR.js";import{S as D}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{T as K,a as X,b as F,c as x,d as Y,e as h}from"./table-C_DkX_Ys.js";import{B as G,a as J,b as Q,c as E,d as W}from"./breadcrumb-DPrCEZGT.js";import{T as Z}from"./technician-app-sidebar-yYBdJM3S.js";import{I as B}from"./input-DqNdnDmq.js";import{D as ee,a as ie,b as re,c as se}from"./dialog-PjvsacFO.js";import{L as C}from"./label-DZlrPtyS.js";import{c as le}from"./createLucideIcon-CjmKo_X0.js";import{P as ne,a as te,b as ae,S as _,c as S,d as y,e as w,f as c}from"./select-BaT-p1bn.js";import{F as oe}from"./funnel-BMGell7c.js";import{X as ce}from"./index-DkqfgmEX.js";import"./index-CuOTi53j.js";import"./index-YZEw1Iku.js";import"./index-DYGrkyh1.js";import"./dropdown-menu-Dr2tabDf.js";import"./index-C2swjSGG.js";import"./chevron-right-CVXBF1I-.js";import"./index-BQYS6HsA.js";import"./user-DVh4Vb0d.js";import"./send-Cai-S7Pa.js";import"./index-5CgBNfIv.js";const L=[{label:"Functional",color:"bg-green-500"},{label:"Defective",color:"bg-red-500"},{label:"Under Maintenance",color:"bg-yellow-500"},{label:"Needs Upgrade",color:"bg-blue-500"},{label:"For Disposal",color:"bg-gray-500"}];function de({peripheral:n,rooms:d=[],units:o=[],onClose:m}){const{data:a,setData:j,put:r,processing:b,errors:t}=M({type:n?.type||"",serial_number:n?.serial_number||"",condition:n?.condition||"",room_id:n?.room_id||"",unit_id:n?.unit_id||""}),N=l=>{l.preventDefault(),r(route("technician.update",n.id),{onSuccess:()=>{D.fire({icon:"success",title:"Updated!",text:"Peripheral updated successfully.",timer:2e3,showConfirmButton:!1}),m()},onError:v=>{D.fire({icon:"error",title:"Error",text:v?.type||"Failed to update peripheral. Please check your input."})}})},f=l=>{const v=L.find(P=>P.label.toLowerCase()===l.toLowerCase());return v?v.color:"bg-gray-300"};return e.jsx(ee,{open:!0,onOpenChange:l=>!l&&m(),children:e.jsxs(ie,{className:"max-w-lg",children:[e.jsx(re,{children:e.jsxs(se,{children:["Edit Peripheral â€“ ",n?.peripheral_code]})}),e.jsxs("form",{onSubmit:N,className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"type",children:"Type"}),e.jsx(B,{id:"type",value:a.type,onChange:l=>j("type",l.target.value),placeholder:"e.g. Keyboard, Mouse, Monitor"}),t.type&&e.jsx("p",{className:"text-sm text-red-500",children:t.type})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"serial_number",children:"Serial Number"}),e.jsx(B,{id:"serial_number",value:a.serial_number,onChange:l=>j("serial_number",l.target.value),placeholder:"Serial Number"}),t.serial_number&&e.jsx("p",{className:"text-sm text-red-500",children:t.serial_number})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"condition",children:"Condition"}),e.jsx(B,{id:"condition",list:"condition-options",value:a.condition,onChange:l=>j("condition",l.target.value),placeholder:"Type or select"}),e.jsx("datalist",{id:"condition-options",children:L.map(l=>e.jsx("option",{value:l.label},l.label))}),a.condition&&e.jsxs("div",{className:"mt-1 text-sm flex items-center gap-2",children:[e.jsx("span",{className:le("inline-block w-3 h-3 rounded-full",f(a.condition))}),e.jsx("span",{className:"capitalize",children:a.condition})]}),t.condition&&e.jsx("p",{className:"text-sm text-red-500",children:t.condition})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"room_id",children:"Room"}),e.jsxs("select",{id:"room_id",className:"w-full border rounded-md p-2",value:a.room_id,onChange:l=>j("room_id",l.target.value),children:[e.jsx("option",{value:"",children:"Select Room"}),d.length>0?d.map(l=>e.jsx("option",{value:l.id,children:l.room_number},l.id)):e.jsx("option",{disabled:!0,children:"No rooms available"})]}),t.room_id&&e.jsx("p",{className:"text-sm text-red-500",children:t.room_id})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"unit_id",children:"Unit"}),e.jsxs("select",{id:"unit_id",className:"w-full border rounded-md p-2",value:a.unit_id,onChange:l=>j("unit_id",l.target.value),children:[e.jsx("option",{value:"",children:"Select Unit"}),o.length>0?o.map(l=>e.jsx("option",{value:l.id,children:l.unit_code},l.id)):e.jsx("option",{disabled:!0,children:"No units available"})]}),t.unit_id&&e.jsx("p",{className:"text-sm text-red-500",children:t.unit_id})]}),e.jsx(u,{type:"submit",disabled:b,children:"Update"})]})]})})}function he({filters:n,filterOptions:d,onApplyFilters:o}){const[m,a]=g.useState(""),j=()=>{const r={type:void 0,condition:void 0,room_id:void 0,unit_code:void 0};a(""),o(r)};return e.jsxs(ne,{children:[e.jsx(te,{asChild:!0,children:e.jsxs(u,{variant:"outline",size:"sm",children:[e.jsx(oe,{className:"mr-2 h-4 w-4"}),"Filters"]})}),e.jsx(ae,{className:"w-72",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(_,{value:m,onValueChange:a,children:[e.jsx(S,{children:e.jsx(y,{placeholder:"Select filter field"})}),e.jsxs(w,{children:[e.jsx(c,{value:"type",children:"Type"}),e.jsx(c,{value:"condition",children:"Condition"}),e.jsx(c,{value:"room",children:"Room"}),e.jsx(c,{value:"unit",children:"Unit"})]})]}),m==="type"&&e.jsxs(_,{value:n.type||"all",onValueChange:r=>o({...n,type:r==="all"?void 0:r}),children:[e.jsx(S,{children:e.jsx(y,{placeholder:"Select Type"})}),e.jsxs(w,{children:[e.jsx(c,{value:"all",children:"All"}),d.types.map(r=>e.jsx(c,{value:r,children:r},r))]})]}),m==="condition"&&e.jsxs(_,{value:n.condition||"all",onValueChange:r=>o({...n,condition:r==="all"?void 0:r}),children:[e.jsx(S,{children:e.jsx(y,{placeholder:"Select Condition"})}),e.jsxs(w,{children:[e.jsx(c,{value:"all",children:"All"}),d.conditions.map(r=>e.jsx(c,{value:r,children:r},r))]})]}),m==="room"&&e.jsxs(_,{value:n.room_id||"all",onValueChange:r=>o({...n,room_id:r==="all"?void 0:r}),children:[e.jsx(S,{children:e.jsx(y,{placeholder:"Select Room"})}),e.jsxs(w,{children:[e.jsx(c,{value:"all",children:"All"}),Object.entries(d.rooms).map(([r,b])=>e.jsxs(c,{value:r,children:["Room ",b]},r))]})]}),m==="unit"&&e.jsxs(_,{value:n.unit_code||"all",onValueChange:r=>o({...n,unit_code:r==="all"?void 0:r}),children:[e.jsx(S,{children:e.jsx(y,{placeholder:"Select Unit"})}),e.jsxs(w,{children:[e.jsx(c,{value:"all",children:"All"}),d.units.map(r=>e.jsx(c,{value:r,children:r},r))]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(u,{size:"sm",variant:"outline",onClick:j,className:"flex items-center gap-1",children:[e.jsx(ce,{className:"h-4 w-4"}),"Reset All"]})})]})})]})}function ze({peripherals:n,existingRooms:d,existingUnits:o,filters:m={}}){const[a,j]=g.useState(""),[r,b]=g.useState(null),[t,N]=g.useState(1),f=10,l=g.useMemo(()=>{const i=s=>[...new Set(s.filter(p=>p))].sort();return{types:i(n.map(s=>s.type)),conditions:i(n.map(s=>s.condition)),rooms:Object.fromEntries(d.map(s=>[String(s.id),s.room_number])),units:i(o.map(s=>s.unit_code))}},[n,d,o]);function v(i){const s=Object.fromEntries(Object.entries({...i,search:a||void 0}).filter(([,p])=>p!==""&&p!==void 0));A.get("/technician/peripherals",s,{preserveState:!0,replace:!0})}const P=g.useMemo(()=>{if(!a)return n;const i=a.toLowerCase();return n.filter(s=>[s.peripheral_code,s.type,s.serial_number,s.condition,s.room?.room_number,s.unit?.unit_code].filter(Boolean).some(p=>p.toLowerCase().includes(i)))},[n,a]),T=Math.ceil(P.length/f)||1,R=P.slice((t-1)*f,t*f);function z(i){D.fire({title:"Are you sure?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(s=>{s.isConfirmed&&A.delete(`/technician/peripherals/${i}`,{onSuccess:()=>{D.fire({icon:"success",title:"Deleted!",text:"Peripheral deleted successfully.",timer:2e3,showConfirmButton:!1})}})})}return e.jsxs(V,{children:[e.jsx(Z,{}),e.jsxs(H,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx($,{}),e.jsx(q,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(G,{children:e.jsx(J,{children:e.jsxs(Q,{children:[e.jsx(E,{href:"/technician/dashboard",children:"Dashboard"}),e.jsx(W,{}),e.jsx(E,{href:"/technician/peripherals","aria-current":"page",className:"font-semibold text-foreground",children:"Peripherals"})]})})}),e.jsx("div",{className:"flex-1"})]}),e.jsx("main",{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-5",children:"Technician Peripherals"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(he,{filters:m,filterOptions:l,onApplyFilters:v}),e.jsx(B,{placeholder:"Search peripherals...",value:a,onChange:i=>j(i.target.value),className:"w-64"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(k,{href:"/technician/peripherals/create",children:e.jsx(u,{children:"Add Peripheral"})})})]}),e.jsx(I,{children:e.jsxs(U,{children:[e.jsxs(K,{children:[e.jsx(X,{children:e.jsxs(F,{children:[e.jsx(x,{children:"#"}),e.jsx(x,{children:"Peripheral Code"}),e.jsx(x,{children:"Type"}),e.jsx(x,{children:"Brand"}),e.jsx(x,{children:"Model"}),e.jsx(x,{children:"Serial Number"}),e.jsx(x,{children:"Condition"}),e.jsx(x,{children:"Room"}),e.jsx(x,{children:"Unit"}),e.jsx(x,{children:"Actions"})]})}),e.jsx(Y,{children:R.length>0?R.map((i,s)=>e.jsxs(F,{children:[e.jsx(h,{children:(t-1)*f+s+1}),e.jsx(h,{children:i.peripheral_code}),e.jsx(h,{children:i.type}),e.jsx(h,{children:i.brand}),e.jsx(h,{children:i.model}),e.jsx(h,{children:i.serial_number}),e.jsx(h,{children:i.condition}),e.jsx(h,{children:i.room?`ROOM ${i.room.room_number}`:"N/A"}),e.jsx(h,{children:i.unit?i.unit.unit_code:"N/A"}),e.jsxs(h,{className:"space-x-2",children:[e.jsx(k,{href:`/technician/peripherals/${i.id}`,children:e.jsx(u,{variant:"secondary",size:"sm",children:"View"})}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>b(i),children:"Edit"}),e.jsx(u,{variant:"destructive",size:"sm",onClick:()=>z(i.id),children:"Delete"})]})]},i.id)):e.jsx(F,{children:e.jsx(h,{colSpan:"10",className:"text-center",children:"No peripherals found."})})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",t," of ",T]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{size:"sm",variant:"outline",disabled:t===1,onClick:()=>N(t-1),children:"Previous"}),Array.from({length:T},(i,s)=>s+1).filter(i=>i===1||i===T?!0:i>=t-2&&i<=t+2).map((i,s,p)=>e.jsxs(O.Fragment,{children:[s>0&&p[s]-p[s-1]>1&&e.jsx("span",{className:"px-2",children:"..."}),e.jsx(u,{size:"sm",variant:t===i?"default":"outline",onClick:()=>N(i),children:i})]},i)),e.jsx(u,{size:"sm",variant:"outline",disabled:t===T,onClick:()=>N(t+1),children:"Next"})]})]})]})})]})}),r&&e.jsx(de,{peripheral:r,rooms:d,units:o,onClose:()=>b(null)})]})]})}export{ze as default};
