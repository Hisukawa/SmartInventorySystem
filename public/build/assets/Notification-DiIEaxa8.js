import{r as o,j as e,c as l}from"./app-DEBeoYKq.js";import{B as m}from"./avatar-CV9EsYgD.js";function p(){const[a,i]=o.useState([]),[n,c]=o.useState(!1);o.useEffect(()=>{const t=async()=>{try{const r=await l.get("/notifications");i(r.data)}catch(r){console.error("Failed to fetch notifications:",r)}};t();const s=setInterval(t,5e3);return()=>clearInterval(s)},[]);const d=async t=>{try{await l.patch(`/notifications/${t}/read`),i(s=>s.filter(r=>r.id!==t))}catch(s){console.error("Failed to mark notification as read",s)}},x=async()=>{try{await l.patch("/notifications/mark-all-read"),i([])}catch(t){console.error("Failed to mark all notifications as read",t)}};return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>c(!n),className:"relative p-2 rounded-full hover:bg-gray-100",children:[e.jsx(m,{className:"w-6 h-6 text-gray-700"}),a.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs px-1 rounded-full",children:a.length})]}),n&&e.jsxs("div",{className:"absolute right-0 mt-2 w-80 sm:w-96 max-w-[95vw] sm:max-w-sm bg-white shadow-lg rounded-lg overflow-hidden z-50",children:[e.jsxs("div",{className:"p-3 border-b font-semibold flex justify-between items-center",children:[e.jsx("span",{children:"Notifications"}),a.length>0&&e.jsx("button",{onClick:x,className:"text-xs text-blue-600 hover:underline",children:"Mark all as read"})]}),e.jsx("ul",{className:"max-h-64 overflow-y-auto",children:a.length>0?a.map(t=>e.jsxs("li",{onClick:()=>d(t.id),className:"px-4 py-2 hover:bg-gray-50 cursor-pointer border-b",children:[e.jsx("p",{className:"text-sm font-bold",children:t.data.user_name}),e.jsxs("p",{className:"text-sm",children:["Condition: ",t.data.condition]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Room ID: ",t.data.room_id]}),e.jsx("p",{className:"text-xs",children:t.data.remarks})]},t.id)):e.jsx("li",{className:"p-4 text-gray-500 text-sm",children:"No notifications"})}),e.jsx("div",{className:"p-2 text-center border-t",children:e.jsx("a",{href:"/admin/faculty/reports",className:"text-sm text-blue-600 hover:underline",children:"View all"})})]})]})}export{p as N};
