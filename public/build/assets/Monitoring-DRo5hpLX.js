import{r as t,j as e,H as z,c as _}from"./app-DOsJYAZr.js";import{S as Z,a as q,b as G,c as J}from"./avatar-DEPZ2ohQ.js";import{A as K}from"./app-sidebar-BWrk-TeW.js";import{N as Q}from"./Notification-DiH82RMq.js";import{C as w,b as S,c as C,a as F}from"./card-CrNlYN97.js";import{B as U,a as V,b as W,c as X}from"./breadcrumb-C-NznmIM.js";import{B as Y}from"./badge-Cegqifm6.js";import{T as ee,f as se,a as te,b as o,c as l,d as ae,e as r}from"./table-CkEycEh3.js";import{I as D}from"./input-C5mRaj1H.js";import{B as g}from"./button-BJkAWaq5.js";import{F as re}from"./funnel-6pbpbGBA.js";import"./createLucideIcon-BCibPqi-.js";import"./index-BCvnxMa-.js";import"./utils-CBfrqCZ4.js";import"./index-B0seKdI2.js";import"./index-DUfoXKAx.js";import"./index-azXK0IiM.js";import"./dropdown-menu-DvBtlFDx.js";import"./index-BPrBitMd.js";import"./chevron-right-DloDiWLc.js";import"./index-iH8E8t8T.js";import"./index-BvrKgbP5.js";import"./user-CC-r41EW.js";import"./keyboard-CXkFtwr5.js";import"./boxes-BVsSIFuJ.js";import"./users-CKQcK-DL.js";import"./chevron-down-C7-3JduT.js";import"./bell-mBm1B6ln.js";function Ge({children:le}){const[p,T]=t.useState([]),[j,L]=t.useState([]),[I,ne]=t.useState(1),[ie,f]=t.useState(1),[n,oe]=t.useState(1),c=10,[d,A]=t.useState(""),[ce,de]=t.useState([]),[m,P]=t.useState(!1),[i,b]=t.useState(""),[B,H]=t.useState([]),[$,R]=t.useState([]),[x,O]=t.useState(""),[h,k]=t.useState(""),[me,xe]=t.useState(""),[he,ue]=t.useState(""),[ge,pe]=t.useState([]),v=async()=>{try{const s=await _.get(`/api/admin/rooms-status?page=${I}&per_page=${c}`);T(s.data.data),f(s.data.meta.total_pages)}catch(s){console.error("Failed to fetch rooms:",s)}},u=async()=>{try{const s=await _.get("/admin/faculty-logs",{params:{page:n,search:d,faculty_id:x,room_id:h,log_date:i}});L(s.data.logs.data||[]),f(s.data.logs.last_page||1),s.data.facultyOptions&&H(s.data.facultyOptions),s.data.roomOptions&&R(s.data.roomOptions)}catch(s){console.error("Failed to fetch logs:",s)}};return t.useEffect(()=>{v(),u();const s=setInterval(()=>{v(),u()},5e3);return()=>clearInterval(s)},[n,d,x,h,i]),e.jsxs(Z,{children:[e.jsx(z,{children:e.jsx("title",{children:"Dashboard"})}),e.jsx(K,{}),e.jsxs(q,{children:[e.jsx("header",{className:"sticky top-0 z-20 bg-white border-b px-6 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{}),e.jsx(J,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(U,{children:e.jsx(V,{children:e.jsx(W,{children:e.jsx(X,{href:"/admin/monitoring","aria-current":"page",className:"font-semibold text-foreground",children:"Monitoring"})})})}),e.jsx("div",{className:"flex-1"}),e.jsx(Q,{})]})}),e.jsx("main",{className:"w-full px-6 py-4",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Room Monitoring"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 mb-8",children:[p.length===0&&e.jsx("p",{className:"col-span-full text-center text-gray-500",children:"No rooms found."}),p.map(s=>e.jsxs(w,{className:`rounded-2xl transition-all duration-200 ease-in-out shadow-md
                                                hover:scale-[1.02] hover:shadow-lg
                                                ${s.is_active?"bg-[#59AC77]  border border-green-700 text-white":"bg-[#59AC77]  border border-gray-300 text-gray-900"}`,children:[e.jsxs(S,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(C,{className:`text-lg md:text-xl font-semibold ${s.is_active?"text-white":"text-gray-900"}`,children:s.name}),e.jsx(Y,{className:`px-3 py-1 text-xs font-medium rounded-full ${s.is_active?"bg-white text-green-700":"bg-gray-500 text-white"}`,children:s.is_active?"Active":"Inactive"})]}),e.jsx(F,{children:e.jsxs("div",{className:"flex items-center space-x-4",children:[s.is_active&&s.last_scanned_user?.photo?e.jsx("img",{src:s.last_scanned_user.photo,alt:s.last_scanned_user.name,className:"w-28 h-28 rounded-full object-cover border-4 border-green-500 shadow-md"}):e.jsx("div",{className:"w-28 h-28 rounded-full bg-gray-200 flex items-center justify-center text-gray-500 text-sm border-4 border-gray-300 shadow-md",children:"No Photo"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`font-medium ${s.is_active?"text-white":"text-gray-900"}`,children:s.is_active&&s.last_scanned_user?s.last_scanned_user.name:"No Faculty"}),e.jsx("span",{className:`text-xs ${s.is_active?"text-green-100":"text-gray-600"}`,children:s.is_active&&s.last_scanned_at?new Date(s.last_scanned_at).toLocaleString("en-PH",{timeZone:"Asia/Manila",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"Not yet scanned"})]})]})})]},s.id))]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between w-full mb-4",children:[e.jsxs(g,{className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>P(!m),children:[e.jsx(re,{className:"w-4 h-4"}),m?"Hide Filters":"Show Filters"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{type:"text",placeholder:"Search by faculty or room...",value:d,onChange:s=>A(s.target.value),className:"w-64"}),e.jsx(g,{onClick:u,className:"bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",children:"Search"})]})]}),m&&e.jsxs("div",{className:"flex flex-wrap gap-5 items-end",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1",children:"Faculty"}),e.jsxs("select",{value:x,onChange:s=>O(s.target.value),className:"h-9 w-44 px-2 py-1 text-sm border rounded-md focus:ring-2 focus:ring-[hsl(142,34%,51%)] focus:outline-none",children:[e.jsx("option",{value:"",children:"All"}),B.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1",children:"Room"}),e.jsxs("select",{value:h,onChange:s=>k(s.target.value),className:"h-9 w-44 px-2 py-1 text-sm border rounded-md focus:ring-2 focus:ring-[hsl(142,34%,51%)] focus:outline-none",children:[e.jsx("option",{value:"",children:"All"}),$.map(s=>e.jsx("option",{value:s.id,children:s.room_number},s.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1",children:"Login Date"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{type:"date",value:i,onChange:s=>b(s.target.value),className:"h-9 w-44 text-sm border rounded-md focus:ring-2 focus:ring-[hsl(142,34%,51%)] focus:outline-none"}),i&&e.jsx(g,{variant:"outline",size:"sm",onClick:()=>b(""),className:"text-xs border-gray-300",children:"Clear"})]})]})]}),e.jsxs(w,{className:"shadow-md rounded-2xl",children:[e.jsx(S,{children:e.jsx(C,{children:"Faculty Logs History"})}),e.jsx(F,{children:e.jsxs(ee,{children:[e.jsx(se,{children:"A list of recent faculty room logs."}),e.jsx(te,{children:e.jsxs(o,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] hover:bg-[hsl(142,34%,80%)] h-10",children:[e.jsx(l,{children:"#"}),e.jsx(l,{children:"Faculty"}),e.jsx(l,{children:"LogIn Date"}),e.jsx(l,{children:"Logout Date"}),e.jsx(l,{children:"Room"})]})}),e.jsxs(ae,{children:[j.length===0&&e.jsx(o,{children:e.jsx(r,{colSpan:5,className:"text-center text-gray-500",children:"No logs found."})}),j.map((s,N)=>s.room_statuses&&s.room_statuses.length>0?s.room_statuses.slice().sort((a,y)=>new Date(y.created_at)-new Date(a.created_at)).map((a,y)=>{const E=a.created_at?new Date(a.created_at.replace(" ","T")).toLocaleString("en-PH",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"â€”",M=a.logged_out_at&&a.logged_out_at!==null?new Date(a.logged_out_at.replace(" ","T")).toLocaleString("en-PH",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"";return e.jsxs(o,{children:[e.jsx(r,{children:N+1+(n-1)*c}),e.jsx(r,{children:s.name}),e.jsx(r,{children:E}),e.jsx(r,{children:M}),e.jsx(r,{children:a.room?.room_number??"N/A"})]},`${s.id}-${a.id}`)}):e.jsxs(o,{children:[e.jsx(r,{children:N+1+(n-1)*c}),e.jsx(r,{children:s.name}),e.jsx(r,{colSpan:3,className:"text-center text-gray-400",children:"No log recorded"})]},`no-log-${s.id}`))]})]})})]})]})]})})]})]})}export{Ge as default};
