import{r as p,u as de,j as e,a as k,R as me}from"./app-BWzSyj8G.js";import{B as x}from"./button-BMMGJcVK.js";import{A as he}from"./app-sidebar-Pvi0A4aB.js";import{S as xe,a as pe,b as ue,c as ge}from"./avatar-D0UgHsed.js";import je from"./EditUnitModal-D2vX4Zll.js";import{S as be}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{I as fe}from"./input-BOJzvFDE.js";import{N as we}from"./Notification-CbEgfi9A.js";import{T as Ne,a as ve,b as T,c as P,d as Se,e as R}from"./table-CuXqrOcK.js";import{Q as ye}from"./index-CES4yGlE.js";import{B as Ce,a as Re,b as _e,c as H,d as Ue}from"./breadcrumb-CfP1dl-R.js";import{P as Ae,a as ke,b as Pe}from"./popover-BORAwkil.js";import{S as u,a as g,b as j,c as b,d as o}from"./select-DAzU4XUB.js";import{S as $e,J as Ve,R as Fe,F as Ie}from"./server.browser-ibaM3ykw.js";import{C as q}from"./checkbox-DXmk5mt4.js";import{P as Me}from"./printer-DUOEFiXD.js";import{E as W}from"./eye-DUcJTfNy.js";import{P as J}from"./pen-CSRoIZCK.js";import{l as $,E as ze}from"./menu-B59NYP7t.js";import{F as Be}from"./funnel-DF70WvOK.js";import{X as K}from"./index-DV28-wub.js";import"./index-BHHCfyIS.js";import"./utils-CBfrqCZ4.js";import"./dropdown-menu-DnPAQenw.js";import"./index-DpGC6EjD.js";import"./index-x_FqmcxY.js";import"./index-DFvSU_4p.js";import"./createLucideIcon-ClkFdy-L.js";import"./chevron-right-Dt1MMcdk.js";import"./house-CBSwyZnV.js";import"./user-DEkospy3.js";import"./log-out-BwtSkDy2.js";import"./keyboard-DGYbo-GV.js";import"./boxes-BtzFUvpX.js";import"./users-Du3Mpixh.js";import"./chevron-down-C6VsgL1i.js";import"./index-DM3EvTKL.js";import"./index-XYa-6WXG.js";import"./dialog-Df1KCIyQ.js";import"./label-DX6SyDOD.js";import"./bell-BRGA4tDE.js";import"./index-BbdBlTIj.js";import"./portal-_v0uKiwz.js";import"./with-selector-vlgvxXaL.js";function Ee({filters:r={},filterOptions:m,onApplyFilters:_,onReset:w}){const[d,n]=p.useState(""),[h,f]=p.useState("");p.useEffect(()=>{const c=["unit_code","room_id","processor","ram","storage","gpu","motherboard","condition"].find(S=>!!r[S]);c?(n(c),f(String(r[c]))):(n(""),f(""))},[r]);const U=[{value:"unit_code",label:"Unit Code"},{value:"room_id",label:"Room"},{value:"processor",label:"Processor"},{value:"ram",label:"RAM"},{value:"storage",label:"Storage"},{value:"gpu",label:"GPU"},{value:"motherboard",label:"Motherboard"},{value:"condition",label:"Condition"}];function i(l){const c=l==="all"?"":l;f(c);const S={...r};d&&(S[d]=c),_(S)}const V=!!r.unit_code||!!r.room_id||!!r.processor||!!r.ram||!!r.storage||!!r.gpu||!!r.motherboard||!!r.condition;return e.jsxs(Ae,{children:[e.jsx(ke,{asChild:!0,children:e.jsxs(x,{className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",children:[e.jsx(Be,{className:"h-4 w-4"}),"Filter",V&&e.jsx(K,{className:"h-4 w-4 ml-1 cursor-pointer",onClick:l=>{l.stopPropagation(),n(""),f(""),w()}})]})}),e.jsxs(Pe,{className:"w-[calc(100vw-2rem)] sm:w-[380px] p-4",children:[e.jsx("h4",{className:"font-medium mb-3 text-lg",children:"Filter Options"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs(u,{value:d,onValueChange:l=>{n(l),f("")},children:[e.jsx(g,{className:"w-full",children:e.jsx(j,{placeholder:"Select Field"})}),e.jsx(b,{children:U.map(l=>e.jsx(o,{value:l.value,children:l.label},l.value))})]}),d==="unit_code"&&e.jsxs(u,{value:h||"all",onValueChange:i,children:[e.jsx(g,{className:"w-full",children:e.jsx(j,{placeholder:"Select Unit Code"})}),e.jsxs(b,{children:[e.jsx(o,{value:"all",children:"All"}),m.unit_codes.map(l=>e.jsx(o,{value:l,children:l},l))]})]}),d==="room_id"&&e.jsxs(u,{value:h||"all",onValueChange:i,children:[e.jsx(g,{className:"w-full",children:e.jsx(j,{placeholder:"Select Room"})}),e.jsxs(b,{children:[e.jsx(o,{value:"all",children:"All"}),Object.entries(m.rooms).map(([l,c])=>e.jsxs(o,{value:l,children:["Room ",c]},l))]})]}),d==="processor"&&e.jsxs(u,{value:h||"all",onValueChange:i,children:[e.jsx(g,{className:"w-full",children:e.jsx(j,{placeholder:"Select Processor"})}),e.jsxs(b,{children:[e.jsx(o,{value:"all",children:"All"}),m.processors.map(l=>e.jsx(o,{value:l,children:l},l))]})]}),d==="ram"&&e.jsxs(u,{value:h||"all",onValueChange:i,children:[e.jsx(g,{className:"w-full",children:e.jsx(j,{placeholder:"Select RAM"})}),e.jsxs(b,{children:[e.jsx(o,{value:"all",children:"All"}),m.rams.map(l=>e.jsx(o,{value:l,children:l},l))]})]}),d==="storage"&&e.jsxs(u,{value:h||"all",onValueChange:i,children:[e.jsx(g,{className:"w-full",children:e.jsx(j,{placeholder:"Select Storage"})}),e.jsxs(b,{children:[e.jsx(o,{value:"all",children:"All"}),m.storages.map(l=>e.jsx(o,{value:l,children:l},l))]})]}),d==="gpu"&&e.jsxs(u,{value:h||"all",onValueChange:i,children:[e.jsx(g,{className:"w-full",children:e.jsx(j,{placeholder:"Select GPU"})}),e.jsxs(b,{children:[e.jsx(o,{value:"all",children:"All"}),m.gpus.map(l=>e.jsx(o,{value:l,children:l},l))]})]}),d==="motherboard"&&e.jsxs(u,{value:h||"all",onValueChange:i,children:[e.jsx(g,{className:"w-full",children:e.jsx(j,{placeholder:"Select Motherboard"})}),e.jsxs(b,{children:[e.jsx(o,{value:"all",children:"All"}),m.motherboards.map(l=>e.jsx(o,{value:l,children:l},l))]})]}),d==="condition"&&e.jsxs(u,{value:h||"all",onValueChange:i,children:[e.jsx(g,{className:"w-full",children:e.jsx(j,{placeholder:"Select Condition"})}),e.jsxs(b,{children:[e.jsx(o,{value:"all",children:"All"}),m.conditions.map(l=>e.jsx(o,{value:l,children:l},l))]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(x,{size:"sm",variant:"outline",onClick:()=>{n(""),f(""),w()},children:[e.jsx(K,{className:"mr-1 h-4 w-4"})," Reset"]})})]})]})]})}function Fs({units:r,rooms:m,filters:_={}}){const[w,d]=p.useState(_.search||""),[n,h]=p.useState(1),[f,U]=p.useState(null),i=10,[V,l]=p.useState(!1),[c,S]=p.useState(null),[I,F]=p.useState([]),[M,L]=p.useState(!1),X=s=>{S(s),F([]),L(!1)},Z=()=>{if(M)F([]);else if(c){const s=r.filter(t=>t.room_id===c).map(t=>t.id);F(s)}L(!M)},Y=s=>{F(t=>t.includes(s)?t.filter(a=>a!==s):[...t,s])},ee=async()=>{if(I.length===0){alert("Select at least one unit.");return}const s=r.filter(a=>I.includes(a.id)),t=new Ve;for(const a of s){const y=`${window.location.origin}/view/${a.unit_path}`,B=Fe.renderToString(e.jsx(ye,{value:y,size:256})),E=new Blob([B],{type:"image/svg+xml"}),G=URL.createObjectURL(E),C=new Image;await new Promise(ie=>{C.onload=()=>{const N=document.createElement("canvas");N.width=C.width+40,N.height=C.height+40+50;const v=N.getContext("2d");v.fillStyle="#fff",v.fillRect(0,0,N.width,N.height),v.drawImage(C,20,20),v.fillStyle="#000",v.font="bold 18px Arial",v.textAlign="center",v.fillText(`Room ${a.room?.room_number} - ${a.unit_code}`,N.width/2,C.height+20+30),N.toBlob(ce=>{t.file(`${a.unit_code}.png`,ce),ie()},"image/png")},C.src=G}),URL.revokeObjectURL(G)}t.generateAsync({type:"blob"}).then(a=>{Ie.saveAs(a,"Unit_QR_Codes.zip")})},{delete:Te}=de(),se=()=>{be.fire({icon:"success",title:"Updated!",text:"The system unit has been updated successfully."})},te=p.useMemo(()=>{const s=t=>[...new Set(t.filter(a=>a!==null&&a!==""))].sort();return{rooms:Object.fromEntries(m.map(t=>[String(t.id),t.room_number])),unit_codes:s(r.map(t=>t.unit_code)),processors:s(r.map(t=>t.processor)),rams:s(r.map(t=>t.ram)),storages:s(r.map(t=>t.storage)),gpus:s(r.map(t=>t.gpu)),motherboards:s(r.map(t=>t.motherboard)),conditions:s(r.map(t=>t.condition))}},[r,m]);function D(s){const t=Object.fromEntries(Object.entries({...s,search:w||void 0}).filter(([,a])=>a!==""&&a!==void 0));k.get(route("system-units.index"),t,{preserveState:!0,replace:!0})}function le(){d(""),k.get(route("system-units.index"),{},{preserveState:!0,replace:!0})}function ae(s){s.key==="Enter"&&D(_)}const A=p.useMemo(()=>{if(!w)return r;const s=w.toLowerCase();return r.filter(t=>{const a=t.unit_code?.toLowerCase()||"",y=t.room?.room_number?.toLowerCase()||"";return a.includes(s)||y.includes(s)})},[r,w]),z=Math.ceil(A.length/i)||1,O=[...A].sort((s,t)=>{const a=parseInt(s.room?.room_number||0),y=parseInt(t.room?.room_number||0);if(a!==y)return a-y;const B=s.unit_code?.toString().toLowerCase()||"",E=t.unit_code?.toString().toLowerCase()||"";return B.localeCompare(E)}).slice((n-1)*i,n*i),re={Working:"bg-green-200 text-green-800","Not Working":"bg-red-200 text-red-800","Intermittent Issue":"bg-yellow-200 text-yellow-800","Needs Cleaning":"bg-blue-200 text-blue-800","For Replacement":"bg-orange-200 text-orange-800","For Disposal":"bg-gray-200 text-gray-800",Condemned:"bg-black text-white","Needs Repair":"bg-red-200 text-red-800","No Signal":"bg-red-200 text-red-800","Needs Configuration":"bg-blue-200 text-blue-800","Under Maintenance":"bg-blue-200 text-blue-900","To Be Diagnosed":"bg-blue-100 text-blue-800"},Q=s=>{const t=s||"Unknown",a=re[t]||"bg-slate-400 text-white";return{label:t,color:a}},oe=p.useRef(null),ne=()=>{if(!r||r.length===0){alert("No data available to print.");return}const s=window.open("","","width=900,height=700"),t=r.map(a=>`
        <tr>
            <td>${a.id}</td>
            <td>${a.unit_code}</td>
            <td>${a.room?.room_number??"N/A"}</td>
            <td>${a.serial_number}</td>
            <td>${a.processor}</td>
            <td>${a.ram}</td>
            <td>${a.storage}</td>
            <td>${a.gpu??"N/A"}</td>
            <td>${a.motherboard}</td>
            <td>${a.condition}</td>
            <td>${a.condition_details??"N/A"}</td>
          <td>${a.mr_to?.name??"N/A"}</td>
        </tr>
    `).join("");s.document.write(`
        <html>
            <head>
                <title>Complete System Units Report</title>
                <style>
                    body {
                        font-family: Arial, sans-serif;
                        padding: 20px;
                    }
                    h2 {
                        text-align: center;
                        margin-bottom: 20px;
                        color: #2e7d32;
                    }
                    p {
                        text-align: right;
                        font-size: 12px;
                        color: #666;
                    }
                    table {
                        width: 100%;
                        border-collapse: collapse;
                        margin-top: 10px;
                    }
                    th, td {
                        border: 1px solid #ccc;
                        padding: 8px;
                        text-align: left;
                        font-size: 13px;
                    }
                    th {
                        background-color: #2e7d32;
                        color: white;
                    }
                    tr:nth-child(even) {
                        background-color: #f9f9f9;
                    }
                    @media print {
                        body { -webkit-print-color-adjust: exact; }
                    }
                </style>
            </head>
            <body>
                <h2>Complete System Units Report</h2>
                <p>Generated on: ${new Date().toLocaleString()}</p>
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Unit Code</th>
                            <th>Room</th>
                            <th>Serial Number</th>
                            <th>Processor</th>
                            <th>RAM</th>
                            <th>Storage</th>
                            <th>GPU</th>
                            <th>Motherboard</th>
                            <th>Condition</th>
                            <th>Condition Details</th>
                            <th>Material Responsible</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${t}
                    </tbody>
                </table>
            </body>
        </html>
    `),s.document.close(),s.print()};return e.jsxs(xe,{children:[e.jsx(he,{}),e.jsxs(pe,{children:[e.jsx("header",{className:"sticky top-0 z-20 bg-white border-b px-6 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{}),e.jsx(ge,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(Ce,{children:e.jsx(Re,{children:e.jsxs(_e,{children:[e.jsx(H,{href:"#","aria-current":"page",children:"Assets"}),e.jsx(Ue,{}),e.jsx(H,{href:"/admin/system-units","aria-current":"page",className:"font-semibold text-foreground",children:"System Unit Lists"})]})})}),e.jsx("div",{className:"flex-1"}),e.jsx(we,{})]})}),e.jsxs("main",{className:"w-full px-6 py-4",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"System Units"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2 items-center flex-1",children:[e.jsx(fe,{placeholder:"Search Unit Code or Room",value:w,onChange:s=>{const t=s.target.value;d(t),h(1)},onKeyDown:ae,className:"flex-1 min-w-0 sm:max-w-xs w-full border-[hsl(142,34%,51%)]"}),e.jsx(Ee,{filters:_,filterOptions:te,onApplyFilters:D,onReset:le}),e.jsxs(x,{className:"flex items-center gap-2 bg-[hsl(183,40%,45%)] text-white border-none hover:bg-[hsl(183,40%,38%)]",onClick:ne,children:[e.jsx(Me,{className:"h-4 w-4"}),"Print"]}),e.jsx(x,{className:"bg-[hsl(142,34%,51%)] text-white hover:bg-[hsl(142,34%,45%)]",onClick:()=>l(!0),children:"Download QR Codes"})]}),e.jsx(x,{className:"bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>k.visit(route("admin.system-units.create")),children:"Add New Unit"})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg shadow-lg",children:e.jsxs(Ne,{ref:oe,className:"w-full bg-white table-fixed",children:[e.jsx(ve,{children:e.jsxs(T,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] hover:bg-[hsl(142,34%,80%)] h-10",children:[e.jsx(P,{className:"px-5 py-1 text-center",children:"#"}),e.jsx(P,{className:"px-5 py-1 text-center",children:"PC Code"}),e.jsx(P,{className:"px-5 py-1 text-center",children:"Room"}),e.jsx(P,{className:"px-5 py-1 text-center",children:"Condition"}),e.jsx(P,{className:"px-5 py-1 text-center",children:"Action"})]})}),e.jsx(Se,{children:O.length>0?O.map((s,t)=>e.jsxs(T,{className:"hover:shadow-sm text-center",children:[e.jsx(R,{className:"px-5 py-2 font-medium align-middle",children:(n-1)*i+t+1}),e.jsx(R,{className:"px-5 py-2 align-middle",children:s.unit_code}),e.jsxs(R,{className:"px-5 py-2 align-middle",children:["ROOM"," ",s.room?.room_number||"N/A"]}),e.jsx(R,{className:"px-5 py-2 align-middle",children:s.condition?e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Q(s.condition).color}`,children:Q(s.condition).label}):"N/A"}),e.jsxs(R,{className:"px-5 py-2 align-middle",children:[e.jsxs("div",{className:"hidden sm:flex justify-center items-center gap-2",children:[e.jsxs(x,{size:"sm",className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>k.visit(`/system-units/view/${s.unit_path}`),children:[e.jsx(W,{className:"h-4 w-4"})," ","View"]}),e.jsxs(x,{size:"sm",className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>{U(s),setShowModal(!0)},children:[e.jsx(J,{className:"h-4 w-4"})," ","Edit"]})]}),e.jsx("div",{className:"sm:hidden flex justify-center",children:e.jsxs($,{as:"div",className:"relative inline-block text-left",children:[e.jsx($.Button,{className:"p-2 rounded bg-[hsl(142,34%,51%)] text-white",children:e.jsx(ze,{className:"h-5 w-5"})}),e.jsx($.Items,{className:"absolute right-0 mt-2 w-28 origin-top-right bg-white border border-gray-200 divide-y divide-gray-100 rounded-md shadow-lg focus:outline-none z-50",children:e.jsxs("div",{className:"px-1 py-1",children:[e.jsx($.Item,{children:({active:a})=>e.jsxs("button",{className:`${a?"bg-[hsl(142,34%,90%)]":""} group flex w-full items-center rounded-md px-2 py-2 text-sm text-gray-700`,onClick:()=>k.visit(`/system-units/view/${s.unit_path}`),children:[e.jsx(W,{className:"h-4 w-4 mr-2"})," ","View"]})}),e.jsx($.Item,{children:({active:a})=>e.jsxs("button",{className:`${a?"bg-[hsl(142,34%,90%)]":""} group flex w-full items-center rounded-md px-2 py-2 text-sm text-gray-700`,onClick:()=>{U(s),setShowModal(!0)},children:[e.jsx(J,{className:"h-4 w-4 mr-2"})," ","Edit"]})})]})})]})})]})]},s.id)):e.jsx(T,{children:e.jsx(R,{colSpan:5,className:"text-center py-4",children:"No matching units found."})})})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Showing"," ",A.length===0?0:(n-1)*i+1," ","–",Math.min(n*i,A.length)," ","of ",A.length," System Units"]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(x,{size:"sm",variant:"outline",disabled:n===1,onClick:()=>h(s=>s-1),children:"Previous"}),Array.from({length:z},(s,t)=>t+1).filter(s=>s===1||s===z?!0:s>=n-2&&s<=n+2).map((s,t,a)=>e.jsxs(me.Fragment,{children:[t>0&&a[t]-a[t-1]>1&&e.jsx("span",{className:"px-1",children:"..."}),e.jsx(x,{size:"sm",variant:n===s?"default":"outline",onClick:()=>h(s),children:s})]},s)),e.jsx(x,{size:"sm",variant:"outline",disabled:n===z,onClick:()=>h(s=>s+1),children:"Next"})]})]}),e.jsxs("div",{className:`fixed top-0 right-0 h-full w-96 bg-white shadow-xl transform transition-transform duration-300 z-50 flex flex-col
    ${V?"translate-x-0":"translate-x-full"}`,children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Download Unit QR Codes by Room"}),e.jsx(x,{variant:"ghost",onClick:()=>l(!1),children:"✕"})]}),e.jsxs("div",{className:"p-4 border-b",children:[e.jsx("label",{className:"block mb-2 font-medium text-sm text-gray-700",children:"Select Room"}),e.jsxs(u,{value:c||"",onValueChange:s=>X(Number(s)),children:[e.jsx(g,{className:"w-full",children:e.jsx(j,{placeholder:"-- Select Room --"})}),e.jsx(b,{children:m.map(s=>e.jsx(o,{value:s.id.toString(),children:s.room_number},s.id))})]})]}),c&&e.jsxs("div",{className:"flex items-center gap-2 p-4 border-b",children:[e.jsx(q,{checked:M,onCheckedChange:Z}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Select All Units in Room"})]}),c&&e.jsx($e,{className:"flex-1 overflow-y-auto p-4 space-y-2",children:r.filter(s=>s.room_id===c).map(s=>e.jsxs("div",{className:"flex items-center gap-2 p-2 border rounded-md hover:bg-gray-50 transition",children:[e.jsx(q,{checked:I.includes(s.id),onCheckedChange:()=>Y(s.id)}),e.jsx("span",{className:"text-sm text-gray-800",children:s.unit_code})]},s.id))}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2",children:[e.jsx(x,{variant:"secondary",onClick:()=>l(!1),children:"Close"}),e.jsx(x,{className:"bg-[hsl(142,34%,51%)] text-white hover:bg-[hsl(142,34%,45%)]",onClick:ee,children:"Download Selected"})]})]}),V&&e.jsx("div",{className:"fixed inset-0 bg-black/40 z-40",onClick:()=>l(!1)}),f&&e.jsx(je,{unit:f,rooms:m,onClose:()=>U(null),onSuccess:se})]})]})]})}export{Fs as default};
