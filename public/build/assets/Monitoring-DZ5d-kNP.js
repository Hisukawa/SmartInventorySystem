import{r as s,j as e,H as X,R as Y,c as C}from"./app-R10woM70.js";import{S as ee,a as te,b as se,c as ae}from"./avatar-BymqzAS-.js";import{A as re}from"./app-sidebar-CW1xXjS8.js";import{N as ne}from"./Notification-BjA0sAOM.js";import{C as L,b as T,c as P,a as D}from"./card-piz6Go2P.js";import{B as le,a as ie,b as oe,c as ce}from"./breadcrumb-BMZb9MIc.js";import{B as de}from"./badge-CIhNW-_X.js";import{T as me,f as xe,a as ue,b as j,c as l,d as he,e as n}from"./table-BaxaASRf.js";import{I as F}from"./input-BaFYG-Z9.js";import{B as i}from"./button-Cf_-5Qlp.js";import{F as ge}from"./funnel-04O0R6U5.js";import"./index-c4gAkwMv.js";import"./utils-CBfrqCZ4.js";import"./index-2cXhI42s.js";import"./index-vlMlJqEu.js";import"./createLucideIcon-DIKFRV_s.js";import"./index-BJUO8xHK.js";import"./dropdown-menu-D_vcpkDU.js";import"./index-BIrXRhj3.js";import"./chevron-right-DGgvvKJ_.js";import"./index-DNm2Kv2Q.js";import"./index-RCUCD7fw.js";import"./house-D6z2FWmn.js";import"./user-BmwlwuQK.js";import"./log-out-7G2NgEM-.js";import"./keyboard-Y-iDu31J.js";import"./boxes-BBpHa4_B.js";import"./users-B1PQVU9x.js";import"./chevron-down-CIG8vxEZ.js";import"./bell-CvyQg1tc.js";function rt({children:pe}){const[b,A]=s.useState([]),[x,R]=s.useState([]),[v,fe]=s.useState(1),[y,je]=s.useState(1),[a,u]=s.useState(1),c=10,[h,H]=s.useState(""),[be,ve]=s.useState([]),[g,I]=s.useState(!1),[d,N]=s.useState(""),[B,k]=s.useState([]),[$,O]=s.useState([]),[p,M]=s.useState(""),[f,z]=s.useState(""),[ye,Ne]=s.useState(""),[Se,_e]=s.useState(""),[we,Ce]=s.useState([]),[S,E]=s.useState(0),[Le,U]=s.useState(1),[Z,q]=s.useState(1),_=async()=>{try{const t=await C.get(`/api/admin/rooms-status?page=${v}&per_page=${c}`);A(t.data.data),U(t.data.meta.total_pages)}catch(t){console.error("Failed to fetch rooms:",t)}},w=async()=>{try{const t=await C.get("/admin/faculty-logs",{params:{page:a,search:h,faculty_id:p,room_id:f,log_date:d}});R(t.data.logs.data||[]),q(t.data.logs.last_page||1),E(t.data.logs.total||0),t.data.facultyOptions&&k(t.data.facultyOptions),t.data.roomOptions&&O(t.data.roomOptions)}catch(t){console.error("Failed to fetch logs:",t)}};s.useEffect(()=>{_();const t=setInterval(_,5e3);return()=>clearInterval(t)},[v]),s.useEffect(()=>{w()},[a,h,p,f,d]);const[o,G]=s.useState(new Date);s.useEffect(()=>{const t=setInterval(()=>{G(new Date)},1e3);return()=>clearInterval(t)},[]);const J=o.getHours()%12||12,K=String(o.getMinutes()).padStart(2,"0"),Q=String(o.getSeconds()).padStart(2,"0"),V=o.getHours()>=12?"PM":"AM";return e.jsxs(ee,{children:[e.jsx(X,{children:e.jsx("title",{children:"Dashboard"})}),e.jsx(re,{}),e.jsxs(te,{children:[e.jsx("header",{className:"sticky top-0 z-20 bg-white border-b px-6 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{}),e.jsx(ae,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(le,{children:e.jsx(ie,{children:e.jsx(oe,{children:e.jsx(ce,{href:"/admin/monitoring","aria-current":"page",className:"font-semibold text-foreground",children:"Monitoring"})})})}),e.jsx("div",{className:"flex-1"}),e.jsx(ne,{})]})}),e.jsx("main",{className:"w-full px-6 py-4",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Room Monitoring"}),e.jsx("div",{className:"mb-6",children:e.jsxs("span",{className:"text-gray-800 text-3xl md:text-4xl font-bold",children:[o.toLocaleDateString("en-PH",{weekday:"long",year:"numeric",month:"long",day:"numeric"})," ","at ",J,":",K,":",Q," ",V]})}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 mb-8",children:[b.length===0&&e.jsx("p",{className:"col-span-full text-center text-gray-500",children:"No rooms found."}),b.map(t=>e.jsxs(L,{className:`rounded-2xl transition-all duration-200 ease-in-out shadow-md
                                                hover:scale-[1.02] hover:shadow-lg
                                                ${t.is_active?"bg-[#59AC77]  border border-green-700 text-white":"bg-[#59AC77]  border border-gray-300 text-gray-900"}`,children:[e.jsxs(T,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(P,{className:`text-lg md:text-xl font-semibold ${t.is_active?"text-white":"text-gray-900"}`,children:t.name}),e.jsx(de,{className:`px-3 py-1 text-xs font-medium rounded-full ${t.is_active?"bg-white text-green-700":"bg-gray-500 text-white"}`,children:t.is_active?"Active":"Inactive"})]}),e.jsx(D,{children:e.jsxs("div",{className:"flex items-center space-x-4",children:[t.is_active&&t.last_scanned_user?.photo?e.jsx("img",{src:t.last_scanned_user.photo,alt:t.last_scanned_user.name,className:"w-28 h-28 rounded-full object-cover border-4 border-green-500 shadow-md"}):e.jsx("div",{className:"w-28 h-28 rounded-full bg-gray-200 flex items-center justify-center text-gray-500 text-sm border-4 border-gray-300 shadow-md",children:"No Photo"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`font-medium ${t.is_active?"text-white":"text-gray-900"}`,children:t.is_active&&t.last_scanned_user?`${t.last_scanned_user.name} (${t.last_scanned_user.role})`:"No Faculty"}),e.jsx("span",{className:`text-xs ${t.is_active?"text-green-100":"text-gray-600"}`,children:t.is_active&&t.last_scanned_at?new Date(t.last_scanned_at).toLocaleString("en-PH",{timeZone:"Asia/Manila",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"Not yet scanned"})]})]})})]},t.id))]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between w-full mb-4",children:[e.jsxs(i,{className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>I(!g),children:[e.jsx(ge,{className:"w-4 h-4"}),g?"Hide Filters":"Show Filters"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{type:"text",placeholder:"Search by faculty or room...",value:h,onChange:t=>H(t.target.value),className:"w-64"}),e.jsx(i,{onClick:w,className:"bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",children:"Search"})]})]}),g&&e.jsxs("div",{className:"flex flex-wrap gap-5 items-end",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1",children:"Users"}),e.jsxs("select",{value:p,onChange:t=>M(t.target.value),className:"h-9 w-44 px-2 py-1 text-sm border rounded-md focus:ring-2 focus:ring-[hsl(142,34%,51%)] focus:outline-none",children:[e.jsx("option",{value:"",children:"All"}),B.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1",children:"Room"}),e.jsxs("select",{value:f,onChange:t=>z(t.target.value),className:"h-9 w-44 px-2 py-1 text-sm border rounded-md focus:ring-2 focus:ring-[hsl(142,34%,51%)] focus:outline-none",children:[e.jsx("option",{value:"",children:"All"}),$.map(t=>e.jsx("option",{value:t.id,children:t.room_number},t.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1",children:"Login Date"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{type:"date",value:d,onChange:t=>N(t.target.value),className:"h-9 w-44 text-sm border rounded-md focus:ring-2 focus:ring-[hsl(142,34%,51%)] focus:outline-none"}),d&&e.jsx(i,{variant:"outline",size:"sm",onClick:()=>N(""),className:"text-xs border-gray-300",children:"Clear"})]})]})]}),e.jsxs(L,{className:"shadow-md rounded-2xl",children:[e.jsx(T,{children:e.jsx(P,{children:"Users Logs History"})}),e.jsxs(D,{children:[e.jsxs(me,{children:[e.jsx(xe,{children:"A list of recent faculty room logs."}),e.jsx(ue,{children:e.jsxs(j,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] hover:bg-[hsl(142,34%,80%)] h-10",children:[e.jsx(l,{children:"#"}),e.jsx(l,{children:"User"}),e.jsx(l,{children:"Role"}),e.jsx(l,{children:"Login Date"}),e.jsx(l,{children:"Logout Date"}),e.jsx(l,{children:"Room"})]})}),e.jsxs(he,{children:[x.length===0&&e.jsx(j,{children:e.jsx(n,{colSpan:6,className:"text-center text-gray-500",children:"No logs found."})}),x.map((t,r)=>{const m=t.created_at?new Date(t.created_at.replace(" ","T")).toLocaleString("en-PH",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"—",W=t.logged_out_at?new Date(t.logged_out_at.replace(" ","T")).toLocaleString("en-PH",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"";return e.jsxs(j,{children:[e.jsx(n,{children:r+1+(a-1)*c}),e.jsx(n,{children:t.faculty?.name??"N/A"})," ",e.jsx(n,{children:t.faculty?.role??"N/A"})," ",e.jsx(n,{children:m}),e.jsx(n,{children:W}),e.jsx(n,{children:t.room?.room_number??"N/A"})]},t.id)})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Showing"," ",x.length===0?0:(a-1)*c+1," ","–"," ",Math.min(a*c,S)," ","of ",S," Logs"]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(i,{size:"sm",variant:"outline",disabled:a===1,onClick:()=>u(t=>t-1),children:"Previous"}),Array.from({length:Z},(t,r)=>r+1).filter(t=>t===1||t===y?!0:t>=a-2&&t<=a+2).map((t,r,m)=>e.jsxs(Y.Fragment,{children:[r>0&&m[r]-m[r-1]>1&&e.jsx("span",{className:"px-1",children:"..."}),e.jsx(i,{size:"sm",variant:a===t?"default":"outline",onClick:()=>u(t),children:t})]},t)),e.jsx(i,{size:"sm",variant:"outline",disabled:a===y,onClick:()=>u(t=>t+1),children:"Next"})]})]})]})]})]})]})})]})]})}export{rt as default};
