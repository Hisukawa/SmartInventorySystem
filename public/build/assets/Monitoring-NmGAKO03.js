import{r as s,j as e,H as P,c as f}from"./app-Dtv7PHYU.js";import{S as D,a as H,b as R,c as $}from"./avatar-DgZznZgF.js";import{A as M}from"./app-sidebar-CdtMnD9M.js";import{N as k}from"./Notification-CfeXjsMW.js";import{C as b,a as y,b as v,c as N}from"./card-8Z3WUODb.js";import{B as E,a as Z,b as O,c as z}from"./breadcrumb-BGuZvwf3.js";import{B as q}from"./badge-PUebYaSL.js";import{T as G,f as J,a as K,b as x,c as i,d as Q,e as r}from"./table-BL1C70ZL.js";import{I as U}from"./input-PUrpb1ZF.js";import{B as V}from"./button-EYnzdPYv.js";import{F as _}from"./funnel-C51zMSAQ.js";import"./createLucideIcon-BFt9yMw9.js";import"./index-E7vI2hMJ.js";import"./utils-CBfrqCZ4.js";import"./index-CKpovWNg.js";import"./index-De8Jmrf7.js";import"./index-Cz2FuCxj.js";import"./index-D3uwZA2a.js";import"./dropdown-menu-D75JLWYq.js";import"./index-BYfFIkTn.js";import"./chevron-right-CDIHaHJf.js";import"./index-DYfEB-Nd.js";import"./index-BjnheYEv.js";import"./sparkles-80vVGTtR.js";import"./bell-BYUKbUfy.js";import"./keyboard-DdguJBMC.js";import"./boxes-CFb5Z-mA.js";import"./users-C0hVLaNG.js";import"./chevron-down-BgV3bLts.js";function Me({children:W}){const[u,w]=s.useState([]),[c,S]=s.useState([]),[C,X]=s.useState(1),[Y,A]=s.useState(1),[l,ee]=s.useState(1),h=10,[o,F]=s.useState(""),[te,se]=s.useState([]),[ae,re]=s.useState(!1),[d,T]=s.useState(""),[m,B]=s.useState(""),[g,ne]=s.useState(""),[p,ie]=s.useState(""),[ce,le]=s.useState([]),j=async()=>{try{const t=await f.get(`/api/admin/rooms-status?page=${C}&per_page=${h}`);w(t.data.data),A(t.data.meta.total_pages)}catch(t){console.error("Failed to fetch rooms:",t)}},n=async()=>{try{const t=await f.get("/admin/faculty-logs",{params:{page:l,search:o,faculty_id:d,room_id:m,date_from:g,date_to:p}});S(t.data.data)}catch(t){console.error("Failed to fetch logs:",t)}};s.useEffect(()=>{j(),n();const t=setInterval(()=>{j(),n()},5e3);return()=>clearInterval(t)},[l,o,d,m,g,p]);const I=[...new Set(c.map(t=>t.scanned_by?.name).filter(Boolean))],L=[...new Set(c.map(t=>t.room?.room_number).filter(Boolean))];return e.jsxs(D,{children:[e.jsx(P,{children:e.jsx("title",{children:"Dashboard"})}),e.jsx(M,{}),e.jsxs(H,{children:[e.jsx("header",{className:"sticky top-0 z-20 bg-white border-b px-6 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{}),e.jsx($,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(E,{children:e.jsx(Z,{children:e.jsx(O,{children:e.jsx(z,{href:"/admin/monitoring","aria-current":"page",className:"font-semibold text-foreground",children:"Monitoring"})})})}),e.jsx("div",{className:"flex-1"}),e.jsx(k,{})]})}),e.jsx("main",{className:"w-full px-6 py-4",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Room Monitoring"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-8",children:[u.length===0&&e.jsx("p",{className:"col-span-full text-center text-gray-500",children:"No rooms found."}),u.map(t=>e.jsxs(b,{className:`rounded-2xl transition-all duration-200 ease-in-out shadow-md 
              hover:scale-[1.02] hover:shadow-lg
              ${t.is_active?"bg-[#59AC77]  border border-green-700 text-white":"bg-[#59AC77]  border border-gray-300 text-gray-900"}`,children:[e.jsxs(y,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(v,{className:`text-lg md:text-xl font-semibold ${t.is_active?"text-white":"text-gray-900"}`,children:t.name}),e.jsx(q,{className:`px-3 py-1 text-xs font-medium rounded-full ${t.is_active?"bg-white text-green-700":"bg-gray-500 text-white"}`,children:t.is_active?"Active":"Inactive"})]}),e.jsx(N,{children:e.jsxs("div",{className:"flex items-center space-x-4",children:[t.is_active&&t.last_scanned_user?.photo?e.jsx("img",{src:t.last_scanned_user.photo,alt:t.last_scanned_user.name,className:"w-20 h-20 rounded-full object-cover border-2 border-green-500"}):e.jsx("div",{className:"w-20 h-20 rounded-full bg-gray-200 flex items-center justify-center text-gray-500 text-sm border-2 border-gray-300",children:"No Photo"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`font-medium ${t.is_active?"text-white":"text-gray-900"}`,children:t.is_active&&t.last_scanned_user?t.last_scanned_user.name:"No Faculty"}),e.jsx("span",{className:`text-xs ${t.is_active?"text-green-100":"text-gray-600"}`,children:t.is_active&&t.last_scanned_at?new Date(t.last_scanned_at).toLocaleString("en-PH",{timeZone:"Asia/Manila",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"Not yet scanned"})]})]})})]},t.id))]}),e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{type:"text",placeholder:"Search by faculty or room...",value:o,onChange:t=>F(t.target.value),className:"w-64"}),e.jsx(V,{onClick:n,children:"Search"})]})}),e.jsxs(b,{className:"shadow-md rounded-2xl",children:[e.jsx(y,{children:e.jsx(v,{children:"Faculty Logs History"})}),e.jsx(N,{children:e.jsxs(G,{children:[e.jsx(J,{children:"A list of recent faculty room logs."}),e.jsx(K,{children:e.jsxs(x,{children:[e.jsx(i,{children:"#"}),e.jsx(i,{className:"relative",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Faculty"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("select",{value:d,onChange:t=>{T(t.target.value),n()},className:`
          h-8
          w-36
          px-2
          py-1
          text-sm
          text-gray-900
          bg-white
          border
          border-gray-300
          rounded-md
          focus:outline-none
          focus:ring-1
          focus:ring-blue-500
          focus:border-blue-500
        `,children:[e.jsx("option",{value:"",children:"All"}),I.map((t,a)=>e.jsx("option",{value:t,children:t},a))]}),e.jsx(_,{className:"w-4 h-4 text-gray-500"})]})]})}),e.jsx(i,{className:"relative",children:e.jsx("div",{className:"flex items-center gap-2",children:"LogIn Date"})}),e.jsx(i,{className:"relative",children:e.jsx("div",{className:"flex items-center gap-2",children:"Logout Date"})}),e.jsx(i,{className:"relative",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Room"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("select",{value:m,onChange:t=>{const a=t.target.value;B(a),n()},className:`
          h-8
          w-36
          px-2
          py-1
          text-sm
          text-gray-900
          bg-white
          border
          border-gray-300
          rounded-md
          focus:outline-none
          focus:ring-1
          focus:ring-blue-500
          focus:border-blue-500
        `,children:[e.jsx("option",{value:"",children:"All"}),L.map((t,a)=>e.jsx("option",{value:t,children:t},a))]}),e.jsx(_,{className:"w-4 h-4 text-gray-500"})]})]})})]})}),e.jsxs(Q,{children:[c.length===0&&e.jsx(x,{children:e.jsx(r,{colSpan:5,className:"text-center text-gray-500",children:"No logs found."})}),c.map((t,a)=>e.jsxs(x,{children:[e.jsx(r,{children:a+1+(l-1)*h}),e.jsx(r,{children:t.scanned_by?.name??"N/A"}),e.jsx(r,{children:t.created_at?new Date(t.created_at).toLocaleString("en-PH",{timeZone:"Asia/Manila",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"—"}),e.jsx(r,{children:t.logged_out_at?new Date(t.logged_out_at).toLocaleString("en-PH",{timeZone:"Asia/Manila",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"—"}),e.jsx(r,{children:t.room?.room_number??"N/A"})]},t.id))]})]})})]})]})})]})]})}export{Me as default};
