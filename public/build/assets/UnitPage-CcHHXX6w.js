import{r as p,u as de,j as e,a as k,R as me}from"./app-DdILD_Xr.js";import{B as x}from"./button-B0uisR27.js";import{A as he}from"./app-sidebar-DC5Aby7c.js";import{S as xe,a as pe,b as ue,c as ge}from"./avatar-Bfg13Dtv.js";import je from"./EditUnitModal-2YB2OomL.js";import{S as be}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{I as fe}from"./input-CXn4W12X.js";import{N as we}from"./Notification-DwvKy6xc.js";import{T as Ne,a as ve,b as I,c as A,d as Se,e as C}from"./table-0jYuqNjh.js";import{Q as ye}from"./index-DFNN6AUt.js";import{B as Ce,a as Re,b as Ue,c as Q,d as _e}from"./breadcrumb-C-_aZniV.js";import{P as ke,a as Ae,b as Pe}from"./popover-M8UAE5fH.js";import{S as u,a as g,b as j,c as b,d as o}from"./select-CRqvx0mn.js";import{S as $e,J as Ve,R as Fe,F as Me}from"./server.browser-jhVXNWRr.js";import{C as G}from"./checkbox-CDRSiRSy.js";import{P as ze}from"./printer-BGwNU-AH.js";import{E as H}from"./eye-DYWHq2RB.js";import{P as q}from"./pen-Bk7s55i1.js";import{l as P,E as Ee}from"./menu-BcqZTSJz.js";import{F as Ie}from"./funnel-Bf2Z_Bjg.js";import{X as W}from"./index-CGosRKdT.js";import"./index-DQ6gBxz6.js";import"./utils-CBfrqCZ4.js";import"./dropdown-menu-F0b7ObYn.js";import"./index-DBap2f8a.js";import"./index-DGMrQ7cP.js";import"./index-CMrceUIp.js";import"./createLucideIcon-CkT6gbJA.js";import"./chevron-right-BbSpC2r2.js";import"./house-JDEa_Sq2.js";import"./user-B85dqUwB.js";import"./log-out-pVFsRlAE.js";import"./keyboard-DZwEhqI6.js";import"./boxes-TAWYbDpx.js";import"./users-DFlG4yg7.js";import"./chevron-down-DatpAlHd.js";import"./index-CLmbfdwx.js";import"./index-BEKW_y2j.js";import"./dialog-ByiFIcSO.js";import"./label-BK4m0sgn.js";import"./bell-LAf6ccnB.js";import"./index-Be4A3zgA.js";import"./portal-KNX0gDdn.js";import"./open-closed-T3vGCXIP.js";import"./with-selector-BvQrvhtH.js";function Te({filters:r={},filterOptions:m,onApplyFilters:R,onReset:w}){const[d,n]=p.useState(""),[h,f]=p.useState("");p.useEffect(()=>{const c=["unit_code","room_id","processor","ram","storage","gpu","motherboard","condition"].find(S=>!!r[S]);c?(n(c),f(String(r[c]))):(n(""),f(""))},[r]);const U=[{value:"unit_code",label:"Unit Code"},{value:"room_id",label:"Room"},{value:"processor",label:"Processor"},{value:"ram",label:"RAM"},{value:"storage",label:"Storage"},{value:"gpu",label:"GPU"},{value:"motherboard",label:"Motherboard"},{value:"condition",label:"Condition"}];function i(l){const c=l==="all"?"":l;f(c);const S={...r};d&&(S[d]=c),R(S)}const $=!!r.unit_code||!!r.room_id||!!r.processor||!!r.ram||!!r.storage||!!r.gpu||!!r.motherboard||!!r.condition;return e.jsxs(ke,{children:[e.jsx(Ae,{asChild:!0,children:e.jsxs(x,{className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",children:[e.jsx(Ie,{className:"h-4 w-4"}),"Filter",$&&e.jsx(W,{className:"h-4 w-4 ml-1 cursor-pointer",onClick:l=>{l.stopPropagation(),n(""),f(""),w()}})]})}),e.jsxs(Pe,{className:"w-[calc(100vw-2rem)] sm:w-[380px] p-4",children:[e.jsx("h4",{className:"font-medium mb-3 text-lg",children:"Filter Options"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs(u,{value:d,onValueChange:l=>{n(l),f("")},children:[e.jsx(g,{className:"w-full",children:e.jsx(j,{placeholder:"Select Field"})}),e.jsx(b,{children:U.map(l=>e.jsx(o,{value:l.value,children:l.label},l.value))})]}),d==="unit_code"&&e.jsxs(u,{value:h||"all",onValueChange:i,children:[e.jsx(g,{className:"w-full",children:e.jsx(j,{placeholder:"Select Unit Code"})}),e.jsxs(b,{children:[e.jsx(o,{value:"all",children:"All"}),m.unit_codes.map(l=>e.jsx(o,{value:l,children:l},l))]})]}),d==="room_id"&&e.jsxs(u,{value:h||"all",onValueChange:i,children:[e.jsx(g,{className:"w-full",children:e.jsx(j,{placeholder:"Select Room"})}),e.jsxs(b,{children:[e.jsx(o,{value:"all",children:"All"}),Object.entries(m.rooms).map(([l,c])=>e.jsxs(o,{value:l,children:["Room ",c]},l))]})]}),d==="processor"&&e.jsxs(u,{value:h||"all",onValueChange:i,children:[e.jsx(g,{className:"w-full",children:e.jsx(j,{placeholder:"Select Processor"})}),e.jsxs(b,{children:[e.jsx(o,{value:"all",children:"All"}),m.processors.map(l=>e.jsx(o,{value:l,children:l},l))]})]}),d==="ram"&&e.jsxs(u,{value:h||"all",onValueChange:i,children:[e.jsx(g,{className:"w-full",children:e.jsx(j,{placeholder:"Select RAM"})}),e.jsxs(b,{children:[e.jsx(o,{value:"all",children:"All"}),m.rams.map(l=>e.jsx(o,{value:l,children:l},l))]})]}),d==="storage"&&e.jsxs(u,{value:h||"all",onValueChange:i,children:[e.jsx(g,{className:"w-full",children:e.jsx(j,{placeholder:"Select Storage"})}),e.jsxs(b,{children:[e.jsx(o,{value:"all",children:"All"}),m.storages.map(l=>e.jsx(o,{value:l,children:l},l))]})]}),d==="gpu"&&e.jsxs(u,{value:h||"all",onValueChange:i,children:[e.jsx(g,{className:"w-full",children:e.jsx(j,{placeholder:"Select GPU"})}),e.jsxs(b,{children:[e.jsx(o,{value:"all",children:"All"}),m.gpus.map(l=>e.jsx(o,{value:l,children:l},l))]})]}),d==="motherboard"&&e.jsxs(u,{value:h||"all",onValueChange:i,children:[e.jsx(g,{className:"w-full",children:e.jsx(j,{placeholder:"Select Motherboard"})}),e.jsxs(b,{children:[e.jsx(o,{value:"all",children:"All"}),m.motherboards.map(l=>e.jsx(o,{value:l,children:l},l))]})]}),d==="condition"&&e.jsxs(u,{value:h||"all",onValueChange:i,children:[e.jsx(g,{className:"w-full",children:e.jsx(j,{placeholder:"Select Condition"})}),e.jsxs(b,{children:[e.jsx(o,{value:"all",children:"All"}),m.conditions.map(l=>e.jsx(o,{value:l,children:l},l))]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(x,{size:"sm",variant:"outline",onClick:()=>{n(""),f(""),w()},children:[e.jsx(W,{className:"mr-1 h-4 w-4"})," Reset"]})})]})]})]})}function Fs({units:r,rooms:m,filters:R={}}){const[w,d]=p.useState(R.search||""),[n,h]=p.useState(1),[f,U]=p.useState(null),i=10,[$,l]=p.useState(!1),[c,S]=p.useState(null),[F,V]=p.useState([]),[M,T]=p.useState(!1),J=s=>{S(s),V([]),T(!1)},K=()=>{if(M)V([]);else if(c){const s=r.filter(t=>t.room_id===c).map(t=>t.id);V(s)}T(!M)},X=s=>{V(t=>t.includes(s)?t.filter(a=>a!==s):[...t,s])},Z=async()=>{if(F.length===0){alert("Select at least one unit.");return}const s=r.filter(a=>F.includes(a.id)),t=new Ve;for(const a of s){const E=`${window.location.origin}/view/${a.unit_path}`,oe=Fe.renderToString(e.jsx(ye,{value:E,size:256})),ne=new Blob([oe],{type:"image/svg+xml"}),O=URL.createObjectURL(ne),y=new Image;await new Promise(ie=>{y.onload=()=>{const N=document.createElement("canvas");N.width=y.width+40,N.height=y.height+40+50;const v=N.getContext("2d");v.fillStyle="#fff",v.fillRect(0,0,N.width,N.height),v.drawImage(y,20,20),v.fillStyle="#000",v.font="bold 18px Arial",v.textAlign="center",v.fillText(`Room ${a.room?.room_number} - ${a.unit_code}`,N.width/2,y.height+20+30),N.toBlob(ce=>{t.file(`${a.unit_code}.png`,ce),ie()},"image/png")},y.src=O}),URL.revokeObjectURL(O)}t.generateAsync({type:"blob"}).then(a=>{Me.saveAs(a,"Unit_QR_Codes.zip")})},{delete:Be}=de(),Y=()=>{be.fire({icon:"success",title:"Updated!",text:"The system unit has been updated successfully."})},ee=p.useMemo(()=>{const s=t=>[...new Set(t.filter(a=>a!==null&&a!==""))].sort();return{rooms:Object.fromEntries(m.map(t=>[String(t.id),t.room_number])),unit_codes:s(r.map(t=>t.unit_code)),processors:s(r.map(t=>t.processor)),rams:s(r.map(t=>t.ram)),storages:s(r.map(t=>t.storage)),gpus:s(r.map(t=>t.gpu)),motherboards:s(r.map(t=>t.motherboard)),conditions:s(r.map(t=>t.condition))}},[r,m]);function B(s){const t=Object.fromEntries(Object.entries({...s,search:w||void 0}).filter(([,a])=>a!==""&&a!==void 0));k.get(route("system-units.index"),t,{preserveState:!0,replace:!0})}function se(){d(""),k.get(route("system-units.index"),{},{preserveState:!0,replace:!0})}function te(s){s.key==="Enter"&&B(R)}const _=p.useMemo(()=>{if(!w)return r;const s=w.toLowerCase();return r.filter(t=>{const a=t.unit_code?.toLowerCase()||"",E=t.room?.room_number?.toLowerCase()||"";return a.includes(s)||E.includes(s)})},[r,w]),z=Math.ceil(_.length/i)||1,D=_.slice((n-1)*i,n*i),le={Working:"bg-green-200 text-green-800","Not Working":"bg-red-200 text-red-800","Intermittent Issue":"bg-yellow-200 text-yellow-800","Needs Cleaning":"bg-blue-200 text-blue-800","For Replacement":"bg-orange-200 text-orange-800","For Disposal":"bg-gray-200 text-gray-800",Condemned:"bg-black text-white","Needs Repair":"bg-red-200 text-red-800","No Signal":"bg-red-200 text-red-800","Needs Configuration":"bg-blue-200 text-blue-800","Under Maintenance":"bg-blue-200 text-blue-900","To Be Diagnosed":"bg-blue-100 text-blue-800"},L=s=>{const t=s||"Unknown",a=le[t]||"bg-slate-400 text-white";return{label:t,color:a}},ae=p.useRef(null),re=()=>{if(!r||r.length===0){alert("No data available to print.");return}const s=window.open("","","width=900,height=700"),t=r.map(a=>`
        <tr>
            <td>${a.id}</td>
            <td>${a.unit_code}</td>
            <td>${a.room?.room_number??"N/A"}</td>
            <td>${a.serial_number}</td>
            <td>${a.processor}</td>
            <td>${a.ram}</td>
            <td>${a.storage}</td>
            <td>${a.gpu??"N/A"}</td>
            <td>${a.motherboard}</td>
            <td>${a.condition}</td>
            <td>${a.condition_details??"N/A"}</td>
          <td>${a.mr_to?.name??"N/A"}</td>
        </tr>
    `).join("");s.document.write(`
        <html>
            <head>
                <title>Complete System Units Report</title>
                <style>
                    body {
                        font-family: Arial, sans-serif;
                        padding: 20px;
                    }
                    h2 {
                        text-align: center;
                        margin-bottom: 20px;
                        color: #2e7d32;
                    }
                    p {
                        text-align: right;
                        font-size: 12px;
                        color: #666;
                    }
                    table {
                        width: 100%;
                        border-collapse: collapse;
                        margin-top: 10px;
                    }
                    th, td {
                        border: 1px solid #ccc;
                        padding: 8px;
                        text-align: left;
                        font-size: 13px;
                    }
                    th {
                        background-color: #2e7d32;
                        color: white;
                    }
                    tr:nth-child(even) {
                        background-color: #f9f9f9;
                    }
                    @media print {
                        body { -webkit-print-color-adjust: exact; }
                    }
                </style>
            </head>
            <body>
                <h2>Complete System Units Report</h2>
                <p>Generated on: ${new Date().toLocaleString()}</p>
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Unit Code</th>
                            <th>Room</th>
                            <th>Serial Number</th>
                            <th>Processor</th>
                            <th>RAM</th>
                            <th>Storage</th>
                            <th>GPU</th>
                            <th>Motherboard</th>
                            <th>Condition</th>
                            <th>Condition Details</th>
                            <th>Material Responsible</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${t}
                    </tbody>
                </table>
            </body>
        </html>
    `),s.document.close(),s.print()};return e.jsxs(xe,{children:[e.jsx(he,{}),e.jsxs(pe,{children:[e.jsx("header",{className:"sticky top-0 z-20 bg-white border-b px-6 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{}),e.jsx(ge,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(Ce,{children:e.jsx(Re,{children:e.jsxs(Ue,{children:[e.jsx(Q,{href:"#","aria-current":"page",children:"Assets"}),e.jsx(_e,{}),e.jsx(Q,{href:"/admin/system-units","aria-current":"page",className:"font-semibold text-foreground",children:"System Unit Lists"})]})})}),e.jsx("div",{className:"flex-1"}),e.jsx(we,{})]})}),e.jsxs("main",{className:"w-full px-6 py-4",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"System Units"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2 items-center flex-1",children:[e.jsx(fe,{placeholder:"Search Unit Code or Room",value:w,onChange:s=>{const t=s.target.value;d(t),h(1)},onKeyDown:te,className:"flex-1 min-w-0 sm:max-w-xs w-full border-[hsl(142,34%,51%)]"}),e.jsx(Te,{filters:R,filterOptions:ee,onApplyFilters:B,onReset:se}),e.jsxs(x,{className:"flex items-center gap-2 bg-[hsl(183,40%,45%)] text-white border-none hover:bg-[hsl(183,40%,38%)]",onClick:re,children:[e.jsx(ze,{className:"h-4 w-4"}),"Print"]}),e.jsx(x,{className:"bg-[hsl(142,34%,51%)] text-white hover:bg-[hsl(142,34%,45%)]",onClick:()=>l(!0),children:"Download QR Codes"})]}),e.jsx(x,{className:"bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>k.visit(route("admin.system-units.create")),children:"Add New Unit"})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg shadow-lg",children:e.jsxs(Ne,{ref:ae,className:"w-full bg-white table-fixed",children:[e.jsx(ve,{children:e.jsxs(I,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] hover:bg-[hsl(142,34%,80%)] h-10",children:[e.jsx(A,{className:"px-5 py-1 text-center",children:"#"}),e.jsx(A,{className:"px-5 py-1 text-center",children:"PC Code"}),e.jsx(A,{className:"px-5 py-1 text-center",children:"Room"}),e.jsx(A,{className:"px-5 py-1 text-center",children:"Condition"}),e.jsx(A,{className:"px-5 py-1 text-center",children:"Action"})]})}),e.jsx(Se,{children:D.length>0?D.map((s,t)=>e.jsxs(I,{className:"hover:shadow-sm text-center",children:[e.jsx(C,{className:"px-5 py-2 font-medium align-middle",children:(n-1)*i+t+1}),e.jsx(C,{className:"px-5 py-2 align-middle",children:s.unit_code}),e.jsxs(C,{className:"px-5 py-2 align-middle",children:["ROOM"," ",s.room?.room_number||"N/A"]}),e.jsx(C,{className:"px-5 py-2 align-middle",children:s.condition?e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${L(s.condition).color}`,children:L(s.condition).label}):"N/A"}),e.jsxs(C,{className:"px-5 py-2 align-middle",children:[e.jsxs("div",{className:"hidden sm:flex justify-center items-center gap-2",children:[e.jsxs(x,{size:"sm",className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>k.visit(`/system-units/view/${s.unit_path}`),children:[e.jsx(H,{className:"h-4 w-4"})," ","View"]}),e.jsxs(x,{size:"sm",className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>{U(s),setShowModal(!0)},children:[e.jsx(q,{className:"h-4 w-4"})," ","Edit"]})]}),e.jsx("div",{className:"sm:hidden flex justify-center",children:e.jsxs(P,{as:"div",className:"relative inline-block text-left",children:[e.jsx(P.Button,{className:"p-2 rounded bg-[hsl(142,34%,51%)] text-white",children:e.jsx(Ee,{className:"h-5 w-5"})}),e.jsx(P.Items,{className:"absolute right-0 mt-2 w-28 origin-top-right bg-white border border-gray-200 divide-y divide-gray-100 rounded-md shadow-lg focus:outline-none z-50",children:e.jsxs("div",{className:"px-1 py-1",children:[e.jsx(P.Item,{children:({active:a})=>e.jsxs("button",{className:`${a?"bg-[hsl(142,34%,90%)]":""} group flex w-full items-center rounded-md px-2 py-2 text-sm text-gray-700`,onClick:()=>k.visit(`/system-units/view/${s.unit_path}`),children:[e.jsx(H,{className:"h-4 w-4 mr-2"})," ","View"]})}),e.jsx(P.Item,{children:({active:a})=>e.jsxs("button",{className:`${a?"bg-[hsl(142,34%,90%)]":""} group flex w-full items-center rounded-md px-2 py-2 text-sm text-gray-700`,onClick:()=>{U(s),setShowModal(!0)},children:[e.jsx(q,{className:"h-4 w-4 mr-2"})," ","Edit"]})})]})})]})})]})]},s.id)):e.jsx(I,{children:e.jsx(C,{colSpan:5,className:"text-center py-4",children:"No matching units found."})})})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Showing"," ",_.length===0?0:(n-1)*i+1," ","–",Math.min(n*i,_.length)," ","of ",_.length," System Units"]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(x,{size:"sm",variant:"outline",disabled:n===1,onClick:()=>h(s=>s-1),children:"Previous"}),Array.from({length:z},(s,t)=>t+1).filter(s=>s===1||s===z?!0:s>=n-2&&s<=n+2).map((s,t,a)=>e.jsxs(me.Fragment,{children:[t>0&&a[t]-a[t-1]>1&&e.jsx("span",{className:"px-1",children:"..."}),e.jsx(x,{size:"sm",variant:n===s?"default":"outline",onClick:()=>h(s),children:s})]},s)),e.jsx(x,{size:"sm",variant:"outline",disabled:n===z,onClick:()=>h(s=>s+1),children:"Next"})]})]}),e.jsxs("div",{className:`fixed top-0 right-0 h-full w-96 bg-white shadow-xl transform transition-transform duration-300 z-50 flex flex-col
    ${$?"translate-x-0":"translate-x-full"}`,children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Download Unit QR Codes by Room"}),e.jsx(x,{variant:"ghost",onClick:()=>l(!1),children:"✕"})]}),e.jsxs("div",{className:"p-4 border-b",children:[e.jsx("label",{className:"block mb-2 font-medium text-sm text-gray-700",children:"Select Room"}),e.jsxs(u,{value:c||"",onValueChange:s=>J(Number(s)),children:[e.jsx(g,{className:"w-full",children:e.jsx(j,{placeholder:"-- Select Room --"})}),e.jsx(b,{children:m.map(s=>e.jsx(o,{value:s.id.toString(),children:s.room_number},s.id))})]})]}),c&&e.jsxs("div",{className:"flex items-center gap-2 p-4 border-b",children:[e.jsx(G,{checked:M,onCheckedChange:K}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Select All Units in Room"})]}),c&&e.jsx($e,{className:"flex-1 overflow-y-auto p-4 space-y-2",children:r.filter(s=>s.room_id===c).map(s=>e.jsxs("div",{className:"flex items-center gap-2 p-2 border rounded-md hover:bg-gray-50 transition",children:[e.jsx(G,{checked:F.includes(s.id),onCheckedChange:()=>X(s.id)}),e.jsx("span",{className:"text-sm text-gray-800",children:s.unit_code})]},s.id))}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2",children:[e.jsx(x,{variant:"secondary",onClick:()=>l(!1),children:"Close"}),e.jsx(x,{className:"bg-[hsl(142,34%,51%)] text-white hover:bg-[hsl(142,34%,45%)]",onClick:Z,children:"Download Selected"})]})]}),$&&e.jsx("div",{className:"fixed inset-0 bg-black/40 z-40",onClick:()=>l(!1)}),f&&e.jsx(je,{unit:f,rooms:m,onClose:()=>U(null),onSuccess:Y})]})]})]})}export{Fs as default};
