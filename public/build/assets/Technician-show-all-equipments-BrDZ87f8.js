import{r as f,j as e,L as P,R as O,a as R,u as V}from"./app-y5BW-1yv.js";import{B as o}from"./button-DK-NKz8k.js";import{C as I,a as L}from"./card-DdKvUO3J.js";import{S as M,a as $,b as H,c as G}from"./index-SsKSEojR.js";import{S as T}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{T as K,a as U,b as q,c as p,d as X,e as x}from"./table-C_DkX_Ys.js";import{B as Y,a as J,b as Q,c as z,d as W}from"./breadcrumb-DPrCEZGT.js";import{T as Z}from"./technician-app-sidebar-yYBdJM3S.js";import{I as w}from"./input-DqNdnDmq.js";import{P as ee,a as se,b as ne,S as v,c as b,d as g,e as C,f as c}from"./select-BaT-p1bn.js";import{F as ie}from"./funnel-BMGell7c.js";import{X as te}from"./index-DkqfgmEX.js";import"./index-CuOTi53j.js";import"./index-YZEw1Iku.js";import"./createLucideIcon-CjmKo_X0.js";import"./index-DYGrkyh1.js";import"./dropdown-menu-Dr2tabDf.js";import"./index-C2swjSGG.js";import"./chevron-right-CVXBF1I-.js";import"./index-BQYS6HsA.js";import"./user-DVh4Vb0d.js";import"./send-Cai-S7Pa.js";import"./index-5CgBNfIv.js";function re({filters:r,filterOptions:u,onApplyFilters:d}){const[m,a]=f.useState(""),l=()=>{const t={type:void 0,condition:void 0,room_id:void 0};a(""),d(t)};return e.jsxs(ee,{children:[e.jsx(se,{asChild:!0,children:e.jsxs(o,{variant:"outline",size:"sm",children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"Filters"]})}),e.jsx(ne,{className:"w-72",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(v,{value:m,onValueChange:a,children:[e.jsx(b,{children:e.jsx(g,{placeholder:"Select filter field"})}),e.jsxs(C,{children:[e.jsx(c,{value:"type",children:"Type"}),e.jsx(c,{value:"condition",children:"Condition"}),e.jsx(c,{value:"room",children:"Room"})]})]}),m==="type"&&e.jsxs(v,{value:r.type||"all",onValueChange:t=>d({...r,type:t==="all"?void 0:t}),children:[e.jsx(b,{children:e.jsx(g,{placeholder:"Select Type"})}),e.jsxs(C,{children:[e.jsx(c,{value:"all",children:"All"}),u.types.map(t=>e.jsx(c,{value:t,children:t},t))]})]}),m==="condition"&&e.jsxs(v,{value:r.condition||"all",onValueChange:t=>d({...r,condition:t==="all"?void 0:t}),children:[e.jsx(b,{children:e.jsx(g,{placeholder:"Select Condition"})}),e.jsxs(C,{children:[e.jsx(c,{value:"all",children:"All"}),u.conditions.map(t=>e.jsx(c,{value:t,children:t},t))]})]}),m==="room"&&e.jsxs(v,{value:r.room_id||"all",onValueChange:t=>d({...r,room_id:t==="all"?void 0:t}),children:[e.jsx(b,{children:e.jsx(g,{placeholder:"Select Room"})}),e.jsxs(C,{children:[e.jsx(c,{value:"all",children:"All"}),Object.entries(u.rooms).map(([t,j])=>e.jsx(c,{value:t,children:j},t))]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(o,{size:"sm",variant:"outline",onClick:l,className:"flex items-center gap-1",children:[e.jsx(te,{className:"h-4 w-4"}),"Reset All"]})})]})})]})}function Be({equipments:r,search:u,existingRooms:d,conditions:m,filters:a={}}){const[l,t]=f.useState(u||""),[j,S]=f.useState(null),[i,E]=f.useState(1),y=10,A=f.useMemo(()=>{const s=n=>[...new Set(n.filter(h=>h))].sort();return{types:s(r.map(n=>n.type)),conditions:s(r.map(n=>n.condition)),rooms:Object.fromEntries(d.map(n=>[String(n.id),n.room_number]))}},[r,d]);function _(s){const n=Object.fromEntries(Object.entries({...s,search:l||void 0}).filter(([,h])=>h!==""&&h!==void 0));R.get("/technician/equipments",n,{preserveState:!0,replace:!0})}const D=s=>{s.key==="Enter"&&_(a)},B=f.useMemo(()=>{if(!l)return r;const s=l.toLowerCase();return r.filter(n=>[n.equipment_code,n.type,n.brand,n.model,n.serial_number,n.condition,n.room?.room_number].filter(Boolean).some(h=>h.toLowerCase().includes(s)))},[r,l]),N=Math.ceil(B.length/y)||1,k=B.slice((i-1)*y,i*y);function F(s){T.fire({title:"Are you sure?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(n=>{n.isConfirmed&&R.delete(`/technician/equipments/${s}`,{onSuccess:()=>{T.fire({icon:"success",title:"Deleted!",text:"Equipment deleted successfully.",timer:2e3,showConfirmButton:!1})}})})}return e.jsxs(M,{children:[e.jsx(Z,{}),e.jsxs($,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx(H,{}),e.jsx(G,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(Y,{children:e.jsx(J,{children:e.jsxs(Q,{children:[e.jsx(z,{href:"#",children:"Assets"}),e.jsx(W,{}),e.jsx(z,{href:"/technician/equipments","aria-current":"page",className:"font-semibold text-foreground",children:"Equipments"})]})})}),e.jsx("div",{className:"flex-1"})]}),e.jsx("main",{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-5",children:"Equipments"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(re,{filters:a,filterOptions:A,onApplyFilters:_}),e.jsx(w,{placeholder:"Search equipments...",value:l,onChange:s=>t(s.target.value),onKeyDown:D,className:"w-64"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(P,{href:"/technician/equipments/create",children:e.jsx(o,{children:"Add Equipment"})})})]}),e.jsx(I,{children:e.jsxs(L,{children:[e.jsxs(K,{children:[e.jsx(U,{children:e.jsxs(q,{children:[e.jsx(p,{children:"#"}),e.jsx(p,{children:"Equipment Code"}),e.jsx(p,{children:"Type"}),e.jsx(p,{children:"Brand"}),e.jsx(p,{children:"Condition"}),e.jsx(p,{children:"Room"}),e.jsx(p,{children:"Actions"})]})}),e.jsx(X,{children:k.length>0?k.map((s,n)=>e.jsxs(q,{children:[e.jsx(x,{children:(i-1)*y+n+1}),e.jsx(x,{children:s.equipment_code}),e.jsx(x,{children:s.type}),e.jsx(x,{children:s.brand}),e.jsx(x,{children:s.condition}),e.jsx(x,{children:s.room?`ROOM ${s.room.room_number}`:"N/A"}),e.jsxs(x,{className:"space-x-2",children:[e.jsx(P,{href:`/technician/equipments/${s.id}`,children:e.jsx(o,{variant:"secondary",size:"sm",children:"View"})}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>S(s),children:"Edit"}),e.jsx(o,{variant:"destructive",size:"sm",onClick:()=>F(s.id),children:"Delete"})]})]},s.id)):e.jsx(q,{children:e.jsx(x,{colSpan:"9",className:"text-center",children:"No equipments found."})})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",i," of ",N]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{size:"sm",variant:"outline",disabled:i===1,onClick:()=>E(i-1),children:"Previous"}),Array.from({length:N},(s,n)=>n+1).filter(s=>s===1||s===N||s>=i-2&&s<=i+2).map((s,n,h)=>e.jsxs(O.Fragment,{children:[n>0&&h[n]-h[n-1]>1&&e.jsx("span",{className:"px-2",children:"..."}),e.jsx(o,{size:"sm",variant:i===s?"default":"outline",onClick:()=>E(s),children:s})]},s)),e.jsx(o,{size:"sm",variant:"outline",disabled:i===N,onClick:()=>E(i+1),children:"Next"})]})]})]})})]})}),j&&e.jsx(le,{equipment:j,rooms:d,conditions:m,onClose:()=>S(null)})]})]})}function le({equipment:r,rooms:u,conditions:d,onClose:m}){const{data:a,setData:l,put:t,processing:j}=V({equipment_code:r.equipment_code||"",type:r.type||"",brand:r.brand||"",condition:r.condition||"",room_id:r.room_id||"",isCustomCondition:!1}),S=i=>{i.preventDefault(),t(route("technician.equipments.update",r.id),{onSuccess:()=>{T.fire("Updated!","Equipment updated successfully.","success"),m()}})};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Edit Equipment"}),e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsx(w,{placeholder:"Equipment Code",value:a.equipment_code,onChange:i=>l("equipment_code",i.target.value)}),e.jsx(w,{placeholder:"Type",value:a.type,onChange:i=>l("type",i.target.value)}),e.jsx(w,{placeholder:"Brand",value:a.brand,onChange:i=>l("brand",i.target.value)}),e.jsx("input",{type:"text",list:"conditionOptions",className:"w-full border rounded p-2",placeholder:"Enter or select condition",value:a.condition,onChange:i=>l("condition",i.target.value)}),e.jsxs("datalist",{id:"conditionOptions",children:[e.jsx("option",{value:"Good"}),e.jsx("option",{value:"Fair"}),e.jsx("option",{value:"Needs Repair"}),e.jsx("option",{value:"Broken"})]}),e.jsxs(v,{value:String(a.room_id),onValueChange:i=>l("room_id",i),children:[e.jsx(b,{children:e.jsx(g,{placeholder:"Select Room"})}),e.jsx(C,{children:u.map(i=>e.jsxs(c,{value:String(i.id),children:["Room ",i.room_number]},i.id))})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(o,{type:"button",variant:"outline",onClick:m,disabled:j,children:"Cancel"}),e.jsx(o,{type:"submit",disabled:j,children:"Save"})]})]})]})})}export{Be as default};
