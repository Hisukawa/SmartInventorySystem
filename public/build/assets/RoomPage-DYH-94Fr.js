import{r,u as k,j as e,a as T,t as f}from"./app-Di31QePS.js";import{Q as D}from"./index-CqE0cEYe.js";import{S as le}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{N as ne}from"./Notification-4GDhfWX2.js";import{T as E,a as ce,b as M,c,d as de,e as d}from"./table-CJ2xxB_R.js";import{B as o}from"./button-BOSs5-Bw.js";import{I as b}from"./input-CSr6fIuN.js";import{D as O,a as B,b as me,c as q}from"./dialog-B3x4z2K6.js";import{A as pe}from"./app-sidebar-JA2ELYIa.js";import{B as xe,a as he,b as ue,c as ge}from"./breadcrumb-BzF23N9r.js";import{S as fe,a as be,b as je,c as ve}from"./avatar-CLmULjNZ.js";import{P as Ne}from"./pen-D2eSiOvu.js";import"./bell-COgb0iRz.js";import"./createLucideIcon-0ROLh-G9.js";import"./utils-CBfrqCZ4.js";import"./index-1pcCnLfL.js";import"./index-Dgq8gXnb.js";import"./index-BeuHzciq.js";import"./index-DP8ALGzX.js";import"./dropdown-menu-DwlcXw75.js";import"./index-RXsudbxc.js";import"./chevron-right-DRVY_d4a.js";import"./user-5Fvro5dK.js";import"./keyboard-Ba7FeAWa.js";import"./boxes-lfNeHimY.js";import"./users-CP3mSCFv.js";import"./chevron-down-DsEOygIq.js";import"./index-mNJmlL6r.js";import"./index-CWvUTaNw.js";function ss({rooms:t,search:I}){const[j,Q]=r.useState(I||""),[v,N]=r.useState(!1),[A,m]=r.useState(!1),[L,P]=r.useState(null),[p,w]=r.useState(""),[x,S]=r.useState(""),[$,y]=r.useState(!1),[R,we]=r.useState(""),{data:H,setData:U,post:F,reset:K,processing:X,errors:C}=k({room_number:""}),{data:G,setData:_,put:J,processing:V,errors:z,reset:W}=k({room_number:""}),Y=s=>{s.preventDefault(),F("/admin/rooms",{preserveScroll:!0,onSuccess:()=>{K(),f.success("Room Added",{description:"The room has been added successfully!",duration:2e3})},onError:a=>{a.room_number?f.error("Room already exists!",{description:a.room_number,duration:2500}):f.error("Error",{description:"Something went wrong. Please check your inputs.",duration:2500})}})},Z=s=>{s.preventDefault(),J(`/admin/rooms/${L.id}`,{preserveScroll:!0,onSuccess:()=>{m(!1),W(),le.fire({icon:"success",title:"Room updated!",showConfirmButton:!1,timer:1500})}})},ee=s=>{P(s),_("room_number",s.room_number),m(!0)},se=s=>{s.key==="Enter"&&T.get("/admin/rooms",{search:j})},te=(s,a)=>{s&&(w(s),S(a))},ae=()=>{const s=document.getElementById("qr-download"),i=new XMLSerializer().serializeToString(s),h=new Blob([i],{type:"image/svg+xml;charset=utf-8"}),oe=URL.createObjectURL(h),u=new Image;u.onload=()=>{const l=document.createElement("canvas"),n=l.getContext("2d");l.width=220,l.height=260,n.fillStyle="#fff",n.fillRect(0,0,l.width,l.height),n.drawImage(u,10,10,200,200),n.fillStyle="#000",n.font="bold 16px sans-serif",n.textAlign="center",n.fillText(`ROOM ${x}`,l.width/2,235);const ie=l.toDataURL("image/png"),g=document.createElement("a");g.href=ie,g.download=`room-${x}-qr.png`,g.click()},u.src=oe},re=async()=>{await navigator.clipboard.writeText(p),y(!0),setTimeout(()=>y(!1),2e3)};return e.jsxs(fe,{children:[e.jsx(pe,{}),e.jsxs(be,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx(je,{}),e.jsx(ve,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(xe,{className:"",children:e.jsx(he,{children:e.jsx(ue,{children:e.jsx(ge,{href:"/admin/rooms","aria-current":"page",className:"font-semibold text-foreground",children:"Room Lists"})})})}),e.jsx("div",{className:"flex-1"}),e.jsx(ne,{})]}),e.jsxs("main",{className:"w-full px-6 py-4 overflow-y-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h1",{className:"text-xl font-bold",children:"Room Management"})}),R&&e.jsx("div",{className:"mb-4 p-3 bg-green-100 text-green-800 rounded shadow text-sm",children:R}),e.jsx(O,{open:A,onOpenChange:m,children:e.jsxs(B,{children:[e.jsx(me,{children:e.jsx(q,{children:"Edit Room"})}),e.jsxs("form",{onSubmit:Z,className:"space-y-4",children:[e.jsx(b,{placeholder:"e.g. 101",value:G.room_number,onChange:s=>_("room_number",s.target.value)}),z.room_number&&e.jsx("p",{className:"text-sm text-red-500",children:z.room_number}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsx(o,{type:"submit",disabled:V,children:"Update"})]})]})]})}),e.jsxs("div",{className:"flex transition-all duration-700 ease-in-out relative",children:[e.jsxs("div",{className:`flex-1 transition-all duration-700 ease-in-out ${v?"mr-[400px] sm:mr-[500px]":"mr-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 gap-2",children:[e.jsx(b,{placeholder:"Search rooms...",value:j,onChange:s=>Q(s.target.value),onKeyDown:se,className:"w-full sm:w-1/3"}),e.jsx(o,{onClick:()=>N(!0),className:"bg-[hsl(142,31%,51%)] hover:bg-[hsl(142,31%,45%)] text-white font-medium",children:"Add Room"})]}),e.jsx("div",{children:e.jsxs("div",{className:"rounded-md border transition-all duration-700 ease-in-out",children:[e.jsxs("div",{className:"relative",children:[e.jsx(E,{className:"min-w-full border-collapse",children:e.jsx(ce,{children:e.jsxs(M,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] h-10",children:[e.jsx(c,{className:"font-semibold sticky top-0 bg-[hsl(142,34%,85%)] z-20",children:"#"}),e.jsx(c,{className:"font-semibold sticky top-0 bg-[hsl(142,34%,85%)] z-20",children:"Room Name"}),e.jsx(c,{className:"font-semibold sticky top-0 bg-[hsl(142,34%,85%)] z-20",children:"Room Code"}),e.jsx(c,{className:"font-semibold sticky top-0 bg-[hsl(142,34%,85%)] z-20",children:"QR Code"}),e.jsx(c,{className:"font-semibold sticky top-0 bg-[hsl(142,34%,85%)] z-20",children:"Actions"})]})})}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:e.jsx(E,{className:"min-w-full border-collapse",children:e.jsx(de,{children:t.data.map((s,a)=>{const i=typeof s.room_path=="string"?`${window.location.origin}/room/${s.room_path}`:null;return e.jsxs(M,{children:[e.jsx(d,{children:(t.current_page-1)*t.per_page+a+1}),e.jsxs(d,{children:["ROOM"," ",s.room_number]}),e.jsx(d,{children:s.room_path}),e.jsx(d,{children:i?e.jsx("div",{className:"w-16 h-16 bg-white p-1 rounded cursor-pointer m-1",onClick:h=>{h.stopPropagation(),te(i,s.room_number)},children:e.jsx(D,{value:i,size:64})}):e.jsx("span",{className:"text-sm text-gray-500",children:"No QR"})}),e.jsx(d,{className:"flex gap-2",children:e.jsxs(o,{size:"sm",className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>ee(s),children:[e.jsx(Ne,{className:"h-4 w-4"}),"Edit"]})})]},s.id)})})})})]}),e.jsxs("div",{className:"mt-2 flex flex-col sm:flex-row justify-between items-center gap-2 p-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground m-2",children:["Showing"," ",t.data.length===0?0:(t.current_page-1)*t.per_page+1," ","–",Math.min(t.current_page*t.per_page,t.total)," ","of ",t.total," rooms"]}),e.jsx("div",{className:"flex flex-wrap justify-center items-center gap-2",children:t.links.map((s,a)=>{const i=s.label.replace("&laquo;","«").replace("&raquo;","»");return e.jsx(o,{variant:s.active?"default":"ghost",size:"sm",className:"min-w-[36px] px-3 py-1",onClick:()=>s.url&&T.visit(s.url,{preserveState:!0,preserveScroll:!0}),disabled:!s.url,dangerouslySetInnerHTML:{__html:i}},a)})})]})]})})]}),e.jsxs("div",{className:`fixed top-[56px] right-0 h-[calc(100vh-4rem)] w-[400px] sm:w-[500px] bg-white border-l shadow-lg z-40 p-4 overflow-y-auto transform transition-transform duration-700 ease-in-out ${v?"translate-x-0":"translate-x-full"}`,children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h2",{className:"text-lg font-semibold",children:"Add Room"})}),e.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[e.jsx(b,{placeholder:"e.g. 101",value:H.room_number,onChange:s=>U("room_number",s.target.value)}),C.room_number&&e.jsx("p",{className:"text-sm text-red-500",children:C.room_number}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>N(!1),children:"Cancel"}),e.jsx(o,{type:"submit",disabled:X,className:"bg-[hsl(142,31%,51%)] hover:bg-[hsl(142,31%,45%)] text-white font-medium",children:"Save"})]})]})]})]}),e.jsx(O,{open:!!p,onOpenChange:()=>{w(""),S("")},children:e.jsxs(B,{className:"max-w-sm text-center",children:[e.jsxs(q,{children:["ROOM ",x]}),e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"inline-block p-4 bg-white rounded cursor-pointer",onClick:s=>{s.stopPropagation(),re()},children:[e.jsx(D,{id:"qr-download",value:p,size:200}),e.jsx("p",{className:"text-xs mt-2 text-muted-foreground",children:"Click QR to copy link"})]}),$&&e.jsx("p",{className:"text-green-600 text-sm text-center mt-1",children:"Copied to clipboard!"}),e.jsx(o,{className:"mt-4",onClick:ae,children:"Download QR"})]})]})})]})]})]})}export{ss as default};
