import{r as t,u as k,j as e,a as T}from"./app-BY269CKa.js";import{Q as D}from"./index-Bf6vrkt1.js";import{S as ie}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{N as ne}from"./Notification-Cm6SZ0Am.js";import{T as E,a as ce,b as M,c,d as de,e as d}from"./table-BSAyF4oJ.js";import{B as a}from"./button-DmVd0Qoa.js";import{I as g}from"./input-0jd-5Ynj.js";import{D as O,a as B,b as me,c as q}from"./dialog-dHoRb1Hk.js";import{A as xe}from"./app-sidebar-CitOQlf0.js";import{B as pe,a as he,b as ue,c as fe}from"./breadcrumb-Cl5fpyoi.js";import{S as ge,a as be,b as je,c as ve}from"./avatar-CU1ZKMC3.js";import{P as Ne}from"./pen-DB5iChEk.js";import"./bell-BAc8rKzI.js";import"./createLucideIcon-Bm2NC8Ie.js";import"./utils-CBfrqCZ4.js";import"./index-D1LSely-.js";import"./index-DWviX9Ov.js";import"./index-Bysdviys.js";import"./index-DeU_LsM4.js";import"./index-xMNSz_ZY.js";import"./dropdown-menu-Dv22JrHb.js";import"./index-CCIsUyn9.js";import"./chevron-right-CgrfU1TF.js";import"./sparkles-zP5N-Csa.js";import"./keyboard-BR7ps_kt.js";import"./boxes-DM7zQTth.js";import"./users-qSput1ie.js";import"./chevron-down-DABFwW10.js";import"./index-Cw_T0ylj.js";import"./index-DJYJf0X5.js";function ss({rooms:i,search:I}){const[b,Q]=t.useState(I||""),[j,v]=t.useState(!1),[L,m]=t.useState(!1),[P,A]=t.useState(null),[x,N]=t.useState(""),[p,w]=t.useState(""),[$,S]=t.useState(!1),[y,R]=t.useState(""),{data:H,setData:U,post:F,reset:K,processing:X,errors:C}=k({room_number:""}),{data:G,setData:_,put:J,processing:V,errors:z,reset:W}=k({room_number:""}),Y=s=>{s.preventDefault(),F("/admin/rooms",{preserveScroll:!0,onSuccess:()=>{K(),R("Room added successfully!"),setTimeout(()=>R(""),5e3)}})},Z=s=>{s.preventDefault(),J(`/admin/rooms/${P.id}`,{preserveScroll:!0,onSuccess:()=>{m(!1),W(),ie.fire({icon:"success",title:"Room updated!",showConfirmButton:!1,timer:1500})}})},ee=s=>{A(s),_("room_number",s.room_number),m(!0)},se=s=>{s.key==="Enter"&&T.get("/admin/rooms",{search:b})},te=(s,n)=>{s&&(N(s),w(n))},ae=()=>{const s=document.getElementById("qr-download"),r=new XMLSerializer().serializeToString(s),h=new Blob([r],{type:"image/svg+xml;charset=utf-8"}),oe=URL.createObjectURL(h),u=new Image;u.onload=()=>{const o=document.createElement("canvas"),l=o.getContext("2d");o.width=220,o.height=260,l.fillStyle="#fff",l.fillRect(0,0,o.width,o.height),l.drawImage(u,10,10,200,200),l.fillStyle="#000",l.font="bold 16px sans-serif",l.textAlign="center",l.fillText(`ROOM ${p}`,o.width/2,235);const le=o.toDataURL("image/png"),f=document.createElement("a");f.href=le,f.download=`room-${p}-qr.png`,f.click()},u.src=oe},re=async()=>{await navigator.clipboard.writeText(x),S(!0),setTimeout(()=>S(!1),2e3)};return e.jsxs(ge,{children:[e.jsx(xe,{}),e.jsxs(be,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx(je,{}),e.jsx(ve,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(pe,{className:"",children:e.jsx(he,{children:e.jsx(ue,{children:e.jsx(fe,{href:"/admin/rooms","aria-current":"page",className:"font-semibold text-foreground",children:"Room Lists"})})})}),e.jsx("div",{className:"flex-1"}),e.jsx(ne,{})]}),e.jsxs("main",{className:"w-full px-6 py-4 overflow-y-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h1",{className:"text-xl font-bold",children:"Room Management"})}),y&&e.jsx("div",{className:"mb-4 p-3 bg-green-100 text-green-800 rounded shadow text-sm",children:y}),e.jsx(O,{open:L,onOpenChange:m,children:e.jsxs(B,{children:[e.jsx(me,{children:e.jsx(q,{children:"Edit Room"})}),e.jsxs("form",{onSubmit:Z,className:"space-y-4",children:[e.jsx(g,{placeholder:"e.g. 101",value:G.room_number,onChange:s=>_("room_number",s.target.value)}),z.room_number&&e.jsx("p",{className:"text-sm text-red-500",children:z.room_number}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(a,{type:"button",variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsx(a,{type:"submit",disabled:V,children:"Update"})]})]})]})}),e.jsxs("div",{className:"flex transition-all duration-700 ease-in-out relative",children:[e.jsxs("div",{className:`flex-1 transition-all duration-700 ease-in-out ${j?"mr-[400px] sm:mr-[500px]":"mr-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 gap-2",children:[e.jsx(g,{placeholder:"Search rooms...",value:b,onChange:s=>Q(s.target.value),onKeyDown:se,className:"w-full sm:w-1/3"}),e.jsx(a,{onClick:()=>v(!0),className:"bg-[hsl(142,31%,51%)] hover:bg-[hsl(142,31%,45%)] text-white font-medium",children:"Add Room"})]}),e.jsx("div",{children:e.jsxs("div",{className:"rounded-md border transition-all duration-700 ease-in-out",children:[e.jsxs("div",{className:"relative",children:[e.jsx(E,{className:"min-w-full border-collapse",children:e.jsx(ce,{children:e.jsxs(M,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] h-10",children:[e.jsx(c,{className:"font-semibold sticky top-0 bg-[hsl(142,34%,85%)] z-20",children:"#"}),e.jsx(c,{className:"font-semibold sticky top-0 bg-[hsl(142,34%,85%)] z-20",children:"Room Name"}),e.jsx(c,{className:"font-semibold sticky top-0 bg-[hsl(142,34%,85%)] z-20",children:"Room Code"}),e.jsx(c,{className:"font-semibold sticky top-0 bg-[hsl(142,34%,85%)] z-20",children:"QR Code"}),e.jsx(c,{className:"font-semibold sticky top-0 bg-[hsl(142,34%,85%)] z-20",children:"Actions"})]})})}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:e.jsx(E,{className:"min-w-full border-collapse",children:e.jsx(de,{children:i.data.map((s,n)=>{const r=typeof s.room_path=="string"?`${window.location.origin}/room/${s.room_path}`:null;return e.jsxs(M,{children:[e.jsx(d,{children:(i.current_page-1)*i.per_page+n+1}),e.jsxs(d,{children:["ROOM"," ",s.room_number]}),e.jsx(d,{children:s.room_path}),e.jsx(d,{children:r?e.jsx("div",{className:"w-16 h-16 bg-white p-1 rounded cursor-pointer m-1",onClick:h=>{h.stopPropagation(),te(r,s.room_number)},children:e.jsx(D,{value:r,size:64})}):e.jsx("span",{className:"text-sm text-gray-500",children:"No QR"})}),e.jsx(d,{className:"flex gap-2",children:e.jsxs(a,{size:"sm",className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>ee(s),children:[e.jsx(Ne,{className:"h-4 w-4"}),"Edit"]})})]},s.id)})})})})]}),e.jsxs("div",{className:"mt-2 flex flex-col sm:flex-row justify-between items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground m-2",children:["Page ",i.current_page," of"," ",i.last_page]}),e.jsx("div",{className:"flex flex-wrap justify-center items-center gap-2",children:i.links.map((s,n)=>{const r=s.label.replace("&laquo;","«").replace("&raquo;","»");return e.jsx(a,{variant:s.active?"default":"ghost",size:"sm",className:"min-w-[36px] px-3 py-1",onClick:()=>s.url&&T.visit(s.url,{preserveState:!0,preserveScroll:!0}),disabled:!s.url,dangerouslySetInnerHTML:{__html:r}},n)})})]})]})})]}),e.jsxs("div",{className:`fixed top-[56px] right-0 h-[calc(100vh-4rem)] w-[400px] sm:w-[500px] bg-white border-l shadow-lg z-40 p-4 overflow-y-auto transform transition-transform duration-700 ease-in-out ${j?"translate-x-0":"translate-x-full"}`,children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h2",{className:"text-lg font-semibold",children:"Add Room"})}),e.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[e.jsx(g,{placeholder:"e.g. 101",value:H.room_number,onChange:s=>U("room_number",s.target.value)}),C.room_number&&e.jsx("p",{className:"text-sm text-red-500",children:C.room_number}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(a,{type:"button",variant:"outline",onClick:()=>v(!1),children:"Cancel"}),e.jsx(a,{type:"submit",disabled:X,className:"bg-[hsl(142,31%,51%)] hover:bg-[hsl(142,31%,45%)] text-white font-medium",children:"Save"})]})]})]})]}),e.jsx(O,{open:!!x,onOpenChange:()=>{N(""),w("")},children:e.jsxs(B,{className:"max-w-sm text-center",children:[e.jsxs(q,{children:["ROOM ",p]}),e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"inline-block p-4 bg-white rounded cursor-pointer",onClick:s=>{s.stopPropagation(),re()},children:[e.jsx(D,{id:"qr-download",value:x,size:200}),e.jsx("p",{className:"text-xs mt-2 text-muted-foreground",children:"Click QR to copy link"})]}),$&&e.jsx("p",{className:"text-green-600 text-sm text-center mt-1",children:"Copied to clipboard!"}),e.jsx(a,{className:"mt-4",onClick:ae,children:"Download QR"})]})]})})]})]})]})}export{ss as default};
