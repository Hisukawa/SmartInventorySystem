import{b as f,r as p,j as e,H as b,R as g,c as w}from"./app-B0ElCXrB.js";import{S as d}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{S as v,a as S,b as E,c as B}from"./avatar-CdkPcV_j.js";import{N as C}from"./Notification-pasfHt_W.js";import{B as q,a as H,b as P,c as _}from"./breadcrumb-CQjoxxNW.js";import{A as k}from"./app-sidebar-DNbuQ6tr.js";import{T as A}from"./TopNavBar-DewojEhq.js";import"./index-DBqFQRs9.js";import"./button-B1aBu1rQ.js";import"./utils-CBfrqCZ4.js";import"./input-CbiKJPFp.js";import"./index-DOK5PBJ1.js";import"./index-9s9kbW9g.js";import"./createLucideIcon-DFHQ35hx.js";import"./index-Bw859MTn.js";import"./dropdown-menu-wX5B-Vos.js";import"./index-BLjJ5epe.js";import"./chevron-right-DpS6ww6i.js";import"./index-DSMcb-2X.js";import"./index-Dp2Owpb-.js";import"./bell-CNYpmgNu.js";import"./house-BT_FwIEM.js";import"./user-CP0vqWNT.js";import"./log-out-DiilUuf-.js";import"./keyboard-DeLtDYyr.js";import"./boxes-Bd8gwRwE.js";import"./users-BFNCHoSa.js";import"./chevron-down-B6so37Y0.js";import"./cpu-B76YXCQP.js";import"./hard-drive--c1t6f1m.js";import"./menu-D5aaayv8.js";function me(){const{histories:h}=f().props,[i,u]=p.useState(h||[]),[s,c]=p.useState(1),l=10,m=s*l,x=m-l,j=i.slice(x,m),n=Math.ceil(i.length/l),o=t=>{t>=1&&t<=n&&c(t)},N=async t=>{d.fire({title:"Are you sure?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(async r=>{if(r.isConfirmed)try{await w.delete(`/equipment-history/${t}`);const a=i.filter(y=>y.id!==t);u(a),a.length<=x&&s>1&&c(s-1),d.fire({title:"Deleted!",text:"History has been deleted.",icon:"success",timer:1e3,showConfirmButton:!1})}catch(a){console.error("Error deleting history:",a),d.fire("Error!","Failed to delete history.","error")}})};return e.jsxs(v,{children:[e.jsx(k,{}),e.jsxs(S,{children:[e.jsx("header",{className:"sticky top-0 z-20 bg-white border-b px-4 md:px-6 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{}),e.jsx(B,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(q,{children:e.jsx(H,{children:e.jsx(P,{children:e.jsx(_,{href:"/equipment-history","aria-current":"page",className:"font-semibold text-foreground",children:"Equipment History"})})})}),e.jsx("div",{className:"flex-1"}),e.jsx(C,{})]})}),e.jsxs("div",{className:"p-4 md:p-6 max-w-7xl mx-auto w-full",children:[e.jsx("div",{className:"sticky top-[64px] z-20 bg-white shadow-sm",children:e.jsx(A,{})}),e.jsx(b,{title:"Equipment History"}),e.jsx("h1",{className:"text-xl md:text-2xl text-center font-bold mt-5 mb-4",children:"Equipment History"}),i.length===0?e.jsx("p",{className:"text-center mt-10",children:"No equipment history found."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto bg-white shadow rounded-lg",children:e.jsxs("table",{className:"min-w-full table-auto text-center",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] hover:bg-[hsl(142,34%,80%)]",children:[e.jsx("th",{className:"px-5 py-1",children:"#"}),e.jsx("th",{className:"px-5 py-1",children:"User Name"}),e.jsx("th",{className:"px-5 py-1",children:"Equipment Name"}),e.jsx("th",{className:"px-5 py-1",children:"Action"}),e.jsx("th",{className:"px-5 py-1",children:"Component"}),e.jsx("th",{className:"px-5 py-1",children:"Old Value"}),e.jsx("th",{className:"px-5 py-1",children:"New Value"}),e.jsx("th",{className:"px-5 py-1",children:"Room Number"}),e.jsx("th",{className:"px-5 py-1",children:"Date & Time"}),e.jsx("th",{className:"px-5 py-1",children:"Manage"})]})}),e.jsx("tbody",{children:j.map((t,r)=>e.jsxs("tr",{className:"hover:shadow-sm transition-all duration-150",children:[e.jsx("td",{className:"px-5 py-2 align-middle",children:(s-1)*l+r+1}),e.jsx("td",{className:"px-5 py-2 align-middle",children:t.user?.name||"N/A"}),e.jsx("td",{className:"px-5 py-2 align-middle",children:t.equipment_name}),e.jsx("td",{className:"px-5 py-2 align-middle",children:t.action}),e.jsx("td",{className:"px-5 py-2 align-middle",children:t.component||"-"}),e.jsx("td",{className:"px-5 py-2 align-middle",children:t.old_value||"-"}),e.jsx("td",{className:"px-5 py-2 align-middle",children:t.new_value||"-"}),e.jsxs("td",{className:"px-5 py-2 align-middle",children:["Room"," ",t.room?.room_number||"N/A"]}),e.jsx("td",{className:"px-5 py-2 align-middle",children:new Date(t.created_at).toLocaleString()}),e.jsx("td",{className:"px-5 py-2 align-middle",children:t.action!=="Deleted"&&e.jsx("button",{className:"px-2 py-1 text-red-600 text-sm hover:underline",onClick:()=>N(t.id),children:"Delete"})})]},t.id))})]})}),e.jsxs("div",{className:"flex justify-between items-center p-4 mt-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Showing"," ",i.length===0?0:(s-1)*l+1," ","â€“"," ",Math.min(s*l,i.length)," ","of ",i.length," histories"]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx("button",{className:"px-3 py-1 border rounded text-sm disabled:opacity-50",disabled:s===1,onClick:()=>o(s-1),children:"Previous"}),Array.from({length:n},(t,r)=>r+1).filter(t=>t===1||t===n?!0:t>=s-2&&t<=s+2).map((t,r,a)=>e.jsxs(g.Fragment,{children:[r>0&&a[r]-a[r-1]>1&&e.jsx("span",{className:"px-2",children:"..."}),e.jsx("button",{className:`px-3 py-1 border rounded text-sm ${s===t?"bg-black text-white":"hover:bg-gray-200"}`,onClick:()=>o(t),children:t})]},t)),e.jsx("button",{className:"px-3 py-1 border rounded text-sm disabled:opacity-50",disabled:s===n,onClick:()=>o(s+1),children:"Next"})]})]})]})]})]})]})}export{me as default};
