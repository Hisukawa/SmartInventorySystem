import{r as g,u as B,j as e,a as w,R as A}from"./app-BHgR5J0T.js";import{B as o}from"./button-C_QzCX0U.js";import{A as O}from"./app-sidebar-CEl0JG9S.js";import{S as I,a as F,b as M,c as L}from"./avatar-Czv05K2i.js";import{c as U}from"./createLucideIcon-DviC-l3n.js";import{S as _}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{I as q}from"./input-B0gAjiUN.js";import{N as H}from"./Notification-DJr1jnHA.js";import{T as $,a as K,b as E,c as f,d as X,e as j}from"./table-CTf1zz91.js";import{B as Y,a as G,b as J,c as P,d as Q}from"./breadcrumb-DAkEgYRH.js";import{P as W,a as Z,b as ee,S as N,c as y,d as S,e as C,f as h}from"./select-NnbekM4E.js";import{E as se}from"./eye-DoyojZsH.js";import{P as te,T as le}from"./trash-2-GVpRv0_p.js";import{X as ne}from"./index-ha9xNAJE.js";import"./index-B6wKh4jr.js";import"./index-B2q6o5P9.js";import"./dropdown-menu-CiDm_NCp.js";import"./index-DklWBItD.js";import"./index-D3SQ_rNK.js";import"./chevron-right-CnuAJSnQ.js";import"./sparkles-BWNqvcsh.js";import"./user-vvqiSZ37.js";import"./index-W_JpSt0a.js";import"./index-BdQq_4o_.js";import"./index-fd9NpJYJ.js";const R=[{label:"Functional",color:"bg-green-500"},{label:"Defective",color:"bg-red-500"},{label:"Under Maintenance",color:"bg-yellow-500"},{label:"Needs Upgrade",color:"bg-blue-500"},{label:"For Disposal",color:"bg-gray-500"}];function ie({filters:a,filterOptions:m,onApplyFilters:c}){const[n,x]=g.useState(""),[i,d]=g.useState(""),r=t=>{const u=t==="all"?"":t;d(u),n==="type"?c({...a,type:u}):n==="condition"?c({...a,condition:u}):n==="room"&&c({...a,room_id:u})},b=()=>{x(""),d(""),c({type:"",condition:"",room_id:""})};return e.jsxs(W,{children:[e.jsx(Z,{asChild:!0,children:e.jsx(o,{size:"sm",className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",children:"Filters"})}),e.jsx(ee,{className:"w-72",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(N,{value:n,onValueChange:t=>{x(t),d("")},children:[e.jsx(y,{children:e.jsx(S,{placeholder:"Select filter field"})}),e.jsxs(C,{children:[e.jsx(h,{value:"type",children:"Type"}),e.jsx(h,{value:"condition",children:"Condition"}),e.jsx(h,{value:"room",children:"Room"})]})]}),n==="type"&&e.jsxs(N,{value:i||"all",onValueChange:r,children:[e.jsx(y,{children:e.jsx(S,{placeholder:"Select Type"})}),e.jsxs(C,{children:[e.jsx(h,{value:"all",children:"All"}),m.types.map(t=>e.jsx(h,{value:t,children:t},t))]})]}),n==="condition"&&e.jsxs(N,{value:i||"all",onValueChange:r,children:[e.jsx(y,{children:e.jsx(S,{placeholder:"Select Condition"})}),e.jsxs(C,{children:[e.jsx(h,{value:"all",children:"All"}),m.conditions.map(t=>e.jsx(h,{value:t,children:t},t))]})]}),n==="room"&&e.jsxs(N,{value:i||"all",onValueChange:r,children:[e.jsx(y,{children:e.jsx(S,{placeholder:"Select Room"})}),e.jsxs(C,{children:[e.jsx(h,{value:"all",children:"All"}),Object.entries(m.rooms).map(([t,u])=>e.jsxs(h,{value:t,children:["Room ",u]},t))]})]}),(n||i)&&e.jsx("div",{className:"flex justify-end",children:e.jsxs(o,{size:"sm",variant:"outline",onClick:b,className:"flex items-center gap-1 text-red-600 hover:bg-red-50",children:[e.jsx(ne,{className:"w-4 h-4"}),"Reset"]})})]})})]})}function Be({equipments:a,existingRooms:m,filters:c={}}){const[n,x]=g.useState(""),[i,d]=g.useState(1),[r,b]=g.useState(null),t=10,{delete:u}=B(),z=g.useMemo(()=>{const s=l=>[...new Set(l.filter(Boolean))].sort();return{types:s(a.map(l=>l.type)),conditions:s(a.map(l=>l.condition)),rooms:Object.fromEntries(m.map(l=>[String(l.id),l.room_number]))}},[a,m]);function T(s){const l=Object.fromEntries(Object.entries({...s,search:n||void 0}).filter(([,p])=>p!==""&&p!==void 0));w.get("/equipments",l,{preserveState:!0,replace:!0})}const v=Math.ceil(a.length/t)||1,k=a.slice((i-1)*t,i*t),D=s=>{const l=R.find(p=>p.label.toLowerCase()===s.toLowerCase());return l?l.color:"bg-muted"};function V(s){_.fire({title:"Are you sure?",text:`Delete equipment ${s.equipment_code}?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!"}).then(l=>{l.isConfirmed&&u(route("equipments.destroy",s.equipment_code),{onSuccess:()=>{_.fire("Deleted!","Equipment has been deleted.","success")}})})}return e.jsxs(I,{children:[e.jsx(O,{}),e.jsxs(F,{children:[e.jsx("header",{className:"sticky top-0 z-20 bg-white border-b px-6 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{}),e.jsx(L,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(Y,{children:e.jsx(G,{children:e.jsxs(J,{children:[e.jsx(P,{href:"#","aria-current":"page",children:"Assets"}),e.jsx(Q,{}),e.jsx(P,{href:"/equipments","aria-current":"page",className:"font-semibold text-foreground",children:"Equipments"})]})})}),e.jsx("div",{className:"flex-1"}),e.jsx(H,{})]})}),e.jsxs("main",{className:"w-full px-6 py-4",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Equipments"}),e.jsxs("div",{className:"flex justify-between items-center mb-4 gap-2",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(ie,{filters:c,filterOptions:z,onApplyFilters:T}),e.jsx(q,{placeholder:"Search Equipment Code...",value:n,onChange:s=>x(s.target.value),onKeyDown:s=>s.key==="Enter"&&T(c),className:`text-sm sm:text-base px-2 sm:px-3 py-1 sm:py-2 flex-1 max-w-xs
               border-[hsl(142,34%,51%)] text-[hsl(142,34%,20%)] 
               focus:border-[hsl(142,34%,45%)] focus:ring-[hsl(142,34%,45%)] 
               placeholder:text-[hsl(142,34%,40%)]`})]}),e.jsx(o,{className:"text-sm sm:text-base px-3 py-1 sm:py-2 bg-[hsl(142,31%,51%)] hover:bg-[hsl(142,31%,45%)] text-white font-medium",onClick:()=>w.visit("/equipments/addequipment"),children:"Add Equipment"})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border",children:e.jsxs($,{children:[e.jsx(K,{children:e.jsxs(E,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] hover:bg-[hsl(142,34%,80%)]",children:[e.jsx(f,{children:"#"}),e.jsx(f,{children:"Equipment Code"}),e.jsx(f,{children:"Room"}),e.jsx(f,{children:"Type"}),e.jsx(f,{children:"Condition"}),e.jsx(f,{className:"text-center",children:"Actions"})]})}),e.jsx(X,{children:k.length>0?k.map((s,l)=>e.jsxs(E,{children:[e.jsx(j,{children:(i-1)*t+l+1}),e.jsx(j,{children:s.equipment_code}),e.jsxs(j,{children:["ROOM"," ",s.room?.room_number||"N/A"]}),e.jsx(j,{children:s.type}),e.jsx(j,{children:s.condition&&e.jsxs("div",{className:"mt-1 text-sm flex items-center gap-2",children:[e.jsx("span",{className:U("inline-block w-3 h-3 rounded-full",D(s.condition))}),e.jsx("span",{className:"capitalize",children:s.condition})]})}),e.jsx(j,{className:"text-center",children:e.jsxs("div",{className:"hidden sm:flex gap-2 justify-center",children:[e.jsxs(o,{size:"sm",className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>w.visit(`/equipments/view/${s.equipment_code}`),children:[e.jsx(se,{className:"h-4 w-4"}),"View"]}),e.jsxs(o,{size:"sm",className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>b(s),children:[e.jsx(te,{className:"h-4 w-4"}),"Edit"]}),e.jsxs(o,{size:"sm",variant:"destructive",className:"flex items-center gap-2",onClick:()=>V(s),children:[e.jsx(le,{className:"h-4 w-4"}),"Delete"]})]})})]},s.id)):e.jsx(E,{children:e.jsx(j,{colSpan:6,className:"text-center py-4",children:"No equipments found."})})})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mt-4 gap-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",i," of ",v]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(o,{size:"sm",variant:"outline",disabled:i===1,onClick:()=>d(s=>s-1),children:"Previous"}),Array.from({length:v},(s,l)=>l+1).filter(s=>s===1||s===v?!0:s>=i-2&&s<=i+2).map((s,l,p)=>e.jsxs(A.Fragment,{children:[l>0&&p[l]-p[l-1]>1&&e.jsx("span",{className:"px-1",children:"..."}),e.jsx(o,{size:"sm",variant:i===s?"default":"outline",onClick:()=>d(s),children:s})]},s)),e.jsx(o,{size:"sm",variant:"outline",disabled:i===v,onClick:()=>d(s=>s+1),children:"Next"})]})]}),r&&e.jsx(ae,{equipment:r,rooms:m,onClose:()=>b(null)})]})]})]})}function ae({equipment:a,rooms:m,onClose:c}){const{data:n,setData:x,put:i,processing:d,errors:r}=B({equipment_code:a.equipment_code||"",type:a.type||"",condition:a.condition||"",room_id:a.room_id||""}),b=t=>{t.preventDefault(),i(route("equipments.update",a.equipment_code),{onSuccess:()=>{_.fire("Updated!","Equipment updated successfully.","success"),c()}})};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Edit Equipment"}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Equipment Code"}),e.jsx(q,{value:n.equipment_code,onChange:t=>x("equipment_code",t.target.value)}),r.equipment_code&&e.jsx("p",{className:"text-red-500 text-sm",children:r.equipment_code})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type"}),e.jsx(q,{value:n.type,onChange:t=>x("type",t.target.value)}),r.type&&e.jsx("p",{className:"text-red-500 text-sm",children:r.type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Condition"}),e.jsxs("select",{className:"w-full border rounded px-2 py-1",value:n.condition,onChange:t=>x("condition",t.target.value),children:[e.jsx("option",{value:"",children:"Select Condition"}),R.map(t=>e.jsx("option",{value:t.label,children:t.label},t.label))]}),r.condition&&e.jsx("p",{className:"text-red-500 text-sm",children:r.condition})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Room"}),e.jsxs("select",{className:"w-full border rounded px-2 py-1",value:n.room_id,onChange:t=>x("room_id",t.target.value),children:[e.jsx("option",{value:"",children:"Select Room"}),m.map(t=>e.jsxs("option",{value:t.id,children:["Room ",t.room_number]},t.id))]}),r.room_id&&e.jsx("p",{className:"text-red-500 text-sm",children:r.room_id})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(o,{type:"button",variant:"outline",onClick:c,disabled:d,children:"Cancel"}),e.jsx(o,{type:"submit",disabled:d,children:"Save"})]})]})]})})}export{Be as default};
