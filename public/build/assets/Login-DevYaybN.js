import{r as p,j as e,u as J,H as V,a as _}from"./app-xCRcUzJI.js";import{b as X,c as Y,d as Q}from"./card-mAXTkram.js";import{I as S}from"./input-CbERMrqP.js";import{L as A}from"./label-DYQCDbU7.js";import{B as D}from"./button-CHZ-bREf.js";import{u as F}from"./index-C0JqmxRw.js";import{c as Z,d as ee,P as E,a as te,b as L}from"./index-nZtA_tgc.js";import{u as re}from"./index-D7akeRZk.js";import{u as se,C as ae}from"./index-C6sxKGrg.js";import{c as B}from"./createLucideIcon-BHNXATGm.js";import"./index-CDF6RxUF.js";var y="Checkbox",[oe,we]=Z(y),[ne,I]=oe(y);function ie(r){const{__scopeCheckbox:n,checked:s,children:o,defaultChecked:i,disabled:a,form:d,name:x,onCheckedChange:m,required:b,value:t="on",internal_do_not_use_render:c}=r,[f,l]=te({prop:s,defaultProp:i??!1,onChange:m,caller:y}),[g,C]=p.useState(null),[w,u]=p.useState(null),h=p.useRef(!1),k=g?!!d||!!g.closest("form"):!0,N={checked:f,disabled:a,setChecked:l,control:g,setControl:C,name:x,form:d,value:t,hasConsumerStoppedPropagationRef:h,required:b,defaultChecked:v(i)?!1:i,isFormControl:k,bubbleInput:w,setBubbleInput:u};return e.jsx(ne,{scope:n,...N,children:ce(c)?c(N):o})}var H="CheckboxTrigger",M=p.forwardRef(({__scopeCheckbox:r,onKeyDown:n,onClick:s,...o},i)=>{const{control:a,value:d,disabled:x,checked:m,required:b,setControl:t,setChecked:c,hasConsumerStoppedPropagationRef:f,isFormControl:l,bubbleInput:g}=I(H,r),C=F(i,t),w=p.useRef(m);return p.useEffect(()=>{const u=a?.form;if(u){const h=()=>c(w.current);return u.addEventListener("reset",h),()=>u.removeEventListener("reset",h)}},[a,c]),e.jsx(E.button,{type:"button",role:"checkbox","aria-checked":v(m)?"mixed":m,"aria-required":b,"data-state":z(m),"data-disabled":x?"":void 0,disabled:x,value:d,...o,ref:C,onKeyDown:L(n,u=>{u.key==="Enter"&&u.preventDefault()}),onClick:L(s,u=>{c(h=>v(h)?!0:!h),g&&l&&(f.current=u.isPropagationStopped(),f.current||u.stopPropagation())})})});M.displayName=H;var P=p.forwardRef((r,n)=>{const{__scopeCheckbox:s,name:o,checked:i,defaultChecked:a,required:d,disabled:x,value:m,onCheckedChange:b,form:t,...c}=r;return e.jsx(ie,{__scopeCheckbox:s,checked:i,defaultChecked:a,disabled:x,required:d,onCheckedChange:b,name:o,form:t,value:m,internal_do_not_use_render:({isFormControl:f})=>e.jsxs(e.Fragment,{children:[e.jsx(M,{...c,ref:n,__scopeCheckbox:s}),f&&e.jsx(K,{__scopeCheckbox:s})]})})});P.displayName=y;var O="CheckboxIndicator",q=p.forwardRef((r,n)=>{const{__scopeCheckbox:s,forceMount:o,...i}=r,a=I(O,s);return e.jsx(ee,{present:o||v(a.checked)||a.checked===!0,children:e.jsx(E.span,{"data-state":z(a.checked),"data-disabled":a.disabled?"":void 0,...i,ref:n,style:{pointerEvents:"none",...r.style}})})});q.displayName=O;var U="CheckboxBubbleInput",K=p.forwardRef(({__scopeCheckbox:r,...n},s)=>{const{control:o,hasConsumerStoppedPropagationRef:i,checked:a,defaultChecked:d,required:x,disabled:m,name:b,value:t,form:c,bubbleInput:f,setBubbleInput:l}=I(U,r),g=F(s,l),C=re(a),w=se(o);p.useEffect(()=>{const h=f;if(!h)return;const k=window.HTMLInputElement.prototype,R=Object.getOwnPropertyDescriptor(k,"checked").set,W=!i.current;if(C!==a&&R){const $=new Event("click",{bubbles:W});h.indeterminate=v(a),R.call(h,v(a)?!1:a),h.dispatchEvent($)}},[f,C,a,i]);const u=p.useRef(v(a)?!1:a);return e.jsx(E.input,{type:"checkbox","aria-hidden":!0,defaultChecked:d??u.current,required:x,disabled:m,name:b,value:t,form:c,...n,tabIndex:-1,ref:g,style:{...n.style,...w,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});K.displayName=U;function ce(r){return typeof r=="function"}function v(r){return r==="indeterminate"}function z(r){return v(r)?"indeterminate":r?"checked":"unchecked"}const G=p.forwardRef(({className:r,...n},s)=>e.jsx(P,{ref:s,className:B("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...n,children:e.jsx(q,{className:B("flex items-center justify-center text-current"),children:e.jsx(ae,{className:"h-4 w-4"})})}));G.displayName=P.displayName;function T(r){if(!r||typeof r!="string")throw new Error("Expected base64url string.");const n="=".repeat((4-r.length%4)%4),s=(r+n).replace(/-/g,"+").replace(/_/g,"/"),o=atob(s);return Uint8Array.from([...o].map(i=>i.charCodeAt(0)))}function j(r){const n=new Uint8Array(r);let s="";for(let o=0;o<n.byteLength;o++)s+=String.fromCharCode(n[o]);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function ve({status:r,canResetPassword:n}){const{data:s,setData:o,post:i,processing:a,errors:d,reset:x}=J({email:"",password:"",remember:!1}),m=t=>{t.preventDefault(),i(route("login"),{onFinish:()=>x("password")})},b=async()=>{try{const{data:t}=await _.post("/webauthn/login/options",{email:s.email});if(!t||!t.challenge){console.error("Bad login/options response:",t),alert(t?.error||"No challenge received for this user.");return}const c=Array.isArray(t.allowCredentials)?t.allowCredentials:[];if(c.length===0){alert("No registered WebAuthn device found for this user. Please register a device first.");return}t.challenge=T(t.challenge),t.allowCredentials=c.map(w=>({...w,id:T(w.id)}));const f={...t,userVerification:"preferred"},l=await navigator.credentials.get({publicKey:f}),g={id:l.id,rawId:j(l.rawId),type:l.type,response:{clientDataJSON:j(l.response.clientDataJSON),authenticatorData:j(l.response.authenticatorData),signature:j(l.response.signature),userHandle:l.response.userHandle?j(l.response.userHandle):null}},C=await _.post("/webauthn/login",{email:s.email,credential:g});C.data?.success?window.location.href="/faculty/dashboard":alert(C.data?.message||"Login failed.")}catch(t){console.error(t);const c=t.response?.data?.message||t.response?.data?.error||t.message;alert(`WebAuthn login failed: ${c}`)}};return e.jsxs(e.Fragment,{children:[e.jsx(V,{title:"Log in"}),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 px-4",children:e.jsxs("div",{className:"w-full max-w-5xl grid grid-cols-1 md:grid-cols-2 bg-white shadow-lg rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"hidden md:flex flex-col items-center justify-center bg-green-500 text-white p-8 relative",children:[e.jsxs("div",{className:"flex space-x-4 mb-6",children:[e.jsx("div",{className:"w-28 h-28 rounded-full overflow-hidden border-4 border-white bg-white shadow-md",children:e.jsx("img",{src:"logo.png",alt:"Logo 1",className:"w-full h-full object-contain"})}),e.jsx("div",{className:"w-28 h-28 rounded-full overflow-hidden border-4 border-white bg-white shadow-md",children:e.jsx("img",{src:"/ict.png",alt:"Logo 2",className:"w-full h-full object-contain"})})]}),e.jsx("h2",{className:"text-2xl font-bold text-center",children:"ICT INVENTORY SYSTEM MANAGEMENT"}),e.jsx("p",{className:"mt-3 text-sm opacity-90 text-center",children:"Secure • Fast • Organized"})]}),e.jsxs("div",{className:"p-8 flex flex-col justify-center",children:[e.jsxs(X,{className:"p-0 mb-6",children:[e.jsx(Y,{className:"text-2xl font-bold",children:"Login Account"}),e.jsx(Q,{children:"Please enter your details to log in"})]}),r&&e.jsx("div",{className:"mb-4 text-sm font-medium text-green-600",children:r}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(A,{htmlFor:"email",children:"Email Address"}),e.jsx(S,{id:"email",type:"email",name:"email",value:s.email,autoComplete:"username",onChange:t=>o("email",t.target.value)}),d.email&&e.jsx("p",{className:"text-sm text-red-500",children:d.email})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"flex justify-between",children:e.jsx(A,{htmlFor:"password",children:"Password"})}),e.jsx(S,{id:"password",type:"password",name:"password",value:s.password,autoComplete:"current-password",onChange:t=>o("password",t.target.value)}),d.password&&e.jsx("p",{className:"text-sm text-red-500",children:d.password})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{id:"remember",checked:s.remember,onCheckedChange:t=>o("remember",!!t)}),e.jsx("label",{htmlFor:"remember",className:"text-sm text-muted-foreground",children:"Remember me"})]}),e.jsx(D,{type:"submit",className:"w-full mt-2 bg-green-500 hover:bg-green-600 text-white",disabled:a,children:"Login"}),e.jsx(D,{type:"button",className:"w-full mt-4 bg-blue-500 hover:bg-blue-600 text-white",onClick:b,children:"Login with Device"}),e.jsxs("div",{className:"text-center text-sm mt-6",children:["Don’t have an account?"," ",e.jsx("span",{className:"text-gray-600",children:"Please contact the ICT Department Chairperson to request one."})]})]})]})]})})]})}export{ve as default};
