import{r as t,j as e,H as G,R as J,c as S}from"./app-DND81ZFY.js";import{S as K,a as Q,b as V,c as W}from"./avatar-B0Z3ssrU.js";import{A as X}from"./app-sidebar-Bi9XrNtJ.js";import{N as Y}from"./Notification-DUY-pV9R.js";import{C,b as L,c as T,a as F}from"./card-DVP-KndB.js";import{B as ee,a as se,b as te,c as ae}from"./breadcrumb-Dqy_Ki_A.js";import{B as re}from"./badge-C7Wbb5fr.js";import{T as le,f as ie,a as ne,b as f,c as i,d as oe,e as l}from"./table-B28lAF8Y.js";import{I as P}from"./input-BJdMeYDv.js";import{B as n}from"./button-S3MLgoYB.js";import{F as ce}from"./funnel-BE0Irykg.js";import"./index-Dt-R4Eta.js";import"./utils-CBfrqCZ4.js";import"./index-CFjPNoEr.js";import"./index-BRmgfQhj.js";import"./createLucideIcon-Db0Envr7.js";import"./index-CSYp7x6o.js";import"./dropdown-menu-Kr9xUfsf.js";import"./index-CmE9p5mY.js";import"./chevron-right-BAj7NqjR.js";import"./index-QaZJmKoV.js";import"./index-COmhw21u.js";import"./house-DLRtbMTE.js";import"./user-Bd7PfpIM.js";import"./log-out-B1JTZ3MZ.js";import"./keyboard-CkzIWcTy.js";import"./boxes-WURRYb6y.js";import"./users-mmvxBN70.js";import"./chevron-down-Ddk7Ym0V.js";import"./bell-CKMyWIPA.js";function Xe({children:de}){const[j,A]=t.useState([]),[m,D]=t.useState([]),[b,me]=t.useState(1),[v,xe]=t.useState(1),[a,x]=t.useState(1),o=10,[h,R]=t.useState(""),[he,ue]=t.useState([]),[u,I]=t.useState(!1),[c,N]=t.useState(""),[B,H]=t.useState([]),[$,k]=t.useState([]),[g,O]=t.useState(""),[p,z]=t.useState(""),[ge,pe]=t.useState(""),[fe,je]=t.useState(""),[be,ve]=t.useState([]),[y,E]=t.useState(0),[Ne,M]=t.useState(1),[U,Z]=t.useState(1),_=async()=>{try{const s=await S.get(`/api/admin/rooms-status?page=${b}&per_page=${o}`);A(s.data.data),M(s.data.meta.total_pages)}catch(s){console.error("Failed to fetch rooms:",s)}},w=async()=>{try{const s=await S.get("/admin/faculty-logs",{params:{page:a,search:h,faculty_id:g,room_id:p,log_date:c}});D(s.data.logs.data||[]),Z(s.data.logs.last_page||1),E(s.data.logs.total||0),s.data.facultyOptions&&H(s.data.facultyOptions),s.data.roomOptions&&k(s.data.roomOptions)}catch(s){console.error("Failed to fetch logs:",s)}};return t.useEffect(()=>{_();const s=setInterval(_,5e3);return()=>clearInterval(s)},[b]),t.useEffect(()=>{w()},[a,h,g,p,c]),e.jsxs(K,{children:[e.jsx(G,{children:e.jsx("title",{children:"Dashboard"})}),e.jsx(X,{}),e.jsxs(Q,{children:[e.jsx("header",{className:"sticky top-0 z-20 bg-white border-b px-6 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{}),e.jsx(W,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(ee,{children:e.jsx(se,{children:e.jsx(te,{children:e.jsx(ae,{href:"/admin/monitoring","aria-current":"page",className:"font-semibold text-foreground",children:"Monitoring"})})})}),e.jsx("div",{className:"flex-1"}),e.jsx(Y,{})]})}),e.jsx("main",{className:"w-full px-6 py-4",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Room Monitoring"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 mb-8",children:[j.length===0&&e.jsx("p",{className:"col-span-full text-center text-gray-500",children:"No rooms found."}),j.map(s=>e.jsxs(C,{className:`rounded-2xl transition-all duration-200 ease-in-out shadow-md
                                                hover:scale-[1.02] hover:shadow-lg
                                                ${s.is_active?"bg-[#59AC77]  border border-green-700 text-white":"bg-[#59AC77]  border border-gray-300 text-gray-900"}`,children:[e.jsxs(L,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(T,{className:`text-lg md:text-xl font-semibold ${s.is_active?"text-white":"text-gray-900"}`,children:s.name}),e.jsx(re,{className:`px-3 py-1 text-xs font-medium rounded-full ${s.is_active?"bg-white text-green-700":"bg-gray-500 text-white"}`,children:s.is_active?"Active":"Inactive"})]}),e.jsx(F,{children:e.jsxs("div",{className:"flex items-center space-x-4",children:[s.is_active&&s.last_scanned_user?.photo?e.jsx("img",{src:s.last_scanned_user.photo,alt:s.last_scanned_user.name,className:"w-28 h-28 rounded-full object-cover border-4 border-green-500 shadow-md"}):e.jsx("div",{className:"w-28 h-28 rounded-full bg-gray-200 flex items-center justify-center text-gray-500 text-sm border-4 border-gray-300 shadow-md",children:"No Photo"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`font-medium ${s.is_active?"text-white":"text-gray-900"}`,children:s.is_active&&s.last_scanned_user?`${s.last_scanned_user.name} (${s.last_scanned_user.role})`:"No Faculty"}),e.jsx("span",{className:`text-xs ${s.is_active?"text-green-100":"text-gray-600"}`,children:s.is_active&&s.last_scanned_at?new Date(s.last_scanned_at).toLocaleString("en-PH",{timeZone:"Asia/Manila",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"Not yet scanned"})]})]})})]},s.id))]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between w-full mb-4",children:[e.jsxs(n,{className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>I(!u),children:[e.jsx(ce,{className:"w-4 h-4"}),u?"Hide Filters":"Show Filters"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{type:"text",placeholder:"Search by faculty or room...",value:h,onChange:s=>R(s.target.value),className:"w-64"}),e.jsx(n,{onClick:w,className:"bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",children:"Search"})]})]}),u&&e.jsxs("div",{className:"flex flex-wrap gap-5 items-end",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1",children:"Users"}),e.jsxs("select",{value:g,onChange:s=>O(s.target.value),className:"h-9 w-44 px-2 py-1 text-sm border rounded-md focus:ring-2 focus:ring-[hsl(142,34%,51%)] focus:outline-none",children:[e.jsx("option",{value:"",children:"All"}),B.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1",children:"Room"}),e.jsxs("select",{value:p,onChange:s=>z(s.target.value),className:"h-9 w-44 px-2 py-1 text-sm border rounded-md focus:ring-2 focus:ring-[hsl(142,34%,51%)] focus:outline-none",children:[e.jsx("option",{value:"",children:"All"}),$.map(s=>e.jsx("option",{value:s.id,children:s.room_number},s.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1",children:"Login Date"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{type:"date",value:c,onChange:s=>N(s.target.value),className:"h-9 w-44 text-sm border rounded-md focus:ring-2 focus:ring-[hsl(142,34%,51%)] focus:outline-none"}),c&&e.jsx(n,{variant:"outline",size:"sm",onClick:()=>N(""),className:"text-xs border-gray-300",children:"Clear"})]})]})]}),e.jsxs(C,{className:"shadow-md rounded-2xl",children:[e.jsx(L,{children:e.jsx(T,{children:"Users Logs History"})}),e.jsxs(F,{children:[e.jsxs(le,{children:[e.jsx(ie,{children:"A list of recent faculty room logs."}),e.jsx(ne,{children:e.jsxs(f,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] hover:bg-[hsl(142,34%,80%)] h-10",children:[e.jsx(i,{children:"#"}),e.jsx(i,{children:"User"}),e.jsx(i,{children:"Role"}),e.jsx(i,{children:"Login Date"}),e.jsx(i,{children:"Logout Date"}),e.jsx(i,{children:"Room"})]})}),e.jsxs(oe,{children:[m.length===0&&e.jsx(f,{children:e.jsx(l,{colSpan:6,className:"text-center text-gray-500",children:"No logs found."})}),m.map((s,r)=>{const d=s.created_at?new Date(s.created_at.replace(" ","T")).toLocaleString("en-PH",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"—",q=s.logged_out_at?new Date(s.logged_out_at.replace(" ","T")).toLocaleString("en-PH",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"";return e.jsxs(f,{children:[e.jsx(l,{children:r+1+(a-1)*o}),e.jsx(l,{children:s.faculty?.name??"N/A"})," ",e.jsx(l,{children:s.faculty?.role??"N/A"})," ",e.jsx(l,{children:d}),e.jsx(l,{children:q}),e.jsx(l,{children:s.room?.room_number??"N/A"})]},s.id)})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Showing"," ",m.length===0?0:(a-1)*o+1," ","–"," ",Math.min(a*o,y)," ","of ",y," Logs"]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(n,{size:"sm",variant:"outline",disabled:a===1,onClick:()=>x(s=>s-1),children:"Previous"}),Array.from({length:U},(s,r)=>r+1).filter(s=>s===1||s===v?!0:s>=a-2&&s<=a+2).map((s,r,d)=>e.jsxs(J.Fragment,{children:[r>0&&d[r]-d[r-1]>1&&e.jsx("span",{className:"px-1",children:"..."}),e.jsx(n,{size:"sm",variant:a===s?"default":"outline",onClick:()=>x(s),children:s})]},s)),e.jsx(n,{size:"sm",variant:"outline",disabled:a===v,onClick:()=>x(s=>s+1),children:"Next"})]})]})]})]})]})]})})]})]})}export{Xe as default};
