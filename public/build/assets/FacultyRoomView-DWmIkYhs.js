import{r as d,j as e,a as te,b as ae,H as le,L as F}from"./app-DMhCBzQ5.js";import{B as m}from"./button-Dk7c3Jea.js";import{T as ie,a as ne,b as R,c as b,d as re,e as g}from"./table-Hitj1Jwd.js";import{I as V}from"./input-BrTisnsF.js";import{P as oe,a as ce,b as de,S as P,c as z,d as T,e as D,f as w}from"./select-Dr5aE_QG.js";import{F as O,M as he}from"./faculty-room-view-sidebar-BmixuGyQ.js";import{D as W,a as X,b as G,c as J,f as me}from"./dialog-G8SUYpcQ.js";import{a as xe,c as ue}from"./createLucideIcon-DNlSKQIV.js";import{E}from"./eye-D-8XaH7D.js";import{F as pe}from"./file-text-Ti_llW-D.js";import{F as fe}from"./funnel-Ck6cvTty.js";import{X as $}from"./index-pXNN721A.js";import"./index-dY-lvtr0.js";import"./index-sp9pc22y.js";import"./index-lV9c79H-.js";import"./dropdown-menu-3hRIYTVr.js";import"./index-DJYAF3kh.js";import"./chevron-right-CePN6yWg.js";import"./index-Br_xJn4L.js";import"./index-BHCdCIs2.js";import"./chevron-down-CTSiS5u5.js";import"./monitor-UxL6mczF.js";import"./mouse-DeqhrcoM.js";/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],je=xe("circle-check",ge),K=d.forwardRef(({className:s,...l},i)=>e.jsx("textarea",{className:ue("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:i,...l}));K.displayName="Textarea";function be({open:s,onOpenChange:l,room:i,item:p,section:x,onSuccess:c}){const[r,h]=d.useState({condition:"",remarks:"",photo:null}),a=o=>{const j={"system-units":"system_unit",peripherals:"peripheral",equipment:"equipment"};o.preventDefault();const t=new FormData;t.append("reportable_type",j[x]||x),t.append("reportable_id",p.id),t.append("room_id",i.id),t.append("condition",r.condition),t.append("remarks",r.remarks),r.photo&&t.append("photo",r.photo),te.post(route("reports.store"),t,{onSuccess:()=>{l(!1),c&&c()}})};return e.jsx(W,{open:s,onOpenChange:l,children:e.jsxs(X,{className:"max-w-md w-[95%] rounded-2xl p-6",children:[e.jsxs(G,{children:[e.jsx(J,{children:"Report Item"}),e.jsx(me,{children:"Fill out the details below to report an issue with this item."})]}),e.jsxs("form",{onSubmit:a,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Condition"}),e.jsx(V,{placeholder:"Enter or select condition...",className:"mt-1",value:r.condition,onChange:o=>h({...r,condition:o.target.value})}),e.jsx("div",{className:"flex gap-2 mt-2 flex-wrap",children:["Working","Needs Maintenance","Defective"].map(o=>e.jsx(m,{type:"button",variant:"outline",size:"sm",onClick:()=>h({...r,condition:o}),className:`${r.condition===o?"bg-primary text-white":""}`,children:o},o))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Remarks"}),e.jsx(K,{placeholder:"Enter remarks...",className:"mt-1",value:r.remarks,onChange:o=>h({...r,remarks:o.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Upload Photo"}),e.jsx(V,{type:"file",accept:"image/*",capture:"environment",className:"mt-1",onChange:o=>h({...r,photo:o.target.files[0]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(m,{type:"submit",className:"bg-[hsl(142,34%,51%)] text-white hover:bg-[hsl(142,34%,45%)]",children:"Save"})})]})]})})}function we({open:s,onClose:l}){return e.jsx(W,{open:s,onOpenChange:l,children:e.jsxs(X,{className:"max-w-sm w-[90%] p-6 rounded-2xl shadow-xl text-center",children:[e.jsx("button",{onClick:l,className:"absolute right-4 top-4 text-gray-400 hover:text-gray-600"}),e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx(je,{className:"w-16 h-16 text-green-500"})}),e.jsx(G,{children:e.jsx(J,{className:"text-lg font-semibold text-center",children:"Reported successfully"})})]})})}function ye({page:s,pageCount:l,onPageChange:i}){return e.jsxs("div",{className:"flex justify-end items-center gap-2",children:[e.jsx(m,{size:"sm",disabled:s===1,onClick:()=>i(s-1),className:`flex items-center gap-1 
          bg-[hsl(142,34%,51%)] text-white 
          hover:bg-[hsl(142,34%,45%)] 
          disabled:bg-gray-200 disabled:text-gray-400 disabled:cursor-not-allowed`,children:"Previous"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",s," of ",l]}),e.jsx(m,{size:"sm",disabled:s===l,onClick:()=>i(s+1),className:`flex items-center gap-1 
          bg-[hsl(142,34%,51%)] text-white 
          hover:bg-[hsl(142,34%,45%)] 
          disabled:bg-gray-200 disabled:text-gray-400 disabled:cursor-not-allowed`,children:"Next"})]})}function ve({filters:s,filterOptions:l,activeSection:i,onApplyFilters:p}){const[x,c]=d.useState(""),[r,h]=d.useState("");d.useEffect(()=>{s.condition?(c("condition"),h(s.condition)):s.unit_code&&(i==="system-units"||i==="peripherals")&&(c("unit_code"),h(s.unit_code))},[s,i]);const a=t=>{const f=t==="all"?"":t;h(f),x==="condition"?p(f,s.unit_code,s.search):x==="unit_code"&&p(s.condition,f,s.search)},o=()=>{c(""),h(""),p("","",s.search)},j=()=>{const t=[{value:"condition",label:"Condition"}];return(i==="system-units"||i==="peripherals")&&t.push({value:"unit_code",label:"Unit Code"}),t};return e.jsxs(oe,{children:[e.jsx(ce,{asChild:!0,children:e.jsxs(m,{className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",children:[e.jsx(fe,{className:"h-4 w-4"}),"Filter",(s.condition||(i==="system-units"||i==="peripherals")&&s.unit_code)&&e.jsx($,{className:"h-4 w-4 ml-1 cursor-pointer",onClick:t=>{t.stopPropagation(),o()}})]})}),e.jsxs(de,{className:"w-[calc(100vw-2rem)] sm:w-[400px] p-4",align:"start",sideOffset:10,children:[e.jsx("h4",{className:"font-medium mb-3 text-lg",children:"Filter Options"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs(P,{value:x,onValueChange:t=>{c(t),h("")},children:[e.jsx(z,{className:"w-full",children:e.jsx(T,{placeholder:"Select Field"})}),e.jsx(D,{children:j().map(t=>e.jsx(w,{value:t.value,children:t.label},t.value))})]}),x==="condition"&&e.jsxs(P,{value:r||"all",onValueChange:a,children:[e.jsx(z,{className:"w-full",children:e.jsx(T,{placeholder:"Select Condition"})}),e.jsxs(D,{children:[e.jsx(w,{value:"all",children:"All"}),l.conditions.map(t=>e.jsx(w,{value:t,children:t},t))]})]}),x==="unit_code"&&(i==="system-units"||i==="peripherals")&&e.jsxs(P,{value:r||"all",onValueChange:a,children:[e.jsx(z,{className:"w-full",children:e.jsx(T,{placeholder:"Select Unit"})}),e.jsxs(D,{children:[e.jsx(w,{value:"all",children:"All"}),l.unit_codes.map(t=>e.jsx(w,{value:t,children:t},t))]})]}),(s.condition||(i==="system-units"||i==="peripherals")&&s.unit_code)&&e.jsx("div",{className:"flex justify-end",children:e.jsxs(m,{size:"sm",variant:"outline",onClick:o,className:"flex items-center gap-1 text-red-600 hover:bg-red-50 w-auto",children:[e.jsx($,{className:"h-4 w-4"}),"Reset"]})})]})]})]})}function Xe({room:s,equipments:l,systemUnits:i,peripherals:p,section:x,filters:c={},filterOptions:r={conditions:[],unit_codes:[]}}){const{auth:h}=ae().props,[a,o]=d.useState(x||"system-units"),[j,t]=d.useState(!1),[f,M]=d.useState(!1),[Q,q]=d.useState(!1),[Y,Z]=d.useState(null),[N,ee]=d.useState(c?.condition||""),[C,se]=d.useState(c?.unit_code||""),[S,I]=d.useState(c?.search||""),[y,H]=d.useState(1),v=10,L=a==="system-units"?i:a==="peripherals"?p:l,U=Math.ceil(L.length/v),A=L.slice((y-1)*v,y*v);d.useEffect(()=>{H(1),ee(c.condition||""),se(c.unit_code||""),I(c.search||"")},[a,c]);const B=(n=N,u=C,k=S)=>{const _=new URLSearchParams({section:a});n&&_.append("condition",n),u&&(a==="system-units"||a==="peripherals")&&_.append("unit_code",u),k&&_.append("search",k),window.location.href=route("faculty.room.show",{roomPath:s.room_path,section:a,condition:n||void 0,unit_code:(a==="system-units"||a==="peripherals")&&u||void 0,search:k||void 0})};return e.jsxs(e.Fragment,{children:[e.jsx(le,{title:`Room - ${s.room_name}`}),e.jsxs("div",{className:"flex h-screen overflow-hidden",children:[e.jsx("div",{className:"hidden md:flex",children:e.jsx(O,{room:s,active:a,user:h.user,onSelect:n=>{window.location.href=route("faculty.room.show",{roomPath:s.room_path,section:n})}})}),j&&e.jsxs("div",{className:"fixed inset-0 z-40 flex md:hidden",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:()=>t(!1)}),e.jsx("div",{className:"relative z-50 w-64 shadow-lg",style:{backgroundColor:"hsl(142,34%,51%)"},children:e.jsx(O,{room:s,active:a,user:h.user,onSelect:n=>{window.location.href=route("faculty.room.show",{roomPath:s.room_path,section:n}),t(!1)}})})]}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-y-auto bg-gray-50",children:[" ",e.jsxs("div",{className:"p-4 border-b md:hidden flex items-center justify-between shadow-sm",style:{backgroundColor:"hsl(142,34%,51%)"},children:[e.jsx(m,{variant:"outline",size:"icon",onClick:()=>t(!0),className:"bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",children:e.jsx(he,{className:"h-5 w-5"})}),e.jsx("h2",{className:"text-xl font-semibold text-white",children:s.room_name})]}),e.jsxs("div",{className:"p-5 max-w-full md:max-w-5xl lg:max-w-7xl mx-auto w-full",children:[" ",e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:a==="system-units"?"System Units":a==="peripherals"?"Peripherals":"Equipments"})}),e.jsxs("div",{className:"rounded-lg border overflow-hidden shadow-sm bg-white",children:[e.jsx("div",{className:"flex flex-col sm:flex-row gap-2 sm:justify-between sm:items-center p-4 border-b",children:e.jsxs("div",{className:"flex gap-2 items-center w-full sm:w-auto",children:[e.jsx(ve,{filters:{condition:N,unit_code:C,search:S},filterOptions:r,activeSection:a,onApplyFilters:B}),e.jsx(V,{placeholder:"Search...",value:S,onChange:n=>{const u=n.target.value;I(u),B(N,C,u)},className:`flex-1 min-w-0 sm:max-w-xs w-full 
                                            border-[hsl(142,34%,51%)] text-[hsl(142,34%,20%)] 
                                            focus:border-[hsl(142,34%,45%)] focus:ring-[hsl(142,34%,45%)] 
                                            placeholder:text-[hsl(142,34%,40%)]`})]})}),e.jsxs(ie,{className:"min-w-full divide-y divide-gray-200",children:[e.jsx(ne,{className:"bg-gray-50",children:e.jsxs(R,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] hover:bg-[hsl(142,34%,80%)] h-10",children:[e.jsx(b,{className:"w-20 text-center text-gray-600",children:"No"}),e.jsx(b,{className:"text-gray-600  whitespace-nowrap",children:a==="system-units"?"Unit Code":a==="peripherals"?"Peripheral Code":"Equipment Code"}),a!=="system-units"&&e.jsx(b,{className:"text-gray-600",children:"Type"}),e.jsx(b,{className:"text-gray-600",children:"Condition"}),e.jsx(b,{className:"text-gray-600",children:"Actions"})]})}),e.jsx(re,{className:"divide-y divide-gray-200",children:A.length>0?A.map((n,u)=>(console.log("Equipment item:",n),e.jsxs(R,{children:[e.jsx(g,{className:"text-center",children:(y-1)*v+u+1}),e.jsx(g,{className:"font-medium text-gray-900 whitespace-nowrap",children:n.name}),a!=="system-units"&&e.jsx(g,{className:"text-gray-700",children:n.type}),e.jsx(g,{children:e.jsx(Ne,{condition:n.condition})}),e.jsxs(g,{className:"flex gap-2 py-3",children:[a==="system-units"&&e.jsx(F,{href:route("faculty.units.show",{room:s.id,unit:n.id}),children:e.jsxs(m,{size:"sm",variant:"outline",className:"flex items-center gap-1 text-[hsl(142,34%,51%)] border-[hsl(142,34%,51%)] hover:bg-[hsl(142,34%,51%)] hover:text-white",children:[e.jsx(E,{className:"h-4 w-4"})," View"]})}),a==="peripherals"&&e.jsx(F,{href:route("faculty.peripherals.show",{room:s.id,peripheral:n.id}),children:e.jsxs(m,{size:"sm",variant:"outline",className:"flex items-center gap-1 text-[hsl(142,34%,51%)] border-[hsl(142,34%,51%)] hover:bg-[hsl(142,34%,51%)] hover:text-white",children:[e.jsx(E,{className:"h-4 w-4"})," View"]})}),a==="equipments"&&(console.log("Room ID:",s.id,"Equipment ID:",n.id),e.jsx(F,{href:route("faculty.equipments.show",{room:s.id,equipment:n.id}),children:e.jsxs(m,{size:"sm",variant:"outline",className:"flex items-center gap-1 text-[hsl(142,34%,51%)] border-[hsl(142,34%,51%)] hover:bg-[hsl(142,34%,51%)] hover:text-white",children:[e.jsx(E,{className:"h-4 w-4"})," View"]})})),e.jsxs(m,{size:"sm",variant:"outline",className:"flex items-center gap-1 text-[hsl(142,34%,51%)] border-[hsl(142,34%,51%)] hover:bg-[hsl(142,34%,45%)] hover:text-white",onClick:()=>{Z(n),M(!0)},children:[e.jsx(pe,{className:"h-4 w-4"})," Report"]})]})]},n.id))):e.jsx(R,{children:e.jsx(g,{colSpan:a==="system-units"?4:5,className:"text-center text-muted-foreground py-4",children:"No data found."})})})]}),U>1&&e.jsx("div",{className:"flex justify-end p-4 bg-gray-50",children:e.jsx(ye,{page:y,pageCount:U,onPageChange:H})})]})]})]})]})]}),f&&e.jsx(be,{open:f,onOpenChange:M,item:Y,section:a,room:s,onSuccess:()=>q(!0)}),e.jsx(we,{open:Q,onClose:()=>q(!1),message:"Report submitted successfully!"})]})}function Ne({condition:s}){if(!s)return null;const l=s.toLowerCase().trim();let i="bg-gray-100 text-gray-800";return l.includes("not working")||l.includes("broken")||l.includes("defect")?i="bg-red-100 text-red-800":l.includes("maint")||l.includes("pending")||l.includes("check")?i="bg-amber-100 text-amber-800":(l.includes("good")||l.includes("functional")||l==="working")&&(i="bg-green-100 text-green-800"),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold whitespace-nowrap ${i}`,children:s})}export{Xe as default};
