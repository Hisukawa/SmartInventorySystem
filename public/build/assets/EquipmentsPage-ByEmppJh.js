import{r as b,j as e,a as _,R as V}from"./app-Cxk4xgnO.js";import{B as m}from"./button-D8DgmfUf.js";import{A as $}from"./app-sidebar-WfMJ5o8s.js";import{S as z,a as L,b as M,c as D}from"./avatar-D09hftzg.js";import{I as O}from"./input-D5-AuAzh.js";import{N as W}from"./Notification-CNU9tY4j.js";import H from"./EditEquipmentPage-C4_DGR36.js";import{T as G,a as J,b as R,c as j,d as K,e as p}from"./table-B471uNb2.js";import{B as Q,a as U,b as X,c as q,d as Y}from"./breadcrumb-rRU8Uvzs.js";import{P as Z,a as ee,b as te}from"./popover-B7bXD5wn.js";import{S as y,a as v,b as w,c as C,d as c}from"./select-CDlmJfin.js";import{P as se}from"./printer-BIN8CkTQ.js";import{F as ne}from"./funnel-kzt1qLAE.js";import"./index-D0YTxB9N.js";import"./utils-CBfrqCZ4.js";import"./dropdown-menu-W3cW3YUK.js";import"./index-Dxhvzti6.js";import"./index-CxUMiuQD.js";import"./index-LQnm14NF.js";import"./createLucideIcon-CNVFR4Y9.js";import"./chevron-right-D5pmuSOI.js";import"./house-GkYC3MJM.js";import"./user-vW5Znz6d.js";import"./log-out-CQEaXG2-.js";import"./keyboard-CWCSx_Ec.js";import"./boxes-Cv6adew_.js";import"./users-BXmBG9Sh.js";import"./chevron-down-DkqMGi-d.js";import"./index-DDFofrqb.js";import"./index-DEpeWXlU.js";import"./index-DEBCuAIU.js";import"./bell-COHCNG5J.js";import"./dialog-BFHdW51A.js";import"./index-QFRfQxrk.js";const ie={Working:"bg-green-200 text-green-800","Not Working":"bg-red-200 text-red-800","Intermittent Issue":"bg-yellow-200 text-yellow-800","Needs Cleaning":"bg-blue-200 text-blue-800","For Replacement":"bg-orange-200 text-orange-800","For Disposal":"bg-gray-200 text-gray-800",Condemned:"bg-black text-white","Minor Damage":"bg-yellow-200 text-yellow-800","Needs Repair":"bg-red-200 text-red-800","Intermittent Connectivity":"bg-yellow-200 text-yellow-800","No Signal":"bg-red-200 text-red-800","Needs Configuration":"bg-blue-200 text-blue-800",Expired:"bg-red-300 text-red-900","Needs Refill":"bg-blue-200 text-blue-900",Rusting:"bg-orange-200 text-orange-900"};function re({filters:a,filterOptions:u,onApplyFilters:g}){const[r,f]=b.useState(""),[i,d]=b.useState(""),l=s=>{const h=s==="all"?"":s;d(h),r==="type"?g({...a,type:h}):r==="condition"?g({...a,condition:h}):r==="room"&&g({...a,room_id:h})},N=()=>{f(""),d(""),g({type:"",condition:"",room_id:""})};return e.jsxs(Z,{children:[e.jsx(ee,{asChild:!0,children:e.jsxs(m,{className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",children:[e.jsx(ne,{className:"h-4 w-4"})," ","Filters"]})}),e.jsx(te,{className:"w-72",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(y,{value:r,onValueChange:s=>{f(s),d("")},children:[e.jsx(v,{children:e.jsx(w,{placeholder:"Select filter field"})}),e.jsxs(C,{children:[e.jsx(c,{value:"type",children:"Type"}),e.jsx(c,{value:"condition",children:"Condition"}),e.jsx(c,{value:"room",children:"Room"})]})]}),r==="type"&&e.jsxs(y,{value:i||"all",onValueChange:l,children:[e.jsx(v,{children:e.jsx(w,{placeholder:"Select Type"})}),e.jsxs(C,{children:[e.jsx(c,{value:"all",children:"All"}),u.types.map(s=>e.jsx(c,{value:s,children:s},s))]})]}),r==="condition"&&e.jsxs(y,{value:i||"all",onValueChange:l,children:[e.jsx(v,{children:e.jsx(w,{placeholder:"Select Condition"})}),e.jsxs(C,{children:[e.jsx(c,{value:"all",children:"All"}),u.conditions.map(s=>e.jsx(c,{value:s,children:s},s))]})]}),r==="room"&&e.jsxs(y,{value:i||"all",onValueChange:l,children:[e.jsx(v,{children:e.jsx(w,{placeholder:"Select Room"})}),e.jsxs(C,{children:[e.jsx(c,{value:"all",children:"All"}),Object.entries(u.rooms).map(([s,h])=>e.jsxs(c,{value:s,children:["Room ",h]},s))]})]}),(r||i)&&e.jsx("div",{className:"flex justify-end",children:e.jsx(m,{size:"sm",variant:"outline",onClick:N,className:"flex items-center gap-1 text-red-600 hover:bg-red-50",children:"Reset"})})]})})]})}function Le({equipments:a,existingRooms:u,filters:g={}}){const[r,f]=b.useState(""),[i,d]=b.useState(1),[l,N]=b.useState({}),s=10,h=b.useMemo(()=>{const t=n=>[...new Set(n.filter(Boolean))].sort();return{types:t(a.map(n=>n.type)),conditions:t(a.map(n=>n.condition)),rooms:Object.fromEntries(u.map(n=>[String(n.id),n.room_number]))}},[a,u]),[T,P]=b.useState({open:!1,equipmentCode:null}),x=a.filter(t=>{const n=t.equipment_code.toLowerCase().includes(r.toLowerCase())||t.equipment_name.toLowerCase().includes(r.toLowerCase()),o=!l.type||t.type===l.type,E=!l.condition||t.condition===l.condition,F=!l.room||t.room?.id===parseInt(l.room);return n&&o&&E&&F}),S=Math.ceil(x.length/s)||1,k=x.slice((i-1)*s,i*s),A=()=>{if(!x||x.length===0){alert("No data available to print.");return}const t=window.open("","","width=900,height=700"),n=x.map((o,E)=>`
            <tr>
                <td>${E+1}</td>
                <td>${o.equipment_code}</td>
                <td>${o.equipment_name}</td>
                <td>${o.room?.room_number??"N/A"}</td>
                <td>${o.type}</td>
                <td>${o.condition??"N/A"}</td>
            </tr>
        `).join("");t.document.write(`
            <html>
                <head>
                    <title>Equipment Report</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 20px; }
                        h2 { text-align: center; margin-bottom: 20px; color: #2e7d32; }
                        p { text-align: right; font-size: 12px; color: #666; }
                        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
                        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; font-size: 13px; }
                        th { background-color: #2e7d32; color: white; }
                        tr:nth-child(even) { background-color: #f9f9f9; }
                        @media print { body { -webkit-print-color-adjust: exact; } }
                    </style>
                </head>
                <body>
                    <h2>Equipment Report</h2>
                    <p>Generated on: ${new Date().toLocaleString()}</p>
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Equipment Code</th>
                                <th>Equipment Name</th>
                                <th>Room</th>
                                <th>Type</th>
                                <th>Condition</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${n}
                        </tbody>
                    </table>
                </body>
            </html>
        `),t.document.close(),t.print()},I=t=>{N(t),d(1)},B=()=>{N({}),d(1)};return e.jsxs(z,{children:[e.jsx($,{}),T.open&&e.jsx(H,{equipment:a.find(t=>t.equipment_code===T.equipmentCode),rooms:u,onClose:()=>P({open:!1,equipmentCode:null})}),e.jsxs(L,{children:[e.jsxs("header",{className:"sticky top-0 z-20 bg-white border-b px-6 py-3 flex items-center gap-2",children:[e.jsx(M,{}),e.jsx(D,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(Q,{children:e.jsx(U,{children:e.jsxs(X,{children:[e.jsx(q,{href:"#",children:"Assets"}),e.jsx(Y,{}),e.jsx(q,{href:"/equipments",className:"font-semibold text-foreground",children:"Equipments"})]})})}),e.jsx("div",{className:"flex-1"}),e.jsx(W,{})]}),e.jsxs("main",{className:"w-full px-6 py-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-5",children:"Equipments"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2 items-center flex-1",children:[e.jsx(O,{placeholder:"Search Equipment...",value:r,onChange:t=>f(t.target.value),className:"flex-1 min-w-0 sm:max-w-xs w-full border-[hsl(142,34%,51%)]"}),e.jsx(re,{filters:l,filterOptions:h,onApplyFilters:I,onReset:B}),e.jsxs(m,{onClick:A,className:"flex items-center gap-2 bg-[hsl(183,40%,45%)] text-white border-none hover:bg-[hsl(183,40%,38%)]",children:[e.jsx(se,{className:"h-4 w-4"}),"Print"]})]}),e.jsx(m,{className:"bg-[hsl(142,31%,51%)] hover:bg-[hsl(142,31%,45%)] text-white",onClick:()=>_.visit("/equipments/addequipment"),children:"Add Equipment"})]}),e.jsxs("div",{className:"overflow-x-auto rounded-lg border",children:[e.jsxs(G,{children:[e.jsx(J,{children:e.jsxs(R,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] hover:bg-[hsl(142,34%,80%)]",children:[e.jsx(j,{children:"#"}),e.jsx(j,{children:"Equipment Code"}),e.jsx(j,{children:"Equipment Name"}),e.jsx(j,{children:"Room"}),e.jsx(j,{children:"Type"}),e.jsx(j,{children:"Condition"}),e.jsx(j,{className:"text-center",children:"Actions"})]})}),e.jsx(K,{children:k.length>0?k.map((t,n)=>e.jsxs(R,{children:[e.jsx(p,{children:(i-1)*s+n+1}),e.jsx(p,{children:t.equipment_code}),e.jsx(p,{children:t.equipment_name}),e.jsx(p,{children:t.room?.room_number??"N/A"}),e.jsx(p,{children:t.type}),e.jsx(p,{children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ie[t.condition]||"bg-gray-200 text-gray-800"}`,children:t.condition})}),e.jsxs(p,{className:"text-center flex gap-2 justify-center",children:[e.jsx(m,{size:"sm",className:"bg-[hsl(142,34%,51%)] text-white",onClick:()=>_.visit(`/admin/equipments/${t.equipment_code}`),children:"View"}),e.jsx(m,{size:"sm",className:"bg-[hsl(142,34%,51%)] text-white",onClick:()=>P({open:!0,equipmentCode:t.equipment_code}),children:"Edit"})]})]},t.id)):e.jsx(R,{children:e.jsx(p,{colSpan:7,className:"text-center py-4",children:"No equipments found."})})})]}),e.jsxs("div",{className:"flex justify-between items-center p-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Showing"," ",x.length===0?0:(i-1)*s+1," ","â€“"," ",Math.min(i*s,x.length)," ","of ",x.length," equipments"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{size:"sm",variant:"outline",disabled:i===1,onClick:()=>d(i-1),children:"Previous"}),Array.from({length:S},(t,n)=>n+1).filter(t=>t===1||t===S?!0:t>=i-2&&t<=i+2).map((t,n,o)=>e.jsxs(V.Fragment,{children:[n>0&&o[n]-o[n-1]>1&&e.jsx("span",{className:"px-2",children:"..."}),e.jsx(m,{size:"sm",variant:i===t?"default":"outline",onClick:()=>d(t),children:t})]},t)),e.jsx(m,{size:"sm",variant:"outline",disabled:i===S,onClick:()=>d(i+1),children:"Next"})]})]})]})]})]})]})}export{Le as default};
