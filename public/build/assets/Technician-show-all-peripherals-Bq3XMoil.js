import{u as O,j as e,r as f,L as R,R as E,a as A}from"./app-H-wY-NW9.js";import{B as u}from"./button-DnnPw930.js";import{C as I,a as V}from"./card-CYpEJxXX.js";import{S as U,a as H,b as $,c as q}from"./index-BVsxLG7p.js";import{S as L}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{T as K,a as X,b as D,c as x,d as Y,e as h}from"./table-BajdndW5.js";import{B as G,a as J,b as Q,c as k,d as W}from"./breadcrumb-CRZExBcx.js";import{T as Z}from"./technician-app-sidebar-BW9zkWua.js";import{I as B}from"./input-XWYP2LjR.js";import{D as ee,a as ie,b as se,c as re}from"./dialog-DJyKN-o9.js";import{L as N}from"./label-BPLetJ3V.js";import{c as le}from"./createLucideIcon-CHwcNv2z.js";import{P as ne,a as ae,b as te,S as _,c as C,d as S,e as y,f as c}from"./select-CqNmYnJo.js";import{F as oe}from"./funnel-Bmq2PRQZ.js";import{X as ce}from"./index-BJkBXNhU.js";import"./index-Bnlh0LNp.js";import"./index-D0uq1nVa.js";import"./index-De6kIHHZ.js";import"./dropdown-menu-B5A3IWLs.js";import"./index-DwF3FW-u.js";import"./chevron-right-cOmDiQMH.js";import"./index-CHuEt-ae.js";import"./user-Cj0A8JBB.js";import"./send-8m-NC0oR.js";import"./index-Bdmhu-26.js";const z=[{label:"Functional",color:"bg-green-500"},{label:"Defective",color:"bg-red-500"},{label:"Under Maintenance",color:"bg-yellow-500"},{label:"Needs Upgrade",color:"bg-blue-500"},{label:"For Disposal",color:"bg-gray-500"}];function de({peripheral:n,rooms:d=[],units:o=[],onClose:m}){const{data:t,setData:j,put:s,processing:b,errors:a}=O({type:n?.type||"",serial_number:n?.serial_number||"",condition:n?.condition||"",room_id:n?.room_id||"",unit_id:n?.unit_id||""}),g=l=>{l.preventDefault(),s(route("peripherals.update",n.id),{onSuccess:()=>m()})},v=l=>{const T=z.find(w=>w.label.toLowerCase()===l.toLowerCase());return T?T.color:"bg-gray-300"};return e.jsx(ee,{open:!0,onOpenChange:l=>!l&&m(),children:e.jsxs(ie,{className:"max-w-lg",children:[e.jsx(se,{children:e.jsxs(re,{children:["Edit Peripheral â€“ ",n?.peripheral_code]})}),e.jsxs("form",{onSubmit:g,className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx(N,{htmlFor:"type",children:"Type"}),e.jsx(B,{id:"type",value:t.type,onChange:l=>j("type",l.target.value),placeholder:"e.g. Keyboard, Mouse, Monitor"}),a.type&&e.jsx("p",{className:"text-sm text-red-500",children:a.type})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"serial_number",children:"Serial Number"}),e.jsx(B,{id:"serial_number",value:t.serial_number,onChange:l=>j("serial_number",l.target.value),placeholder:"Serial Number"}),a.serial_number&&e.jsx("p",{className:"text-sm text-red-500",children:a.serial_number})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"condition",children:"Condition"}),e.jsx(B,{id:"condition",list:"condition-options",value:t.condition,onChange:l=>j("condition",l.target.value),placeholder:"Type or select"}),e.jsx("datalist",{id:"condition-options",children:z.map(l=>e.jsx("option",{value:l.label},l.label))}),t.condition&&e.jsxs("div",{className:"mt-1 text-sm flex items-center gap-2",children:[e.jsx("span",{className:le("inline-block w-3 h-3 rounded-full",v(t.condition))}),e.jsx("span",{className:"capitalize",children:t.condition})]}),a.condition&&e.jsx("p",{className:"text-sm text-red-500",children:a.condition})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"room_id",children:"Room"}),e.jsxs("select",{id:"room_id",className:"w-full border rounded-md p-2",value:t.room_id,onChange:l=>j("room_id",l.target.value),children:[e.jsx("option",{value:"",children:"Select Room"}),d.length>0?d.map(l=>e.jsx("option",{value:l.id,children:l.room_number},l.id)):e.jsx("option",{disabled:!0,children:"No rooms available"})]}),a.room_id&&e.jsx("p",{className:"text-sm text-red-500",children:a.room_id})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"unit_id",children:"Unit"}),e.jsxs("select",{id:"unit_id",className:"w-full border rounded-md p-2",value:t.unit_id,onChange:l=>j("unit_id",l.target.value),children:[e.jsx("option",{value:"",children:"Select Unit"}),o.length>0?o.map(l=>e.jsx("option",{value:l.id,children:l.unit_code},l.id)):e.jsx("option",{disabled:!0,children:"No units available"})]}),a.unit_id&&e.jsx("p",{className:"text-sm text-red-500",children:a.unit_id})]}),e.jsx(u,{type:"submit",disabled:b,children:"Update"})]})]})})}function he({filters:n,filterOptions:d,onApplyFilters:o}){const[m,t]=f.useState(""),j=()=>{const s={type:void 0,condition:void 0,room_id:void 0,unit_code:void 0};t(""),o(s)};return e.jsxs(ne,{children:[e.jsx(ae,{asChild:!0,children:e.jsxs(u,{variant:"outline",size:"sm",children:[e.jsx(oe,{className:"mr-2 h-4 w-4"}),"Filters"]})}),e.jsx(te,{className:"w-72",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(_,{value:m,onValueChange:t,children:[e.jsx(C,{children:e.jsx(S,{placeholder:"Select filter field"})}),e.jsxs(y,{children:[e.jsx(c,{value:"type",children:"Type"}),e.jsx(c,{value:"condition",children:"Condition"}),e.jsx(c,{value:"room",children:"Room"}),e.jsx(c,{value:"unit",children:"Unit"})]})]}),m==="type"&&e.jsxs(_,{value:n.type||"all",onValueChange:s=>o({...n,type:s==="all"?void 0:s}),children:[e.jsx(C,{children:e.jsx(S,{placeholder:"Select Type"})}),e.jsxs(y,{children:[e.jsx(c,{value:"all",children:"All"}),d.types.map(s=>e.jsx(c,{value:s,children:s},s))]})]}),m==="condition"&&e.jsxs(_,{value:n.condition||"all",onValueChange:s=>o({...n,condition:s==="all"?void 0:s}),children:[e.jsx(C,{children:e.jsx(S,{placeholder:"Select Condition"})}),e.jsxs(y,{children:[e.jsx(c,{value:"all",children:"All"}),d.conditions.map(s=>e.jsx(c,{value:s,children:s},s))]})]}),m==="room"&&e.jsxs(_,{value:n.room_id||"all",onValueChange:s=>o({...n,room_id:s==="all"?void 0:s}),children:[e.jsx(C,{children:e.jsx(S,{placeholder:"Select Room"})}),e.jsxs(y,{children:[e.jsx(c,{value:"all",children:"All"}),Object.entries(d.rooms).map(([s,b])=>e.jsxs(c,{value:s,children:["Room ",b]},s))]})]}),m==="unit"&&e.jsxs(_,{value:n.unit_code||"all",onValueChange:s=>o({...n,unit_code:s==="all"?void 0:s}),children:[e.jsx(C,{children:e.jsx(S,{placeholder:"Select Unit"})}),e.jsxs(y,{children:[e.jsx(c,{value:"all",children:"All"}),d.units.map(s=>e.jsx(c,{value:s,children:s},s))]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(u,{size:"sm",variant:"outline",onClick:j,className:"flex items-center gap-1",children:[e.jsx(ce,{className:"h-4 w-4"}),"Reset All"]})})]})})]})}function Me({peripherals:n,existingRooms:d,existingUnits:o,filters:m={}}){const[t,j]=f.useState(""),[s,b]=f.useState(null),[a,g]=f.useState(1),v=10,l=f.useMemo(()=>{const i=r=>[...new Set(r.filter(p=>p))].sort();return{types:i(n.map(r=>r.type)),conditions:i(n.map(r=>r.condition)),rooms:Object.fromEntries(d.map(r=>[String(r.id),r.room_number])),units:i(o.map(r=>r.unit_code))}},[n,d,o]);function T(i){const r=Object.fromEntries(Object.entries({...i,search:t||void 0}).filter(([,p])=>p!==""&&p!==void 0));A.get("/technician/peripherals",r,{preserveState:!0,replace:!0})}const w=f.useMemo(()=>{if(!t)return n;const i=t.toLowerCase();return n.filter(r=>[r.peripheral_code,r.type,r.serial_number,r.condition,r.room?.room_number,r.unit?.unit_code].filter(Boolean).some(p=>p.toLowerCase().includes(i)))},[n,t]),P=Math.ceil(w.length/v)||1,F=w.slice((a-1)*v,a*v);function M(i){L.fire({title:"Are you sure?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(r=>{r.isConfirmed&&A.delete(`/technician/peripherals/${i}`,{onSuccess:()=>{L.fire({icon:"success",title:"Deleted!",text:"Peripheral deleted successfully.",timer:2e3,showConfirmButton:!1})}})})}return e.jsxs(U,{children:[e.jsx(Z,{}),e.jsxs(H,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx($,{}),e.jsx(q,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(G,{children:e.jsx(J,{children:e.jsxs(Q,{children:[e.jsx(k,{href:"/technician/dashboard",children:"Dashboard"}),e.jsx(W,{}),e.jsx(k,{href:"/technician/peripherals","aria-current":"page",className:"font-semibold text-foreground",children:"Peripherals"})]})})}),e.jsx("div",{className:"flex-1"})]}),e.jsx("main",{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-5",children:"Technician Peripherals"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(he,{filters:m,filterOptions:l,onApplyFilters:T}),e.jsx(B,{placeholder:"Search peripherals...",value:t,onChange:i=>j(i.target.value),className:"w-64"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(R,{href:"/technician/peripherals/create",children:e.jsx(u,{children:"Add Peripheral"})})})]}),e.jsx(I,{children:e.jsxs(V,{children:[e.jsxs(K,{children:[e.jsx(X,{children:e.jsxs(D,{children:[e.jsx(x,{children:"#"}),e.jsx(x,{children:"Peripheral Code"}),e.jsx(x,{children:"Type"}),e.jsx(x,{children:"Brand"}),e.jsx(x,{children:"Model"}),e.jsx(x,{children:"Serial Number"}),e.jsx(x,{children:"Condition"}),e.jsx(x,{children:"Room"}),e.jsx(x,{children:"Unit"}),e.jsx(x,{children:"Actions"})]})}),e.jsx(Y,{children:F.length>0?F.map((i,r)=>e.jsxs(D,{children:[e.jsx(h,{children:(a-1)*v+r+1}),e.jsx(h,{children:i.peripheral_code}),e.jsx(h,{children:i.type}),e.jsx(h,{children:i.brand}),e.jsx(h,{children:i.model}),e.jsx(h,{children:i.serial_number}),e.jsx(h,{children:i.condition}),e.jsx(h,{children:i.room?`ROOM ${i.room.room_number}`:"N/A"}),e.jsx(h,{children:i.unit?i.unit.unit_code:"N/A"}),e.jsxs(h,{className:"space-x-2",children:[e.jsx(R,{href:`/technician/peripherals/${i.id}`,children:e.jsx(u,{variant:"secondary",size:"sm",children:"View"})}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>b(i),children:"Edit"}),e.jsx(u,{variant:"destructive",size:"sm",onClick:()=>M(i.id),children:"Delete"})]})]},i.id)):e.jsx(D,{children:e.jsx(h,{colSpan:"10",className:"text-center",children:"No peripherals found."})})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",a," of ",P]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{size:"sm",variant:"outline",disabled:a===1,onClick:()=>g(a-1),children:"Previous"}),Array.from({length:P},(i,r)=>r+1).filter(i=>i===1||i===P?!0:i>=a-2&&i<=a+2).map((i,r,p)=>e.jsxs(E.Fragment,{children:[r>0&&p[r]-p[r-1]>1&&e.jsx("span",{className:"px-2",children:"..."}),e.jsx(u,{size:"sm",variant:a===i?"default":"outline",onClick:()=>g(i),children:i})]},i)),e.jsx(u,{size:"sm",variant:"outline",disabled:a===P,onClick:()=>g(a+1),children:"Next"})]})]})]})})]})}),s&&e.jsx(de,{peripheral:s,rooms:d,units:o,onClose:()=>b(null)})]})]})}export{Me as default};
