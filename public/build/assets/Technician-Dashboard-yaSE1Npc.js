import{r as a,b as $,j as e,H as z,L as W,c as r}from"./app-Crct80nB.js";import{S as G,a as J,b as Q,c as Z}from"./avatar-BqIOA7QH.js";import{N as ee}from"./Notification-DOqtSOZu.js";import{T as se}from"./technician-app-sidebar-DwLw3dMF.js";import{B as te}from"./button-BACzVAEj.js";import{B as ae,a as ie,b as ne,c as re}from"./breadcrumb-DAOojRFA.js";import{C as o,b as c,c as l,a as m,e as oe}from"./card-CDOw9Q-b.js";import{u as ce,C as le,a as de,A as y,b as me}from"./react-spring_web.modern-EOU_0_2P.js";import{B as he}from"./building-BrgkY5pR.js";import{M as xe}from"./mouse-DB3yDBQS.js";import{M as pe}from"./monitor-CIxZ7jNX.js";import{U as v}from"./users-C7esEiTG.js";import{R as C,P as ue,a as je,C as fe,T as w,L as R,B as ge,X as be,Y as Ne,b as ye}from"./PieChart-BYvlTIiZ.js";import"./createLucideIcon-DYMRfB8D.js";import"./index-DJo5stHD.js";import"./index-Dwwnyi0w.js";import"./input-DREcaZlN.js";import"./index-6V1UTZru.js";import"./index-Dk2P25WT.js";import"./dropdown-menu-B4q-gSvj.js";import"./index-TsitP4aO.js";import"./chevron-right-tSBBmTOG.js";import"./index-B7luQ79V.js";import"./index-8X6kV6xy.js";import"./user-D29P_uZy.js";import"./with-selector-Dglyu-GD.js";function ze(){const[i,S]=a.useState({totalRooms:0,totalSystemUnits:0,totalPeripherals:0,totalEquipments:0,occupiedRooms:0,pendingRequests:0,forRepair:0}),{auth:k}=$().props,A=k.user,[h,D]=a.useState([]),[j,B]=a.useState({details:[]}),[f,F]=a.useState({system_units:{},peripherals:{},equipments:{}}),[q,L]=a.useState([]),[_,T]=a.useState([]),[O,E]=a.useState([]),[x,P]=a.useState(!1),d=j.details?j.details.filter(s=>s.is_active):[],I=x?d:d.slice(0,2),g=async()=>{try{const s=await r.get("/technician/dashboard-stats");S(s.data);const t=await r.get("/technician/activity-logs");D(t.data);const p=await r.get("/technician/rooms-status");B(p.data);const K=await r.get("/technician/equipment-condition");F(K.data);const u=await r.get("/technician/equipment-condition-by-room");if(L(u.data),u.data.length>0){const X=Object.keys(u.data[0]).filter(Y=>Y!=="room");T(X)}const V=await r.get("/technician/notifications");E(V.data)}catch(s){console.error("Error fetching dashboard data:",s)}};a.useEffect(()=>{g();const s=setInterval(g,5e3);return()=>clearInterval(s)},[]);const n=s=>ce({val:s,from:{val:0}}),M=s=>e.jsx(me.p,{className:"text-lg font-bold text-black",children:s.val.to(t=>Math.floor(t))}),U=[{title:"Total Rooms",value:n(i.totalRooms),icon:he,link:"/technician/rooms"},{title:"Computers",value:n(i.totalSystemUnits),icon:le,link:"/technician/units"},{title:"Peripherals",value:n(i.totalPeripherals),icon:xe,link:"/technician/peripherals"},{title:"Room Equipments",value:n(i.totalEquipments),icon:pe,link:"/technician/equipments"},{title:"Occupied Rooms",value:n(i.occupiedRooms),icon:v,link:"/technician/monitoring"},{title:"Pending Requests",value:n(i.pendingRequests),icon:de,link:"/technician/maintenance-requests"},{title:"For Repair",value:n(i.forRepair),icon:y,link:"/technician/repairs"}],H={Functional:"#16a34a",Defective:"#dc2626","Needs Maintenance":"#facc15"},b=["#16a34a","#facc15","#dc2626","#3b82f6","#9333ea"],N=s=>Object.entries(s).map(([t,p])=>({name:t,value:p}));return e.jsxs(G,{children:[e.jsx(z,{children:e.jsx("title",{children:"Technician Dashboard"})}),e.jsx(se,{}),e.jsxs(J,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx(Q,{}),e.jsx(Z,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(ae,{children:e.jsx(ie,{children:e.jsx(ne,{children:e.jsx(re,{href:"#","aria-current":"page",children:"Technician Dashboard"})})})}),e.jsx("div",{className:"flex-1"}),e.jsx(ee,{notifications:O})]}),e.jsxs("main",{className:"w-full px-6 py-6 space-y-6",children:[e.jsxs("div",{className:"relative rounded-2xl bg-gradient-to-r from-[#A8D5BA] via-[#7FCF9E] to-[#59AC77] p-6 text-white shadow-lg",children:[e.jsxs("h1",{className:"text-3xl font-bold",children:["Welcome back, ",A.name.split(" ")[0],"."]}),e.jsx("p",{className:"text-sm opacity-90 mt-1",children:"Hereâ€™s a summary of your ICT inventory system."})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4",children:U.map((s,t)=>e.jsx(W,{href:s.link,className:"block",children:e.jsxs(o,{className:"rounded-xl shadow-sm bg-white hover:shadow-md transition-all duration-300 cursor-pointer p-3",children:[e.jsx(c,{className:"flex flex-row items-center justify-between space-y-0 pb-1",children:e.jsxs(l,{className:"text-xs font-medium flex items-center gap-1 text-gray-500",children:[e.jsx(s.icon,{className:"h-4 w-4 text-[hsl(142,34%,51%)]"}),s.title]})}),e.jsx(m,{children:M(s.value)})]})},t))}),e.jsxs("div",{className:"lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(o,{className:"rounded-2xl shadow-md bg-white",children:[e.jsx(c,{children:e.jsxs(l,{className:"flex items-center gap-2 text-[#2F4F2F]",children:[e.jsx(v,{className:"w-5 h-5 text-[#59AC77]"}),"Active Room Occupancy"]})}),e.jsx("div",{className:"space-y-6 p-4",children:d.length===0?e.jsx("p",{className:"text-[#3B5C47] text-sm text-center",children:"No active rooms right now"}):I.map(s=>e.jsxs("div",{className:"flex items-center gap-6 border-b pb-6 last:border-b-0",children:[e.jsx("img",{src:s.faculty_photo?`/storage/${s.faculty_photo}`:"/default-avatar.png",alt:"Faculty",className:"w-16 h-16 rounded-full object-cover border-4 border-[#59AC77]"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-base font-semibold text-[#2F4F2F]",children:["Room"," ",s.room_number]}),e.jsxs("p",{className:"text-sm text-[#3B5C47]",children:["Scanned by"," ",e.jsx("span",{className:"font-medium text-[#2F4F2F]",children:s.last_scanned_by??"Unknown"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:s.last_scanned_at?new Date(s.last_scanned_at).toLocaleString():"No scan time"})]})]},s.id))}),d.length>2&&e.jsx(oe,{className:"flex justify-center",children:e.jsx(te,{variant:"outline",size:"sm",onClick:()=>P(!x),children:x?"Show Less":"View All Active Rooms"})})]}),e.jsxs(o,{children:[e.jsx(c,{children:e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(y,{className:"w-5 h-5 text-green-600"}),"Recent Activity"]})}),e.jsx(m,{children:e.jsx("ul",{className:"space-y-3 max-h-72 overflow-y-auto",children:Array.isArray(h)&&h.length>0?h.map((s,t)=>e.jsxs("li",{className:"text-sm border-b pb-2",children:[e.jsx("span",{className:"font-semibold",children:s.user?.name??"Unknown"})," ",s.action,e.jsx("span",{className:"block text-xs text-gray-500",children:s.timestamp})]},t)):e.jsx("li",{className:"text-gray-500",children:"No activity logs found"})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(o,{children:[e.jsx(c,{children:e.jsx(l,{children:"Equipment Condition"})}),e.jsx(m,{className:"h-[300px]",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(ue,{children:[e.jsx(je,{data:N(f.equipments),cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,dataKey:"value",label:!0,children:N(f.equipments).map((s,t)=>e.jsx(fe,{fill:H[s.name]||"#3b82f6"},`cell-${t}`))}),e.jsx(w,{}),e.jsx(R,{})]})})})]}),e.jsxs(o,{children:[e.jsx(c,{children:e.jsx(l,{children:"Condition by Room"})}),e.jsx(m,{className:"h-[300px]",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(ge,{data:q,children:[e.jsx(be,{dataKey:"room"}),e.jsx(Ne,{}),e.jsx(w,{}),e.jsx(R,{}),_.map((s,t)=>e.jsx(ye,{dataKey:s,stackId:"a",fill:b[t%b.length]},s))]})})})]})]})]})]})]})}export{ze as default};
