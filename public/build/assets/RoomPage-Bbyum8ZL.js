import{r as i,u as M,j as e,a as b,t as j}from"./app-CIxngH2t.js";import{Q as I}from"./index-C1x7YuOa.js";import{S as w}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{N as de}from"./Notification-C4OoZ_Oi.js";import{T as O,a as me,b as $,c as m,d as xe,e as x}from"./table-M_yLBUp3.js";import{B as r}from"./button-BFvGhadS.js";import{I as N}from"./input-DManFQ7U.js";import{D as q,a as A,b as he,c as Q}from"./dialog-DnO16M-r.js";import{A as pe}from"./app-sidebar-TxmIQpNq.js";import{B as ue,a as fe,b as ge,c as be}from"./breadcrumb-B1P8QziX.js";import{S as je,a as we,b as Ne,c as ve}from"./avatar-xFeH_w7N.js";import{E as ye}from"./eye-CoENliEM.js";import{P as Se}from"./pen-CIkMaa9s.js";import{T as Ce}from"./trash-2-CI-aPkjE.js";import{l as d,E as Re}from"./menu-CYhxIXsv.js";import"./bell-C9RdCnvy.js";import"./createLucideIcon-kaK51N8a.js";import"./utils-CBfrqCZ4.js";import"./index-DDZVC9IK.js";import"./index-C6sLlfRe.js";import"./index-DlOAqtH9.js";import"./index-ClaXtwUM.js";import"./dropdown-menu-DL5U53KD.js";import"./index-CZkxrXvq.js";import"./chevron-right-BOKQDKyq.js";import"./house-D2_SFSTh.js";import"./user-3v319SG3.js";import"./log-out-CBq2Kel4.js";import"./keyboard-kKNY3ToI.js";import"./boxes-B_7WoMxP.js";import"./users-DtY84DgZ.js";import"./chevron-down-Bed7q4eH.js";import"./index-i3tvLUQG.js";import"./index-DYWZgTXF.js";import"./portal-D5R59IOw.js";import"./open-closed-CawmUEw_.js";import"./with-selector-BheaUk8E.js";function pt({rooms:s,search:L}){const[v,P]=i.useState(L||""),[y,S]=i.useState(!1),[H,h]=i.useState(!1),[U,V]=i.useState(null),[p,C]=i.useState(""),[u,R]=i.useState(""),[F,_]=i.useState(!1),[k,_e]=i.useState(""),{data:K,setData:X,post:Y,reset:G,processing:J,errors:z}=M({room_number:""}),{data:W,setData:T,put:Z,processing:ee,errors:E,reset:te}=M({room_number:""}),se=t=>{t.preventDefault(),Y("/admin/rooms",{preserveScroll:!0,onSuccess:()=>{G(),j.success("Room Added",{description:"The room has been added successfully!",duration:2e3})},onError:a=>{a.room_number?j.error("Room already exists!",{description:a.room_number,duration:2500}):j.error("Error",{description:"Something went wrong. Please check your inputs.",duration:2500})}})},ae=t=>{t.preventDefault(),Z(`/admin/rooms/${U.id}`,{preserveScroll:!0,onSuccess:()=>{h(!1),te(),w.fire({icon:"success",title:"Room updated!",showConfirmButton:!1,timer:1500})}})},D=t=>{V(t),T("room_number",t.room_number),h(!0)},re=t=>{t.key==="Enter"&&b.get("/admin/rooms",{search:v})},le=(t,a)=>{t&&(C(t),R(a))},ie=()=>{const t=document.getElementById("qr-download"),o=new XMLSerializer().serializeToString(t),l=new Blob([o],{type:"image/svg+xml;charset=utf-8"}),ne=URL.createObjectURL(l),f=new Image;f.onload=()=>{const n=document.createElement("canvas"),c=n.getContext("2d");n.width=220,n.height=260,c.fillStyle="#fff",c.fillRect(0,0,n.width,n.height),c.drawImage(f,10,10,200,200),c.fillStyle="#000",c.font="bold 16px sans-serif",c.textAlign="center",c.fillText(`ROOM ${u}`,n.width/2,235);const ce=n.toDataURL("image/png"),g=document.createElement("a");g.href=ce,g.download=`room-${u}-qr.png`,g.click()},f.src=ne},oe=async()=>{await navigator.clipboard.writeText(p),_(!0),setTimeout(()=>_(!1),2e3)},B=t=>{w.fire({title:"Are you sure?",text:"This room will be permanently deleted.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(a=>{a.isConfirmed&&b.delete(`/admin/rooms/${t}`,{preserveScroll:!0,onSuccess:()=>{w.fire({icon:"success",title:"Deleted!",text:"The room has been deleted.",timer:1500,showConfirmButton:!1})}})})};return e.jsxs(je,{children:[e.jsx(pe,{}),e.jsxs(we,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx(Ne,{}),e.jsx(ve,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(ue,{className:"",children:e.jsx(fe,{children:e.jsx(ge,{children:e.jsx(be,{href:"/admin/rooms","aria-current":"page",className:"font-semibold text-foreground",children:"Room Lists"})})})}),e.jsx("div",{className:"flex-1"}),e.jsx(de,{})]}),e.jsxs("main",{className:"w-full px-6 py-4 overflow-y-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h1",{className:"text-xl font-bold",children:"Room Management"})}),k&&e.jsx("div",{className:"mb-4 p-3 bg-green-100 text-green-800 rounded shadow text-sm",children:k}),e.jsx(q,{open:H,onOpenChange:h,children:e.jsxs(A,{children:[e.jsx(he,{children:e.jsx(Q,{children:"Edit Room"})}),e.jsxs("form",{onSubmit:ae,className:"space-y-4",children:[e.jsx(N,{placeholder:"e.g. 101",value:W.room_number,onChange:t=>T("room_number",t.target.value)}),E.room_number&&e.jsx("p",{className:"text-sm text-red-500",children:E.room_number}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(r,{type:"button",variant:"outline",onClick:()=>h(!1),children:"Cancel"}),e.jsx(r,{type:"submit",disabled:ee,children:"Update"})]})]})]})}),e.jsxs("div",{className:"flex transition-all duration-700 ease-in-out relative",children:[e.jsxs("div",{className:`flex-1 transition-all duration-700 ease-in-out ${y?"mr-[400px] sm:mr-[500px]":"mr-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 gap-2",children:[e.jsx(N,{placeholder:"Search rooms...",value:v,onChange:t=>P(t.target.value),onKeyDown:re,className:"w-full sm:w-1/3"}),e.jsx(r,{onClick:()=>S(!0),className:"bg-[hsl(142,31%,51%)] hover:bg-[hsl(142,91%,18%)] text-white font-medium",children:"Add Room"})]}),e.jsxs("div",{className:"rounded-xl border shadow-sm overflow-hidden transition-all duration-500",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsx(O,{className:"min-w-full table-auto sm:table-fixed",children:e.jsx(me,{children:e.jsxs($,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] border-b border-[hsl(142,34%,75%)]",children:[e.jsx(m,{className:"font-semibold sticky top-0 bg-[hsl(142,34%,85%)] z-20 py-3 text-center align-middle",children:"#"}),e.jsx(m,{className:"font-semibold sticky top-0 bg-[hsl(142,34%,85%)] z-20 py-3 text-center align-middle",children:"Room Name"}),e.jsx(m,{className:"font-semibold sticky top-0 bg-[hsl(142,34%,85%)] z-20 py-3 text-center align-middle",children:"Room Code"}),e.jsx(m,{className:"font-semibold sticky top-0 bg-[hsl(142,34%,85%)] z-20 py-3 text-center align-middle",children:"QR Code"}),e.jsx(m,{className:"font-semibold sticky top-0 bg-[hsl(142,34%,85%)] z-20 py-3 text-center align-middle",children:"Actions"})]})})})}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto overflow-x-auto",children:e.jsx(O,{className:"min-w-full table-auto sm:table-fixed",children:e.jsx(xe,{children:s.data.map((t,a)=>{const o=typeof t.room_path=="string"?`${window.location.origin}/room/${t.room_path}`:null;return e.jsxs($,{className:"hover:bg-[hsl(142,34%,96%)] transition-all border-b last:border-0",children:[e.jsx(x,{className:"py-4 font-medium text-gray-700 text-center align-middle",children:(s.current_page-1)*s.per_page+a+1}),e.jsx(x,{className:"py-4 font-medium text-center align-middle",children:`ROOM ${t.room_number}`}),e.jsx(x,{className:"py-4 text-gray-600 text-center align-middle break-words",children:t.room_path}),e.jsx(x,{className:"py-4 text-center align-middle",children:o?e.jsx("div",{className:"inline-block w-16 h-16 bg-white p-1 rounded cursor-pointer shadow-sm hover:shadow transition mx-auto",onClick:l=>{l.stopPropagation(),le(o,t.room_number)},children:e.jsx(I,{value:o,size:64})}):e.jsx("span",{className:"text-sm text-gray-500",children:"No QR"})}),e.jsx(x,{className:"py-4 text-center align-middle",children:e.jsxs("div",{className:"flex justify-center items-center",children:[e.jsxs("div",{className:"hidden sm:flex flex-wrap justify-center items-center gap-2",children:[e.jsxs(r,{size:"sm",className:"inline-flex items-center gap-2 py-1.5 px-3 bg-[hsl(142,34%,65%)] text-white border-none hover:bg-[hsl(142,34%,55%)]",onClick:()=>window.location.href="#",children:[e.jsx(ye,{className:"h-4 w-4"})," ","View"]}),e.jsxs(r,{size:"sm",className:"inline-flex items-center gap-2 py-1.5 px-3 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>D(t),children:[e.jsx(Se,{className:"h-4 w-4"})," ","Edit"]}),e.jsxs(r,{size:"sm",variant:"destructive",className:"inline-flex items-center gap-2 py-1.5 px-3 bg-[hsl(0,72%,51%)] text-white border-none hover:bg-[hsl(0,72%,45%)]",onClick:()=>B(t.id),children:[e.jsx(Ce,{className:"h-4 w-4"})," ","Delete"]})]}),e.jsx("div",{className:"sm:hidden relative",children:e.jsxs(d,{children:[e.jsx(d.Button,{className:"py-1.5 px-3 bg-[hsl(142,34%,51%)] text-white rounded inline-flex items-center justify-center",children:e.jsx(Re,{className:"h-4 w-4"})}),e.jsxs(d.Items,{className:"absolute right-0 mt-2 w-32 bg-white border rounded shadow-lg flex flex-col z-50",children:[e.jsx(d.Item,{children:({active:l})=>e.jsx("button",{className:`w-full text-left px-3 py-2 ${l?"bg-gray-100":""}`,onClick:()=>window.location.href="#",children:"View"})}),e.jsx(d.Item,{children:({active:l})=>e.jsx("button",{className:`w-full text-left px-3 py-2 ${l?"bg-gray-100":""}`,onClick:()=>D(t),children:"Edit"})}),e.jsx(d.Item,{children:({active:l})=>e.jsx("button",{className:`w-full text-left px-3 py-2 text-red-600 ${l?"bg-gray-100":""}`,onClick:()=>B(t.id),children:"Delete"})})]})]})})]})})]},t.id)})})})}),e.jsxs("div",{className:"mt-3 px-3 py-2 flex flex-col sm:flex-row justify-between items-center gap-3 border-t",children:[e.jsxs("span",{className:"text-sm text-gray-600 text-center sm:text-left",children:["Showing"," ",s.data.length===0?0:(s.current_page-1)*s.per_page+1," ","–"," ",Math.min(s.current_page*s.per_page,s.total)," ","of ",s.total," rooms"]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:s.links.map((t,a)=>{const o=t.label.replace("&laquo;","«").replace("&raquo;","»");return e.jsx(r,{variant:t.active?"default":"outline",size:"sm",className:`min-w-[36px] px-3 py-1 ${t.active?"bg-[hsl(142,34%,45%)] text-white hover:bg-[hsl(142,91%,18%)]":"border-[hsl(142,34%,75%)] text-[hsl(142,34%,25%)] hover:bg-[hsl(142,34%,90%)]"}`,onClick:()=>t.url&&b.visit(t.url,{preserveState:!0,preserveScroll:!0}),disabled:!t.url,dangerouslySetInnerHTML:{__html:o}},a)})})]})]})]}),e.jsxs("div",{className:`fixed top-[56px] right-0 h-[calc(100vh-4rem)] w-[400px] sm:w-[500px] bg-white border-l shadow-lg z-40 p-4 overflow-y-auto transform transition-transform duration-700 ease-in-out ${y?"translate-x-0":"translate-x-full"}`,children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h2",{className:"text-lg font-semibold ",children:"Add Room"})}),e.jsxs("form",{onSubmit:se,className:"space-y-4",children:[e.jsx(N,{placeholder:"e.g. 101",value:K.room_number,onChange:t=>X("room_number",t.target.value)}),z.room_number&&e.jsx("p",{className:"text-sm text-red-500",children:z.room_number}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(r,{type:"button",variant:"outline",onClick:()=>S(!1),children:"Cancel"}),e.jsx(r,{type:"submit",disabled:J,className:"bg-[hsl(142,31%,51%)] hover:bg-[hsl(142,31%,45%)] text-white font-medium",children:"Save"})]})]})]})]}),e.jsx(q,{open:!!p,onOpenChange:()=>{C(""),R("")},children:e.jsxs(A,{className:"max-w-sm text-center",children:[e.jsxs(Q,{children:["ROOM ",u]}),e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"inline-block p-4 bg-white rounded cursor-pointer",onClick:t=>{t.stopPropagation(),oe()},children:[e.jsx(I,{id:"qr-download",value:p,size:200}),e.jsx("p",{className:"text-xs mt-2 text-muted-foreground",children:"Click QR to copy link"})]}),F&&e.jsx("p",{className:"text-green-600 text-sm text-center mt-1",children:"Copied to clipboard!"}),e.jsx(r,{className:"mt-4",onClick:ie,children:"Download QR"})]})]})})]})]})]})}export{pt as default};
