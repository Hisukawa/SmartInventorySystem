import{r as t,j as e,H as X,R as Y,c as C}from"./app-BXEL7I3D.js";import{S as Z,a as ee,b as se,c as te}from"./avatar-VePTvp79.js";import{A as ae}from"./app-sidebar-BkqBmsXw.js";import{N as re}from"./Notification-wuJ2Wxqe.js";import{C as L,b as I,c as P,a as T}from"./card-CsoS8_7x.js";import{B as ne,a as le,b as ie,c as oe}from"./breadcrumb-CwAhrUmb.js";import{B as ce}from"./badge-DmYdpVJF.js";import{T as de,f as me,a as xe,b as v,c as l,d as he,e as n}from"./table-CVIUJvmR.js";import{I as D}from"./input-DuaXU4SU.js";import{B as i}from"./button-CXIWFdOM.js";import{F as ue}from"./funnel-BYnnVyiB.js";import"./index-DZGxOCx4.js";import"./utils-CBfrqCZ4.js";import"./index-CXW272yM.js";import"./index-CJgs40Fr.js";import"./createLucideIcon-C4nke5B-.js";import"./index-DYsNqI6P.js";import"./dropdown-menu-B1e4DepK.js";import"./index-CaIAb45n.js";import"./chevron-right-C5dNCxl-.js";import"./index-C7R1yl_2.js";import"./index-DSoZh-_N.js";import"./house-ClUO6xOi.js";import"./user-Cg-2Q1EP.js";import"./log-out-DZCODJYO.js";import"./keyboard-BDnFpmg_.js";import"./boxes-Cqi7D-sc.js";import"./users-Cbm18cet.js";import"./chevron-down-D_3W57lQ.js";import"./bell-Bl3nIovA.js";function Qe({children:ge}){const[N,A]=t.useState([]),[x,H]=t.useState([]),[y,pe]=t.useState(1),[fe,F]=t.useState(1),[a,h]=t.useState(1),[u,R]=t.useState(1),[_,B]=t.useState(0),c=10,[g,k]=t.useState(""),[$,O]=t.useState([]),[M,z]=t.useState([]),[p,E]=t.useState(""),[f,U]=t.useState(""),[d,w]=t.useState(""),[j,q]=t.useState(!1),[o,G]=t.useState(new Date),S=async()=>{try{const s=await C.get(`/api/admin/rooms-status?page=${y}&per_page=${c}`);A(s.data.data),F(s.data.meta.total_pages)}catch(s){console.error("Failed to fetch rooms:",s)}},b=async()=>{try{const s=await C.get("/admin/faculty-logs",{params:{page:a,search:g,faculty_id:p,room_id:f,log_date:d}});H(s.data.logs.data||[]),R(s.data.logs.last_page||1),B(s.data.logs.total||0),s.data.facultyOptions&&O(s.data.facultyOptions),s.data.roomOptions&&z(s.data.roomOptions)}catch(s){console.error("Failed to fetch logs:",s)}};t.useEffect(()=>{S();const s=setInterval(S,5e3);return()=>clearInterval(s)},[y]),t.useEffect(()=>{b();const s=setInterval(b,5e3);return()=>clearInterval(s)},[a,g,p,f,d]),t.useEffect(()=>{const s=setInterval(()=>G(new Date),1e3);return()=>clearInterval(s)},[]);const J=o.getHours()%12||12,K=String(o.getMinutes()).padStart(2,"0"),Q=String(o.getSeconds()).padStart(2,"0"),V=o.getHours()>=12?"PM":"AM";return e.jsxs(Z,{children:[e.jsx(X,{children:e.jsx("title",{children:"Dashboard"})}),e.jsx(ae,{}),e.jsxs(ee,{children:[e.jsx("header",{className:"sticky top-0 z-20 bg-white border-b px-6 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{}),e.jsx(te,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(ne,{children:e.jsx(le,{children:e.jsx(ie,{children:e.jsx(oe,{href:"/admin/monitoring","aria-current":"page",className:"font-semibold text-foreground",children:"Monitoring"})})})}),e.jsx("div",{className:"flex-1"}),e.jsx(re,{})]})}),e.jsx("main",{className:"w-full px-6 py-4",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Room Monitoring"}),e.jsx("div",{className:"mb-6",children:e.jsxs("span",{className:"text-gray-800 text-3xl md:text-4xl font-bold",children:[o.toLocaleDateString("en-PH",{weekday:"long",year:"numeric",month:"long",day:"numeric"})," ","at ",J,":",K,":",Q," ",V]})}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4 mb-8",children:[N.length===0&&e.jsx("p",{className:"col-span-full text-center text-gray-500",children:"No rooms found."}),N.map(s=>e.jsxs(L,{className:`rounded-2xl transition-all duration-200 ease-in-out shadow-md
                                                hover:scale-[1.02] hover:shadow-lg
                                                ${s.is_active?"bg-[#59AC77] border border-green-700 text-white":"bg-[#59AC77] border border-gray-300 text-gray-900"}`,children:[e.jsxs(I,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(P,{className:`text-lg md:text-xl font-semibold ${s.is_active?"text-white":"text-gray-900"}`,children:s.name}),e.jsx(ce,{className:`px-3 py-1 text-xs font-medium rounded-full ${s.is_active?"bg-white text-green-700":"bg-gray-500 text-white"}`,children:s.is_active?"Active":"Inactive"})]}),e.jsx(T,{children:e.jsxs("div",{className:"flex items-center space-x-4",children:[s.is_active&&s.last_scanned_user?.photo?e.jsx("img",{src:s.last_scanned_user.photo,alt:s.last_scanned_user.name,className:"w-28 h-28 rounded-full object-cover border-4 border-green-500 shadow-md"}):e.jsx("div",{className:"w-28 h-28 rounded-full bg-gray-200 flex items-center justify-center text-gray-500 text-sm border-4 border-gray-300 shadow-md",children:"No Photo"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`font-medium ${s.is_active?"text-white":"text-gray-900"}`,children:s.is_active&&s.last_scanned_user?`${s.last_scanned_user.name} (${s.last_scanned_user.role})`:"No Faculty"}),e.jsx("span",{className:`text-xs ${s.is_active?"text-green-100":"text-gray-600"}`,children:s.is_active&&s.last_scanned_at?new Date(s.last_scanned_at).toLocaleString("en-PH",{hour12:!0}):"Not yet scanned"})]})]})})]},s.id))]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between w-full mb-4",children:[e.jsxs(i,{className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>q(!j),children:[e.jsx(ue,{className:"w-4 h-4"}),j?"Hide Filters":"Show Filters"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{type:"text",placeholder:"Search by faculty or room...",value:g,onChange:s=>k(s.target.value),className:"w-64"}),e.jsx(i,{onClick:b,className:"bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",children:"Search"})]})]}),j&&e.jsxs("div",{className:"flex flex-wrap gap-5 items-end",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1",children:"Users"}),e.jsxs("select",{value:p,onChange:s=>E(s.target.value),className:"h-9 w-44 px-2 py-1 text-sm border rounded-md focus:ring-2 focus:ring-[hsl(142,34%,51%)] focus:outline-none",children:[e.jsx("option",{value:"",children:"All"}),$.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1",children:"Room"}),e.jsxs("select",{value:f,onChange:s=>U(s.target.value),className:"h-9 w-44 px-2 py-1 text-sm border rounded-md focus:ring-2 focus:ring-[hsl(142,34%,51%)] focus:outline-none",children:[e.jsx("option",{value:"",children:"All"}),M.map(s=>e.jsx("option",{value:s.id,children:s.room_number},s.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm text-gray-600 mb-1",children:"Login Date"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{type:"date",value:d,onChange:s=>w(s.target.value),className:"h-9 w-44 text-sm border rounded-md focus:ring-2 focus:ring-[hsl(142,34%,51%)] focus:outline-none"}),d&&e.jsx(i,{variant:"outline",size:"sm",onClick:()=>w(""),className:"text-xs border-gray-300",children:"Clear"})]})]})]}),e.jsxs(L,{className:"shadow-md rounded-2xl",children:[e.jsx(I,{children:e.jsx(P,{children:"Users Logs History"})}),e.jsxs(T,{children:[e.jsxs(de,{children:[e.jsx(me,{children:"A list of recent faculty room logs."}),e.jsx(xe,{children:e.jsxs(v,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] hover:bg-[hsl(142,34%,80%)] h-10",children:[e.jsx(l,{children:"#"}),e.jsx(l,{children:"User"}),e.jsx(l,{children:"Role"}),e.jsx(l,{children:"Login Date"}),e.jsx(l,{children:"Logout Date"}),e.jsx(l,{children:"Room"})]})}),e.jsxs(he,{children:[x.length===0&&e.jsx(v,{children:e.jsx(n,{colSpan:6,className:"text-center text-gray-500",children:"No logs found."})}),x.map((s,r)=>{const m=s.created_at?new Date(s.created_at.replace(" ","T")).toLocaleString("en-PH",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"—",W=s.logged_out_at?new Date(s.logged_out_at.replace(" ","T")).toLocaleString("en-PH",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"";return e.jsxs(v,{children:[e.jsx(n,{children:r+1+(a-1)*c}),e.jsx(n,{children:s.faculty?.name??"N/A"}),e.jsx(n,{children:s.faculty?.role??"N/A"}),e.jsx(n,{children:m}),e.jsx(n,{children:W}),e.jsx(n,{children:s.room?.room_number??"N/A"})]},s.id)})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Showing"," ",x.length===0?0:(a-1)*c+1," ","–"," ",Math.min(a*c,_)," ","of ",_," Logs"]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(i,{size:"sm",variant:"outline",disabled:a===1,onClick:()=>h(s=>s-1),children:"Previous"}),Array.from({length:u},(s,r)=>r+1).filter(s=>s===1||s===u?!0:s>=a-2&&s<=a+2).map((s,r,m)=>e.jsxs(Y.Fragment,{children:[r>0&&m[r]-m[r-1]>1&&e.jsx("span",{className:"px-1",children:"..."}),e.jsx(i,{size:"sm",variant:a===s?"default":"outline",onClick:()=>h(s),children:s})]},s)),e.jsx(i,{size:"sm",variant:"outline",disabled:a===u,onClick:()=>h(s=>s+1),children:"Next"})]})]})]})]})]})]})})]})]})}export{Qe as default};
