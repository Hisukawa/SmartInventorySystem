import{r as b,j as e,a as v,R as I}from"./app-DYGDpCIH.js";import{B as a}from"./button-CztkhY-G.js";import{A as q}from"./app-sidebar-BpBnN1s4.js";import{S as z,a as B,b as V,c as D}from"./avatar-B38yOGTl.js";import{I as L}from"./input-B_VOLgHY.js";import{N as O}from"./Notification-CPP8kULl.js";import{T as M,a as H,b as E,c as u,d as G,e as p}from"./table-C820Ptr9.js";import{B as W,a as J,b as K,c as P,d as Q}from"./breadcrumb-BAK6O7ny.js";import{P as U,a as X,b as Y}from"./popover-DgVjP70X.js";import{S as N,a as w,b as C,c as S,d}from"./select-ChntdcWd.js";import{P as Z}from"./printer-CmxgcrMO.js";import{F as ee}from"./funnel-Dk3iLjV5.js";import"./index-BKCAjtkQ.js";import"./utils-CBfrqCZ4.js";import"./dropdown-menu-5oS-ClZz.js";import"./createLucideIcon-DODGpc7N.js";import"./index-Bx4uGs7M.js";import"./index-LIl8FtMf.js";import"./index-DsKeg3pu.js";import"./chevron-right-DAJ7KPWK.js";import"./user-CBYEx5V1.js";import"./keyboard-DPyuHUoq.js";import"./boxes-D1Xnz3D-.js";import"./users-D0ffsFk4.js";import"./chevron-down-D-HN1o17.js";import"./index-C0JT-rEO.js";import"./index-Din4PO50.js";import"./index-CjJ-Mxsd.js";import"./bell-Df_jNcyq.js";import"./index-DnQXQJPS.js";const te={Functional:"bg-green-200 text-green-800",Defective:"bg-red-200 text-red-800","Intermittent Issue":"bg-yellow-200 text-yellow-800","Needs Cleaning":"bg-blue-200 text-blue-800","For Replacement":"bg-orange-200 text-orange-800","For Disposal":"bg-gray-200 text-gray-800",Condemned:"bg-black text-white","Minor Damage":"bg-yellow-200 text-yellow-800","Needs Repair":"bg-red-200 text-red-800","Intermittent Connectivity":"bg-yellow-200 text-yellow-800","No Signal":"bg-red-200 text-red-800","Needs Configuration":"bg-blue-200 text-blue-800",Expired:"bg-red-300 text-red-900","Needs Refill":"bg-blue-200 text-blue-900",Rusting:"bg-orange-200 text-orange-900"};function se({filters:m,filterOptions:j,onApplyFilters:g}){const[n,f]=b.useState(""),[r,c]=b.useState(""),l=s=>{const h=s==="all"?"":s;c(h),n==="type"?g({...m,type:h}):n==="condition"?g({...m,condition:h}):n==="room"&&g({...m,room_id:h})},y=()=>{f(""),c(""),g({type:"",condition:"",room_id:""})};return e.jsxs(U,{children:[e.jsx(X,{asChild:!0,children:e.jsxs(a,{className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",children:[e.jsx(ee,{className:"h-4 w-4"})," ","Filters"]})}),e.jsx(Y,{className:"w-72",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(N,{value:n,onValueChange:s=>{f(s),c("")},children:[e.jsx(w,{children:e.jsx(C,{placeholder:"Select filter field"})}),e.jsxs(S,{children:[e.jsx(d,{value:"type",children:"Type"}),e.jsx(d,{value:"condition",children:"Condition"}),e.jsx(d,{value:"room",children:"Room"})]})]}),n==="type"&&e.jsxs(N,{value:r||"all",onValueChange:l,children:[e.jsx(w,{children:e.jsx(C,{placeholder:"Select Type"})}),e.jsxs(S,{children:[e.jsx(d,{value:"all",children:"All"}),j.types.map(s=>e.jsx(d,{value:s,children:s},s))]})]}),n==="condition"&&e.jsxs(N,{value:r||"all",onValueChange:l,children:[e.jsx(w,{children:e.jsx(C,{placeholder:"Select Condition"})}),e.jsxs(S,{children:[e.jsx(d,{value:"all",children:"All"}),j.conditions.map(s=>e.jsx(d,{value:s,children:s},s))]})]}),n==="room"&&e.jsxs(N,{value:r||"all",onValueChange:l,children:[e.jsx(w,{children:e.jsx(C,{placeholder:"Select Room"})}),e.jsxs(S,{children:[e.jsx(d,{value:"all",children:"All"}),Object.entries(j.rooms).map(([s,h])=>e.jsxs(d,{value:s,children:["Room ",h]},s))]})]}),(n||r)&&e.jsx("div",{className:"flex justify-end",children:e.jsx(a,{size:"sm",variant:"outline",onClick:y,className:"flex items-center gap-1 text-red-600 hover:bg-red-50",children:"Reset"})})]})})]})}function $e({equipments:m,existingRooms:j,filters:g={}}){const[n,f]=b.useState(""),[r,c]=b.useState(1),[l,y]=b.useState({}),s=10,h=b.useMemo(()=>{const t=i=>[...new Set(i.filter(Boolean))].sort();return{types:t(m.map(i=>i.type)),conditions:t(m.map(i=>i.condition)),rooms:Object.fromEntries(j.map(i=>[String(i.id),i.room_number]))}},[m,j]),x=m.filter(t=>{const i=t.equipment_code.toLowerCase().includes(n.toLowerCase())||t.equipment_name.toLowerCase().includes(n.toLowerCase()),o=!l.type||t.type===l.type,T=!l.condition||t.condition===l.condition,F=!l.room||t.room?.id===parseInt(l.room);return i&&o&&T&&F}),R=Math.ceil(x.length/s)||1,_=x.slice((r-1)*s,r*s),k=()=>{if(!x||x.length===0){alert("No data available to print.");return}const t=window.open("","","width=900,height=700"),i=x.map((o,T)=>`
            <tr>
                <td>${T+1}</td>
                <td>${o.equipment_code}</td>
                <td>${o.equipment_name}</td>
                <td>${o.room?.room_number??"N/A"}</td>
                <td>${o.type}</td>
                <td>${o.condition??"N/A"}</td>
            </tr>
        `).join("");t.document.write(`
            <html>
                <head>
                    <title>Equipment Report</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 20px; }
                        h2 { text-align: center; margin-bottom: 20px; color: #2e7d32; }
                        p { text-align: right; font-size: 12px; color: #666; }
                        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
                        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; font-size: 13px; }
                        th { background-color: #2e7d32; color: white; }
                        tr:nth-child(even) { background-color: #f9f9f9; }
                        @media print { body { -webkit-print-color-adjust: exact; } }
                    </style>
                </head>
                <body>
                    <h2>Equipment Report</h2>
                    <p>Generated on: ${new Date().toLocaleString()}</p>
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Equipment Code</th>
                                <th>Equipment Name</th>
                                <th>Room</th>
                                <th>Type</th>
                                <th>Condition</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${i}
                        </tbody>
                    </table>
                </body>
            </html>
        `),t.document.close(),t.print()},A=t=>{y(t),c(1)},$=()=>{y({}),c(1)};return e.jsxs(z,{children:[e.jsx(q,{}),e.jsxs(B,{children:[e.jsxs("header",{className:"sticky top-0 z-20 bg-white border-b px-6 py-3 flex items-center gap-2",children:[e.jsx(V,{}),e.jsx(D,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(W,{children:e.jsx(J,{children:e.jsxs(K,{children:[e.jsx(P,{href:"#",children:"Assets"}),e.jsx(Q,{}),e.jsx(P,{href:"/equipments",className:"font-semibold text-foreground",children:"Equipments"})]})})}),e.jsx("div",{className:"flex-1"}),e.jsx(O,{})]}),e.jsxs("main",{className:"w-full px-6 py-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-5",children:"Equipments"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2 items-center flex-1",children:[e.jsx(L,{placeholder:"Search Equipment...",value:n,onChange:t=>f(t.target.value),className:"flex-1 min-w-0 sm:max-w-xs w-full border-[hsl(142,34%,51%)]"}),e.jsx(se,{filters:l,filterOptions:h,onApplyFilters:A,onReset:$}),e.jsxs(a,{onClick:k,className:"flex items-center gap-2 bg-[hsl(183,40%,45%)] text-white border-none hover:bg-[hsl(183,40%,38%)]",children:[e.jsx(Z,{className:"h-4 w-4"}),"Print"]})]}),e.jsx(a,{className:"bg-[hsl(142,31%,51%)] hover:bg-[hsl(142,31%,45%)] text-white",onClick:()=>v.visit("/equipments/addequipment"),children:"Add Equipment"})]}),e.jsxs("div",{className:"overflow-x-auto rounded-lg border",children:[e.jsxs(M,{children:[e.jsx(H,{children:e.jsxs(E,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] hover:bg-[hsl(142,34%,80%)]",children:[e.jsx(u,{children:"#"}),e.jsx(u,{children:"Equipment Code"}),e.jsx(u,{children:"Equipment Name"}),e.jsx(u,{children:"Room"}),e.jsx(u,{children:"Type"}),e.jsx(u,{children:"Condition"}),e.jsx(u,{className:"text-center",children:"Actions"})]})}),e.jsx(G,{children:_.length>0?_.map((t,i)=>e.jsxs(E,{children:[e.jsx(p,{children:(r-1)*s+i+1}),e.jsx(p,{children:t.equipment_code}),e.jsx(p,{children:t.equipment_name}),e.jsx(p,{children:t.room?.room_number??"N/A"}),e.jsx(p,{children:t.type}),e.jsx(p,{children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${te[t.condition]||"bg-gray-200 text-gray-800"}`,children:t.condition})}),e.jsxs(p,{className:"text-center flex gap-2 justify-center",children:[e.jsx(a,{size:"sm",className:"bg-[hsl(142,34%,51%)] text-white",onClick:()=>v.visit(`/admin/equipments/${t.equipment_code}`),children:"View"}),e.jsx(a,{size:"sm",className:"bg-[hsl(142,34%,51%)] text-white",onClick:()=>v.visit(`/equipments/edit/${t.equipment_code}`),children:"Edit"}),e.jsx(a,{size:"sm",className:"bg-red-500 text-white",onClick:()=>{confirm(`Are you sure you want to delete ${t.equipment_name}?`)&&v.delete(`/equipments/${t.equipment_code}`,{preserveScroll:!0})},children:"Delete"})]})]},t.id)):e.jsx(E,{children:e.jsx(p,{colSpan:7,className:"text-center py-4",children:"No equipments found."})})})]}),e.jsxs("div",{className:"flex justify-between items-center p-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Showing"," ",x.length===0?0:(r-1)*s+1," ","â€“"," ",Math.min(r*s,x.length)," ","of ",x.length," equipments"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(a,{size:"sm",variant:"outline",disabled:r===1,onClick:()=>c(r-1),children:"Previous"}),Array.from({length:R},(t,i)=>i+1).filter(t=>t===1||t===R?!0:t>=r-2&&t<=r+2).map((t,i,o)=>e.jsxs(I.Fragment,{children:[i>0&&o[i]-o[i-1]>1&&e.jsx("span",{className:"px-2",children:"..."}),e.jsx(a,{size:"sm",variant:r===t?"default":"outline",onClick:()=>c(t),children:t})]},t)),e.jsx(a,{size:"sm",variant:"outline",disabled:r===R,onClick:()=>c(r+1),children:"Next"})]})]})]})]})]})]})}export{$e as default};
