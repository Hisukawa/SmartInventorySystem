import{r as j,j as e,a as R,R as L}from"./app-CyKXg9yc.js";import{B as m}from"./button-bkt5fBkN.js";import{A as D}from"./app-sidebar-B6WyFqYK.js";import{S as M,a as O,b as W,c as H}from"./avatar-C1gNw84X.js";import{I as G}from"./input-vTKYAFaX.js";import{N as J}from"./Notification-tK0TK0Kn.js";import K from"./EditEquipmentPage-CH2-i8By.js";import{T as Q,a as U,b as T,c as g,d as X,e as h}from"./table-SvC8Fu7K.js";import{B as Y,a as Z,b as ee,c as I,d as te}from"./breadcrumb-CH3ifJ5X.js";import{P as se,a as le,b as ie}from"./popover-CXofYc4T.js";import{S as w,a as v,b as C,c as S,d as c}from"./select-DKj_0w9a.js";import{P as ne}from"./printer-fcS9S0Qd.js";import{E as $}from"./eye-C92UZ5Be.js";import{P as A}from"./pen-DOVwrmLL.js";import{l as f,E as re}from"./menu-Bq35IGRn.js";import{F as ae}from"./funnel-BaSgZJX-.js";import"./index-cjdhKuD8.js";import"./utils-CBfrqCZ4.js";import"./dropdown-menu-CabchwOY.js";import"./index-CXDoVF6r.js";import"./index-BWpWyP_H.js";import"./index-5jbi07bB.js";import"./createLucideIcon-BLPxHd-5.js";import"./chevron-right-BzZBUWCH.js";import"./house-CVXFB2a_.js";import"./user-D9nAcC9K.js";import"./log-out-DMx0wB5w.js";import"./keyboard-DLSZJklx.js";import"./boxes-CTrMnO-P.js";import"./users-BWNN-IE-.js";import"./chevron-down-DXGQVhew.js";import"./index-BMH21eXj.js";import"./index-DJ_kx1uc.js";import"./index-BQY8eDvm.js";import"./bell-l-QYIAbM.js";import"./dialog-DyaBvGA0.js";import"./index-BHeEoOFm.js";import"./portal-1XcVbTGc.js";import"./open-closed-3e7SkQXB.js";import"./with-selector-pcTmm2lT.js";const oe={Working:"bg-green-200 text-green-800","Not Working":"bg-red-200 text-red-800","Intermittent Issue":"bg-yellow-200 text-yellow-800","Needs Cleaning":"bg-blue-200 text-blue-800","For Replacement":"bg-orange-200 text-orange-800","For Disposal":"bg-gray-200 text-gray-800",Condemned:"bg-black text-white","Minor Damage":"bg-yellow-200 text-yellow-800","Needs Repair":"bg-red-200 text-red-800","Intermittent Connectivity":"bg-yellow-200 text-yellow-800","No Signal":"bg-red-200 text-red-800","Needs Configuration":"bg-blue-200 text-blue-800",Expired:"bg-red-300 text-red-900","Needs Refill":"bg-blue-200 text-blue-900",Rusting:"bg-orange-200 text-orange-900","To Be Diagnosed":"bg-blue-100 text-blue-700"};function de({filters:o,filterOptions:u,onApplyFilters:b}){const[r,N]=j.useState(""),[i,d]=j.useState(""),a=s=>{const x=s==="all"?"":s;d(x),r==="type"?b({...o,type:x}):r==="condition"?b({...o,condition:x}):r==="room"&&b({...o,room_id:x})},y=()=>{N(""),d(""),b({type:"",condition:"",room_id:""})};return e.jsxs(se,{children:[e.jsx(le,{asChild:!0,children:e.jsxs(m,{className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",children:[e.jsx(ae,{className:"h-4 w-4"})," ","Filters"]})}),e.jsx(ie,{className:"w-72",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(w,{value:r,onValueChange:s=>{N(s),d("")},children:[e.jsx(v,{children:e.jsx(C,{placeholder:"Select filter field"})}),e.jsxs(S,{children:[e.jsx(c,{value:"type",children:"Type"}),e.jsx(c,{value:"condition",children:"Condition"}),e.jsx(c,{value:"room",children:"Room"})]})]}),r==="type"&&e.jsxs(w,{value:i||"all",onValueChange:a,children:[e.jsx(v,{children:e.jsx(C,{placeholder:"Select Type"})}),e.jsxs(S,{children:[e.jsx(c,{value:"all",children:"All"}),u.types.map(s=>e.jsx(c,{value:s,children:s},s))]})]}),r==="condition"&&e.jsxs(w,{value:i||"all",onValueChange:a,children:[e.jsx(v,{children:e.jsx(C,{placeholder:"Select Condition"})}),e.jsxs(S,{children:[e.jsx(c,{value:"all",children:"All"}),u.conditions.map(s=>e.jsx(c,{value:s,children:s},s))]})]}),r==="room"&&e.jsxs(w,{value:i||"all",onValueChange:a,children:[e.jsx(v,{children:e.jsx(C,{placeholder:"Select Room"})}),e.jsxs(S,{children:[e.jsx(c,{value:"all",children:"All"}),Object.entries(u.rooms).map(([s,x])=>e.jsxs(c,{value:s,children:["Room ",x]},s))]})]}),(r||i)&&e.jsx("div",{className:"flex justify-end",children:e.jsx(m,{size:"sm",variant:"outline",onClick:y,className:"flex items-center gap-1 text-red-600 hover:bg-red-50",children:"Reset"})})]})})]})}function Ue({equipments:o,existingRooms:u,filters:b={}}){const[r,N]=j.useState(""),[i,d]=j.useState(1),[a,y]=j.useState({}),s=10,x=j.useMemo(()=>{const t=l=>[...new Set(l.filter(Boolean))].sort();return{types:t(o.map(l=>l.type)),conditions:t(o.map(l=>l.condition)),rooms:Object.fromEntries(u.map(l=>[String(l.id),l.room_number]))}},[o,u]),[_,E]=j.useState({open:!1,equipmentCode:null}),p=o.filter(t=>{const l=t.equipment_code.toLowerCase().includes(r.toLowerCase())||t.equipment_name.toLowerCase().includes(r.toLowerCase()),n=!a.type||t.type===a.type,P=!a.condition||t.condition===a.condition,F=!a.room||t.room?.id===parseInt(a.room);return l&&n&&P&&F}),k=Math.ceil(p.length/s)||1,q=p.slice((i-1)*s,i*s),B=()=>{if(!p||p.length===0){alert("No data available to print.");return}const t=window.open("","","width=900,height=700"),l=p.map((n,P)=>`
            <tr>
                <td>${P+1}</td>
                <td>${n.equipment_code}</td>
                <td>${n.equipment_name}</td>
                <td>${n.room?.room_number??"N/A"}</td>
                <td>${n.type}</td>
                <td>${n.condition??"N/A"}</td>
            </tr>
        `).join("");t.document.write(`
            <html>
                <head>
                    <title>Equipment Report</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 20px; }
                        h2 { text-align: center; margin-bottom: 20px; color: #2e7d32; }
                        p { text-align: right; font-size: 12px; color: #666; }
                        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
                        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; font-size: 13px; }
                        th { background-color: #2e7d32; color: white; }
                        tr:nth-child(even) { background-color: #f9f9f9; }
                        @media print { body { -webkit-print-color-adjust: exact; } }
                    </style>
                </head>
                <body>
                    <h2>Equipment Report</h2>
                    <p>Generated on: ${new Date().toLocaleString()}</p>
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Equipment Code</th>
                                <th>Equipment Name</th>
                                <th>Room</th>
                                <th>Type</th>
                                <th>Condition</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${l}
                        </tbody>
                    </table>
                </body>
            </html>
        `),t.document.close(),t.print()},V=t=>{y(t),d(1)},z=()=>{y({}),d(1)};return e.jsxs(M,{children:[e.jsx(D,{}),_.open&&e.jsx(K,{equipment:o.find(t=>t.equipment_code===_.equipmentCode),rooms:u,onClose:()=>E({open:!1,equipmentCode:null})}),e.jsxs(O,{children:[e.jsxs("header",{className:"sticky top-0 z-20 bg-white border-b px-6 py-3 flex items-center gap-2",children:[e.jsx(W,{}),e.jsx(H,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(Y,{children:e.jsx(Z,{children:e.jsxs(ee,{children:[e.jsx(I,{href:"#",children:"Assets"}),e.jsx(te,{}),e.jsx(I,{href:"/equipments",className:"font-semibold text-foreground",children:"Equipments"})]})})}),e.jsx("div",{className:"flex-1"}),e.jsx(J,{})]}),e.jsxs("main",{className:"w-full px-6 py-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-5",children:"Equipments"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2 items-center flex-1",children:[e.jsx(G,{placeholder:"Search Equipment...",value:r,onChange:t=>N(t.target.value),className:"flex-1 min-w-0 sm:max-w-xs w-full border-[hsl(142,34%,51%)]"}),e.jsx(de,{filters:a,filterOptions:x,onApplyFilters:V,onReset:z}),e.jsxs(m,{onClick:B,className:"flex items-center gap-2 bg-[hsl(183,40%,45%)] text-white border-none hover:bg-[hsl(183,40%,38%)]",children:[e.jsx(ne,{className:"h-4 w-4"}),"Print"]})]}),e.jsx(m,{className:"bg-[hsl(142,31%,51%)] hover:bg-[hsl(142,31%,45%)] text-white",onClick:()=>R.visit("/equipments/addequipment"),children:"Add Equipment"})]}),e.jsxs("div",{className:"overflow-x-auto rounded-lg border",children:[e.jsxs(Q,{className:"w-full table-auto text-center",children:[e.jsx(U,{children:e.jsxs(T,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] hover:bg-[hsl(142,34%,80%)]",children:[e.jsx(g,{className:"px-5 py-1 text-center",children:"#"}),e.jsx(g,{className:"px-5 py-1 text-center",children:"Equipment Code"}),e.jsx(g,{className:"px-5 py-1 text-center",children:"Equipment Name"}),e.jsx(g,{className:"px-5 py-1 text-center",children:"Room"}),e.jsx(g,{className:"px-5 py-1 text-center",children:"Type"}),e.jsx(g,{className:"px-5 py-1 text-center",children:"Condition"}),e.jsx(g,{className:"px-5 py-1 text-center",children:"Actions"})]})}),e.jsx(X,{children:q.length>0?q.map((t,l)=>e.jsxs(T,{className:"hover:shadow-sm",children:[e.jsx(h,{className:"px-5 py-2 align-middle",children:(i-1)*s+l+1}),e.jsx(h,{className:"px-5 py-2 align-middle",children:t.equipment_code}),e.jsx(h,{className:"px-5 py-2 align-middle",children:t.equipment_name}),e.jsx(h,{className:"px-5 py-2 align-middle",children:t.room?.room_number??"N/A"}),e.jsx(h,{className:"px-5 py-2 align-middle",children:t.type}),e.jsx(h,{className:"px-5 py-2 align-middle",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${oe[t.condition]||"bg-gray-200 text-gray-800"}`,children:t.condition})}),e.jsxs(h,{className:"px-5 py-2 align-middle",children:[e.jsxs("div",{className:"hidden sm:flex justify-center items-center gap-2",children:[e.jsxs(m,{size:"sm",className:"bg-[hsl(142,34%,51%)] text-white flex items-center gap-2",onClick:()=>R.visit(`/admin/equipments/${t.equipment_code}`),children:[e.jsx($,{className:"h-4 w-4"})," ","View"]}),e.jsxs(m,{size:"sm",className:"bg-[hsl(142,34%,51%)] text-white flex items-center gap-2",onClick:()=>E({open:!0,equipmentCode:t.equipment_code}),children:[e.jsx(A,{className:"h-4 w-4"})," ","Edit"]})]}),e.jsx("div",{className:"sm:hidden flex justify-center",children:e.jsxs(f,{as:"div",className:"relative inline-block text-left",children:[e.jsx(f.Button,{className:"p-2 rounded bg-[hsl(142,34%,51%)] text-white",children:e.jsx(re,{className:"h-5 w-5"})}),e.jsx(f.Items,{className:"absolute right-0 mt-2 w-28 origin-top-right bg-white border border-gray-200 divide-y divide-gray-100 rounded-md shadow-lg focus:outline-none z-50",children:e.jsxs("div",{className:"px-1 py-1",children:[e.jsx(f.Item,{children:({active:n})=>e.jsxs("button",{className:`${n?"bg-[hsl(142,34%,90%)]":""} group flex w-full items-center rounded-md px-2 py-2 text-sm text-gray-700`,onClick:()=>R.visit(`/admin/equipments/${t.equipment_code}`),children:[e.jsx($,{className:"h-4 w-4 mr-2"})," ","View"]})}),e.jsx(f.Item,{children:({active:n})=>e.jsxs("button",{className:`${n?"bg-[hsl(142,34%,90%)]":""} group flex w-full items-center rounded-md px-2 py-2 text-sm text-gray-700`,onClick:()=>E({open:!0,equipmentCode:t.equipment_code}),children:[e.jsx(A,{className:"h-4 w-4 mr-2"})," ","Edit"]})})]})})]})})]})]},t.id)):e.jsx(T,{children:e.jsx(h,{colSpan:7,className:"text-center py-4",children:"No equipments found."})})})]}),e.jsxs("div",{className:"flex justify-between items-center p-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Showing"," ",p.length===0?0:(i-1)*s+1," ","â€“"," ",Math.min(i*s,p.length)," ","of ",p.length," equipments"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{size:"sm",variant:"outline",disabled:i===1,onClick:()=>d(i-1),children:"Previous"}),Array.from({length:k},(t,l)=>l+1).filter(t=>t===1||t===k?!0:t>=i-2&&t<=i+2).map((t,l,n)=>e.jsxs(L.Fragment,{children:[l>0&&n[l]-n[l-1]>1&&e.jsx("span",{className:"px-2",children:"..."}),e.jsx(m,{size:"sm",variant:i===t?"default":"outline",onClick:()=>d(t),children:t})]},t)),e.jsx(m,{size:"sm",variant:"outline",disabled:i===k,onClick:()=>d(i+1),children:"Next"})]})]})]})]})]})]})}export{Ue as default};
