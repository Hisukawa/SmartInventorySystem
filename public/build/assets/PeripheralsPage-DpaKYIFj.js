import{r as u,j as e,L as k,b as P}from"./app-DXOZvHBx.js";import{B as c}from"./button-CRdu5se-.js";import{C as L,a as M}from"./card-Ccrm7Moe.js";import{S as D,a as F,b as O,c as U}from"./index-COh4Vgup.js";import{S as $}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{T as q,a as H,b as _,c as t,d as K,e as a}from"./table-Cq8kttzf.js";import{B as X,a as Y,b as G,c as z,d as J}from"./breadcrumb--aU8a1r6.js";import{A as Q}from"./app-sidebar-C2nfsN-i.js";import{I as W}from"./input-DzWgoppG.js";import Z from"./EditPeripheralModal-DCLt44xq.js";import{P as ee,a as re,b as se,S as f,c as v,d as b,e as S,f as n}from"./select-Db8Z7DEG.js";import{F as ie}from"./funnel-DWF8FpWz.js";import{X as le}from"./index-BokiuFv0.js";import"./index-BwmGJl-D.js";import"./index-0A75X7ns.js";import"./index-Bv5oG7aC.js";import"./dropdown-menu-CzxmIm0M.js";import"./index-DEm5J0Sz.js";import"./chevron-right-DQPD3Yqi.js";import"./index-D5jp2t_A.js";import"./dialog-Cg7MTyXm.js";import"./label-CHrjsyar.js";import"./index-Chh7iyBq.js";function ne({filters:l,filterOptions:x,onApplyFilters:o}){const[h,p]=u.useState(""),m=()=>{const r={type:void 0,condition:void 0,room_id:void 0,unit_code:void 0};p(""),o(r)};return e.jsxs(ee,{children:[e.jsx(re,{asChild:!0,children:e.jsxs(c,{variant:"outline",size:"sm",children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"Filters"]})}),e.jsx(se,{className:"w-72",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(f,{value:h,onValueChange:p,children:[e.jsx(v,{children:e.jsx(b,{placeholder:"Select filter field"})}),e.jsxs(S,{children:[e.jsx(n,{value:"type",children:"Type"}),e.jsx(n,{value:"condition",children:"Condition"}),e.jsx(n,{value:"room",children:"Room"}),e.jsx(n,{value:"unit",children:"Unit"})]})]}),h==="type"&&e.jsxs(f,{value:l.type||"all",onValueChange:r=>o({...l,type:r==="all"?void 0:r}),children:[e.jsx(v,{children:e.jsx(b,{placeholder:"Select Type"})}),e.jsxs(S,{children:[e.jsx(n,{value:"all",children:"All"}),x.types.map(r=>e.jsx(n,{value:r,children:r},r))]})]}),h==="condition"&&e.jsxs(f,{value:l.condition||"all",onValueChange:r=>o({...l,condition:r==="all"?void 0:r}),children:[e.jsx(v,{children:e.jsx(b,{placeholder:"Select Condition"})}),e.jsxs(S,{children:[e.jsx(n,{value:"all",children:"All"}),x.conditions.map(r=>e.jsx(n,{value:r,children:r},r))]})]}),h==="room"&&e.jsxs(f,{value:l.room_id||"all",onValueChange:r=>o({...l,room_id:r==="all"?void 0:r}),children:[e.jsx(v,{children:e.jsx(b,{placeholder:"Select Room"})}),e.jsxs(S,{children:[e.jsx(n,{value:"all",children:"All"}),Object.entries(x.rooms).map(([r,C])=>e.jsxs(n,{value:r,children:["Room ",C]},r))]})]}),h==="unit"&&e.jsxs(f,{value:l.unit_code||"all",onValueChange:r=>o({...l,unit_code:r==="all"?void 0:r}),children:[e.jsx(v,{children:e.jsx(b,{placeholder:"Select Unit"})}),e.jsxs(S,{children:[e.jsx(n,{value:"all",children:"All"}),x.units.map(r=>e.jsx(n,{value:r,children:r},r))]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(c,{size:"sm",variant:"outline",onClick:m,className:"flex items-center gap-1",children:[e.jsx(le,{className:"h-4 w-4"}),"Reset All"]})})]})})]})}function Be({peripherals:l,search:x,existingRooms:o,existingUnits:h,filters:p={}}){const[m,r]=u.useState(x||""),[C,y]=u.useState(null),[d,N]=u.useState(1),g=10,E=u.useMemo(()=>{const s=i=>[...new Set(i.filter(j=>j))].sort();return{types:s(l.map(i=>i.type)),conditions:s(l.map(i=>i.condition)),rooms:Object.fromEntries(o.map(i=>[String(i.id),i.room_number])),units:s(l.map(i=>i.unit_code))}},[l,o]);function T(s){const i=Object.fromEntries(Object.entries({...s,search:m||void 0}).filter(([,j])=>j!==""&&j!==void 0));P.get("/admin/peripherals",i,{preserveState:!0,replace:!0})}function R(){r(""),P.get("/admin/peripherals",{},{preserveState:!0,replace:!0})}const V=s=>{s.key==="Enter"&&T(p)},w=u.useMemo(()=>{if(!m)return l;const s=m.toLowerCase();return l.filter(i=>[i.peripheral_code,i.type,i.serial_number,i.condition,i.room?.room_number,i.unit_code].filter(Boolean).some(j=>j.toLowerCase().includes(s)))},[l,m]),B=Math.ceil(w.length/g)||1,A=w.slice((d-1)*g,d*g);function I(s){$.fire({title:"Are you sure?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(i=>{i.isConfirmed&&P.delete(`/admin/peripherals/${s}`)})}return e.jsxs(D,{children:[e.jsx(Q,{}),e.jsxs(F,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx(O,{}),e.jsx(U,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(X,{children:e.jsx(Y,{children:e.jsxs(G,{children:[e.jsx(z,{href:"#",children:"Assets"}),e.jsx(J,{}),e.jsx(z,{href:"/admin/peripherals","aria-current":"page",className:"font-semibold text-foreground",children:"Peripherals"})]})})})]}),e.jsx("main",{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-5",children:"Peripherals"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(ne,{filters:p,filterOptions:E,onApplyFilters:T,onReset:R}),e.jsx(W,{placeholder:"Search peripherals...",value:m,onChange:s=>r(s.target.value),onKeyDown:V,className:"w-64"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(k,{href:"/admin/peripherals/create",children:e.jsx(c,{children:"Add Peripheral"})})})]}),e.jsx(L,{children:e.jsxs(M,{children:[e.jsxs(q,{children:[e.jsx(H,{children:e.jsxs(_,{children:[e.jsx(t,{children:"#"}),e.jsx(t,{children:"Peripheral Code"}),e.jsx(t,{children:"Type"}),e.jsx(t,{children:"Brand"}),e.jsx(t,{children:"Model"}),e.jsx(t,{children:"Serial Number"}),e.jsx(t,{children:"Condition"}),e.jsx(t,{children:"Room"}),e.jsx(t,{children:"Units"}),e.jsx(t,{children:"Actions"})]})}),e.jsx(K,{children:A.length>0?A.map((s,i)=>e.jsxs(_,{children:[e.jsx(a,{children:(d-1)*g+i+1}),e.jsx(a,{children:s.peripheral_code}),e.jsx(a,{children:s.type}),e.jsx(a,{children:s.brand}),e.jsx(a,{children:s.model}),e.jsx(a,{children:s.serial_number}),e.jsx(a,{children:s.condition}),e.jsx(a,{children:s.room?`ROOM ${s.room.room_number}`:"N/A"}),e.jsx(a,{children:s.unit_code}),e.jsxs(a,{className:"space-x-2",children:[e.jsx(k,{href:`/admin/peripherals/${s.id}`,children:e.jsx(c,{variant:"secondary",size:"sm",children:"View"})}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>y(s),children:"Edit"}),e.jsx(c,{variant:"destructive",size:"sm",onClick:()=>I(s.id),children:"Delete"})]})]},s.id)):e.jsx(_,{children:e.jsx(a,{colSpan:"8",className:"text-center",children:"No peripherals found."})})})]}),e.jsxs("div",{className:"flex justify-center mt-4 space-x-2",children:[e.jsx(c,{variant:"outline",size:"sm",disabled:d===1,onClick:()=>N(d-1),children:"Previous"}),[...Array(B)].map((s,i)=>e.jsx(c,{variant:d===i+1?"default":"outline",size:"sm",onClick:()=>N(i+1),children:i+1},i)),e.jsx(c,{variant:"outline",size:"sm",disabled:d===B,onClick:()=>N(d+1),children:"Next"})]})]})})]})}),C&&e.jsx(Z,{peripheral:C,rooms:o,units:h,onClose:()=>y(null)})]})]})}export{Be as default};
