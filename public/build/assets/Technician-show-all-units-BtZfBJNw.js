import{b as Y,r as j,u as V,j as e,R as Z,a as O}from"./app-CsbQ2pYi.js";import{B as p}from"./button-IV10psch.js";import{T as J}from"./technician-app-sidebar-DzON8O9i.js";import{S as W,a as ee,b as se,c as re}from"./index-C0c8Dczd.js";import{c as P}from"./createLucideIcon-BLllQeE-.js";import{I as m}from"./input-CSN-pxIH.js";import{N as oe}from"./Notification-0C0N95cL.js";import{S as _}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{T as te,a as ae,b as D,c as v,d as ne,e as b}from"./table-CJZzyGJI.js";import{B as le,a as ie,b as ce,c as A,d as de}from"./breadcrumb-6hTWgkQQ.js";import{P as me,a as he,b as xe,S as M,c as B,d as E,e as I,f as U}from"./select-40c4XPNn.js";import{D as G,e as ue,a as $,b as Q,c as q}from"./dialog-DYgZQ7zV.js";import{L as N}from"./label-BRc-L42n.js";import{Q as pe}from"./index-ChhUNJ9y.js";import{F as je}from"./funnel-C6FjOQZe.js";import{X as k}from"./index-DGrvU1KL.js";import"./index-BozoQiq4.js";import"./index-n-dOUQgn.js";import"./chevron-right-DEyk4rbn.js";import"./dropdown-menu-DpOe7xsA.js";import"./index-BGTqIl3L.js";import"./index-CEbXihwT.js";import"./user-D7cGaDUu.js";import"./send-DNWg8p6r.js";import"./index-DZUIWO7d.js";import"./index-C-aiHKJr.js";const L=[{label:"Functional",color:"bg-green-500"},{label:"Defective",color:"bg-red-500"},{label:"Under Maintenance",color:"bg-yellow-500"},{label:"Needs Upgrade",color:"bg-blue-500"},{label:"For Disposal",color:"bg-gray-500"}];function ge(){const{rooms:n}=Y().props,[h,g]=j.useState(!1),{data:i,setData:c,post:d,processing:f,errors:r,reset:S}=V({unit_code:"",processor:"",ram:"",storage:"",gpu:"",motherboard:"",condition:"",room_id:""}),C=o=>{const w=L.find(F=>F.label.toLowerCase()===o.toLowerCase());return w?w.color:"bg-muted"},l=o=>{o.preventDefault(),d("/technician/units/create",{onSuccess:()=>{S(),g(!1),_.fire({title:"System Unit added successfully!",icon:"success",showConfirmButton:!1,timer:1500,customClass:{popup:"technician-success-message"}})},onError:w=>{_.fire({title:w.unit_code||"Error adding unit",icon:"error",showConfirmButton:!0,customClass:{popup:"technician-error-message"}})}})},[a,x]=j.useState("");return j.useEffect(()=>{const o=n.find(w=>`ROOM ${w.room_number}`.toLowerCase()===a.toLowerCase());o?c("room_id",o.id):c("room_id","")},[a]),e.jsxs(G,{open:h,onOpenChange:g,children:[e.jsx(ue,{asChild:!0,children:e.jsx(p,{children:"Add Unit"})}),e.jsxs($,{className:"sm:max-w-xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Q,{children:e.jsx(q,{children:"Add System Unit"})}),e.jsxs("form",{onSubmit:l,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(N,{htmlFor:"room_number",children:"Room"}),e.jsx(m,{id:"room_number",list:"room-options",value:a,onChange:o=>x(o.target.value),placeholder:"Search or select room"}),e.jsx("datalist",{id:"room-options",children:n.map(o=>e.jsx("option",{value:`ROOM ${o.room_number}`},o.id))}),r.room_id&&e.jsx("p",{className:"text-sm text-red-500",children:r.room_id})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"unit_code",children:"Pc Code"}),e.jsx(m,{id:"unit_code",name:"unit_code",value:i.unit_code,onChange:o=>c("unit_code",o.target.value),placeholder:"01",required:!0}),r.unit_code&&e.jsx("p",{className:"text-sm text-red-500",children:r.unit_code})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"processor",children:"Processor"}),e.jsx(m,{id:"processor",name:"processor",value:i.processor,onChange:o=>c("processor",o.target.value),placeholder:"Intel Core i5-10400"}),r.processor&&e.jsx("p",{className:"text-sm text-red-500",children:r.processor})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"ram",children:"RAM"}),e.jsx(m,{id:"ram",name:"ram",value:i.ram,onChange:o=>c("ram",o.target.value),placeholder:"16GB DDR5"}),r.ram&&e.jsx("p",{className:"text-sm text-red-500",children:r.ram})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"storage",children:"Storage"}),e.jsx(m,{id:"storage",name:"storage",value:i.storage,onChange:o=>c("storage",o.target.value),placeholder:"512GB NVME SATA SSD"}),r.storage&&e.jsx("p",{className:"text-sm text-red-500",children:r.storage})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"gpu",children:"GPU"}),e.jsx(m,{id:"gpu",name:"gpu",value:i.gpu,onChange:o=>c("gpu",o.target.value),placeholder:"NVIDIA GeForce RTX 5090"}),r.gpu&&e.jsx("p",{className:"text-sm text-red-500",children:r.gpu})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"motherboard",children:"Motherboard"}),e.jsx(m,{id:"motherboard",name:"motherboard",value:i.motherboard,onChange:o=>c("motherboard",o.target.value),placeholder:"ASUS ROG Maximus Z790 Dark Hero (Intel)"}),r.motherboard&&e.jsx("p",{className:"text-sm text-red-500",children:r.motherboard})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"condition",children:"Condition"}),e.jsx(m,{id:"condition",list:"condition-options",value:i.condition,onChange:o=>c("condition",o.target.value),placeholder:"Type or select Condition"}),e.jsx("datalist",{id:"condition-options",children:L.map(o=>e.jsx("option",{value:o.label},o.label))}),i.condition&&e.jsxs("div",{className:"mt-1 text-sm flex items-center gap-2",children:[e.jsx("span",{className:P("inline-block w-3 h-3 rounded-full",C(i.condition))}),e.jsx("span",{className:"capitalize",children:i.condition})]}),r.condition&&e.jsx("p",{className:"text-sm text-red-500",children:r.condition})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(p,{type:"submit",disabled:f,children:"Submit"})})]})]})]})}const z=[{label:"Functional",color:"bg-green-500"},{label:"Defective",color:"bg-red-500"},{label:"Under Maintenance",color:"bg-yellow-500"},{label:"Needs Upgrade",color:"bg-blue-500"},{label:"For Disposal",color:"bg-gray-500"}];function be({unit:n,rooms:h,onClose:g}){const{data:i,setData:c,put:d,processing:f,errors:r}=V({unit_code:n.unit_code,processor:n.processor,ram:n.ram,storage:n.storage,gpu:n.gpu,motherboard:n.motherboard,condition:n.condition,room_id:n.room_id}),S=l=>{l.preventDefault(),d(`/technician/units/${n.id}`,{onSuccess:()=>{g(),_.fire({title:"System Unit updated successfully!",icon:"success",showConfirmButton:!1,timer:1500,customClass:{popup:"technician-success-message"}})},onError:a=>{_.fire({title:"Error updating system unit",text:Object.values(a).join(`
`),icon:"error",showConfirmButton:!0,customClass:{popup:"technician-error-message"}})}})},C=l=>{const a=z.find(x=>x.label.toLowerCase()===l.toLowerCase());return a?a.color:"bg-gray-300"};return e.jsx(G,{open:!0,onOpenChange:l=>!l&&g(),children:e.jsxs($,{children:[e.jsx(Q,{children:e.jsxs(q,{children:["Edit ROOM -"," ",h.find(l=>l.id===n.room_id)?.room_number||"N/A"," ","- ",n.unit_code]})}),e.jsxs("form",{onSubmit:S,className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{value:i.unit_code,onChange:l=>c("unit_code",l.target.value),placeholder:"Unit Code"}),r.unit_code&&e.jsx("p",{className:"text-sm text-red-500",children:r.unit_code})]}),e.jsxs("div",{children:[e.jsx(m,{value:i.processor,onChange:l=>c("processor",l.target.value),placeholder:"Processor"}),r.processor&&e.jsx("p",{className:"text-sm text-red-500",children:r.processor})]}),e.jsxs("div",{children:[e.jsx(m,{value:i.ram,onChange:l=>c("ram",l.target.value),placeholder:"RAM"}),r.ram&&e.jsx("p",{className:"text-sm text-red-500",children:r.ram})]}),e.jsxs("div",{children:[e.jsx(m,{value:i.storage,onChange:l=>c("storage",l.target.value),placeholder:"Storage"}),r.storage&&e.jsx("p",{className:"text-sm text-red-500",children:r.storage})]}),e.jsxs("div",{children:[e.jsx(m,{value:i.gpu,onChange:l=>c("gpu",l.target.value),placeholder:"GPU"}),r.gpu&&e.jsx("p",{className:"text-sm text-red-500",children:r.gpu})]}),e.jsxs("div",{children:[e.jsx(m,{value:i.motherboard,onChange:l=>c("motherboard",l.target.value),placeholder:"Motherboard"}),r.motherboard&&e.jsx("p",{className:"text-sm text-red-500",children:r.motherboard})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"condition",children:"Condition"}),e.jsx(m,{id:"condition",list:"condition-options",value:i.condition,onChange:l=>c("condition",l.target.value),placeholder:"Type or select"}),e.jsx("datalist",{id:"condition-options",children:z.map(l=>e.jsx("option",{value:l.label},l.label))}),i.condition&&e.jsxs("div",{className:"mt-1 text-sm flex items-center gap-2",children:[e.jsx("span",{className:P("inline-block w-3 h-3 rounded-full",C(i.condition))}),e.jsx("span",{className:"capitalize",children:i.condition})]}),r.condition&&e.jsx("p",{className:"text-sm text-red-500",children:r.condition})]}),e.jsx(p,{type:"submit",disabled:f,children:"Update"})]})]})})}const fe=[{label:"Functional",color:"bg-green-500"},{label:"Defective",color:"bg-red-500"},{label:"Under Maintenance",color:"bg-yellow-500"},{label:"Needs Upgrade",color:"bg-blue-500"},{label:"For Disposal",color:"bg-gray-500"}];function ve({filters:n={},filterOptions:h,onApplyFilters:g,onReset:i}){const[c,d]=j.useState(""),[f,r]=j.useState("");j.useEffect(()=>{const x=["unit_code","room_id","processor","ram","storage","gpu","motherboard","condition"].find(o=>!!n[o]);x?(d(x),r(String(n[x]))):(d(""),r(""))},[n]);const S=[{value:"unit_code",label:"Unit Code"},{value:"room_id",label:"Room"},{value:"processor",label:"Processor"},{value:"ram",label:"RAM"},{value:"storage",label:"Storage"},{value:"gpu",label:"GPU"},{value:"motherboard",label:"Motherboard"},{value:"condition",label:"Condition"}];function C(a){const x=a==="all"?"":a;r(x);const o={...n};c&&(o[c]=x),g(o)}const l=Object.values(n).some(a=>!!a);return e.jsxs(me,{children:[e.jsx(he,{asChild:!0,children:e.jsxs(p,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-4 w-4"}),"Filter",l&&e.jsx(k,{className:"h-4 w-4 ml-1 cursor-pointer",onClick:a=>{a.stopPropagation(),d(""),r(""),i()}})]})}),e.jsxs(xe,{className:"w-[calc(100vw-2rem)] sm:w-[380px] p-4",children:[e.jsx("h4",{className:"font-medium mb-3 text-lg",children:"Filter Options"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs(M,{value:c,onValueChange:a=>{d(a),r("")},children:[e.jsx(B,{className:"w-full",children:e.jsx(E,{placeholder:"Select Field"})}),e.jsx(I,{children:S.map(a=>e.jsx(U,{value:a.value,children:a.label},a.value))})]}),c&&(h[c+"s"]||h[c])&&e.jsxs(M,{value:f||"all",onValueChange:C,children:[e.jsx(B,{className:"w-full",children:e.jsx(E,{placeholder:"Select Value"})}),e.jsxs(I,{children:[e.jsx(U,{value:"all",children:"All"}),Array.isArray(h[c+"s"])?h[c+"s"].map(a=>e.jsx(U,{value:a,children:a},a)):Object.entries(h[c]).map(([a,x])=>e.jsxs(U,{value:a,children:["Room ",x]},a))]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(p,{size:"sm",variant:"outline",onClick:()=>{d(""),r(""),i()},children:[e.jsx(k,{className:"mr-1 h-4 w-4"})," Reset"]})})]})]})]})}function He({units:n,rooms:h,filters:g={}}){const[i,c]=j.useState(g.search||""),[d,f]=j.useState(1),[r,S]=j.useState(null),[C,l]=j.useState(null),a=10,x=j.useMemo(()=>{const s=t=>[...new Set(t.filter(u=>u!==null&&u!==""))].sort();return{rooms:Object.fromEntries(h.map(t=>[String(t.id),t.room_number])),unit_codes:s(n.map(t=>t.unit_code)),processors:s(n.map(t=>t.processor)),rams:s(n.map(t=>t.ram)),storages:s(n.map(t=>t.storage)),gpus:s(n.map(t=>t.gpu)),motherboards:s(n.map(t=>t.motherboard)),conditions:s(n.map(t=>t.condition))}},[n,h]);function o(s){const t=Object.fromEntries(Object.entries({...s,search:i||void 0}).filter(([,u])=>u!==""&&u!==void 0));O.get("/technician/units",t,{preserveState:!0,replace:!0})}function w(){c(""),O.get("/technician/units",{},{preserveState:!0,replace:!0})}function F(s){s.key==="Enter"&&o(g)}const T=j.useMemo(()=>{if(!i)return n;const s=i.toLowerCase();return n.filter(t=>{const u=t.unit_code?.toLowerCase()||"",X=t.room?.room_number?.toLowerCase()||"";return u.includes(s)||X.includes(s)})},[n,i]),y=Math.ceil(T.length/a)||1,R=T.slice((d-1)*a,d*a),H=s=>{const t=fe.find(u=>u.label.toLowerCase()===(s||"").toLowerCase());return t?t.color:"bg-muted"},K=s=>{_.fire({title:"Are you sure?",text:"This action will permanently delete the system unit.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(t=>{t.isConfirmed&&O.delete(`/technician/units/${s}`,{onSuccess:()=>{_.fire({title:"Deleted!",text:"System unit has been deleted.",icon:"success",timer:1500,showConfirmButton:!1})},onError:u=>{_.fire({title:"Error!",text:"Failed to delete the system unit.",icon:"error"})}})})};return e.jsxs(W,{children:[e.jsx(J,{}),e.jsxs(ee,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx(se,{}),e.jsx(re,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(le,{children:e.jsx(ie,{children:e.jsxs(ce,{children:[e.jsx(A,{href:"/technician/dashboard",children:"Dashboard"}),e.jsx(de,{}),e.jsx(A,{href:"/technician/units","aria-current":"page",className:"font-semibold text-foreground",children:"System Units"})]})})})]}),e.jsxs("main",{className:"w-full px-6 py-4",children:[e.jsx(oe,{}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"System Units"}),e.jsx(ge,{rooms:h})]}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center justify-between mb-4",children:e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(ve,{filters:g,filterOptions:x,onApplyFilters:o,onReset:w}),e.jsx(m,{placeholder:"Search Unit Code or Room",value:i,onChange:s=>{c(s.target.value),f(1)},onKeyDown:F,className:"w-64"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(te,{children:[e.jsx(ae,{children:e.jsxs(D,{className:"h-10",children:[e.jsx(v,{children:"#"}),e.jsx(v,{children:"Pc Code"}),e.jsx(v,{children:"Room"}),e.jsx(v,{children:"Processor"}),e.jsx(v,{children:"RAM"}),e.jsx(v,{children:"Storage"}),e.jsx(v,{children:"GPU"}),e.jsx(v,{children:"Motherboard"}),e.jsx(v,{children:"Condition"}),e.jsx(v,{children:"Actions"})]})}),e.jsx(ne,{children:R.length>0?R.map((s,t)=>e.jsxs(D,{children:[e.jsx(b,{children:(d-1)*a+t+1}),e.jsx(b,{children:s.unit_code}),e.jsxs(b,{children:["ROOM ",s.room?.room_number||"N/A"]}),e.jsx(b,{children:s.processor}),e.jsx(b,{children:s.ram}),e.jsx(b,{children:s.storage}),e.jsx(b,{children:s.gpu}),e.jsx(b,{children:s.motherboard}),e.jsx(b,{children:s.condition&&e.jsxs("div",{className:"mt-1 text-sm flex items-center gap-2",children:[e.jsx("span",{className:P("inline-block w-3 h-3 rounded-full",H(s.condition))}),e.jsx("span",{className:"capitalize",children:s.condition})]})}),e.jsx(b,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{size:"sm",variant:"outline",onClick:()=>S(s),children:"Edit"}),e.jsx(p,{size:"sm",variant:"outline",onClick:()=>l(s),children:"QR"}),e.jsx(p,{size:"sm",variant:"destructive",onClick:()=>K(s.id),children:"Delete"})]})})]},s.id)):e.jsx(D,{children:e.jsx(b,{colSpan:10,className:"text-center py-4",children:"No matching units found."})})})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",d," of ",y]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(p,{size:"sm",variant:"outline",disabled:d===1,onClick:()=>f(s=>s-1),children:"Previous"}),Array.from({length:y},(s,t)=>t+1).filter(s=>s===1||s===y?!0:s>=d-2&&s<=d+2).map((s,t,u)=>e.jsxs(Z.Fragment,{children:[t>0&&u[t]-u[t-1]>1&&e.jsx("span",{className:"px-1",children:"..."}),e.jsx(p,{size:"sm",variant:d===s?"default":"outline",onClick:()=>f(s),children:s})]},s)),e.jsx(p,{size:"sm",variant:"outline",disabled:d===y,onClick:()=>f(s=>s+1),children:"Next"})]})]})]})]}),r&&e.jsx(be,{unit:r,rooms:h,open:!!r,onClose:()=>S(null)}),C&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg text-center",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4",children:["QR Code - ",C.unit_code]}),e.jsx(pe,{value:`Unit: ${C.unit_code}`,size:200}),e.jsx("div",{className:"mt-4",children:e.jsx(p,{variant:"outline",onClick:()=>l(null),children:"Close"})})]})})]})}export{He as default};
