import{r,b as z,c,j as e,H,L as V}from"./app-DpVfWwIa.js";import{S as X,a as Y,b as $,c as W}from"./avatar-RA861kI_.js";import{N as G}from"./Notification-UkIKd2cs.js";import{A as J}from"./app-sidebar-CibsznEs.js";import{B as Q}from"./button-BIJ7I28M.js";import{B as Z,a as ee,b as se,c as te}from"./breadcrumb-BXCYgfCA.js";import{C as d,b as m,c as h,a as p,e as ae}from"./card-D26ThBVV.js";import{u as ie,C as re,a as ne,A as S,b as oe}from"./react-spring_web.modern-C6WvT2_p.js";import{B as le}from"./building-anthHVDV.js";import{M as ce}from"./mouse-D5y-23zT.js";import{M as A}from"./monitor-DRQpVstR.js";import{U as y}from"./users-BYd0OysU.js";import{a as R}from"./createLucideIcon-Dk4lCYyT.js";import{R as u,P as N,a as v,C,T as j,B as de,X as me,Y as he,L as xe,b as pe}from"./PieChart-BDpZDhTQ.js";import"./index-D5ducR0X.js";import"./index-6ic6AYgv.js";import"./input-Cldoq0Pi.js";import"./index-DlFG9ft2.js";import"./index-CiXBdE1i.js";import"./dropdown-menu-XEGQPnCV.js";import"./index-_HPkj5RN.js";import"./chevron-right-D7r8_AMT.js";import"./index-B-XQDOc2.js";import"./sparkles-DCW1G32V.js";import"./keyboard-B4m-Xq-z.js";import"./user-CxFqTgIJ.js";import"./file-text-Dxsjq4uB.js";import"./chevron-down-BS5431_g.js";import"./with-selector-CTFn6irh.js";/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]],je=R("chart-no-axes-column-increasing",ue);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],fe=R("chart-pie",ge);function $e(){const[a,_]=r.useState({totalRooms:0,totalSystemUnits:0,totalPeripherals:0,totalEquipments:0,occupiedRooms:0,pendingRequests:0,forRepair:0,activeUsers:0,totalUsers:0}),{auth:q}=z().props,F=q.user,w=async()=>{try{const s=await c.get("/admin/dashboard-stats");_(s.data)}catch(s){console.error("Failed to fetch stats:",s)}};r.useEffect(()=>{w();const s=setInterval(w,5e3);return()=>clearInterval(s)},[]);const[g,B]=r.useState([]),[k,D]=r.useState([]),[o,L]=r.useState({system_units:{},peripherals:{},equipments:{}}),[E,U]=r.useState([]),[P,T]=r.useState([]);r.useEffect(()=>{c.get("/admin/activity-logs").then(s=>B(s.data)),c.get("/admin/rooms-status").then(s=>D(s.data)),c.get("/admin/equipment-condition").then(s=>L(s.data)),c.get("/admin/equipment-condition-by-room").then(s=>{if(U(s.data),s.data.length>0){const t=Object.keys(s.data[0]).filter(b=>b!=="room");T(t)}}).catch(s=>console.error("Error fetching equipment-condition-by-room:",s))},[]);const i=s=>ie({val:s,from:{val:0}}),I=s=>e.jsx(oe.p,{className:"text-lg font-bold text-black",children:s.val.to(t=>Math.floor(t))}),K=[{title:"Total Rooms",value:i(a.totalRooms),icon:le,link:"/admin/rooms"},{title:"Computers",value:i(a.totalSystemUnits),icon:re,link:"/admin/system-units"},{title:"Peripherals",value:i(a.totalPeripherals),icon:ce,link:"/admin/peripherals"},{title:"Room Equipments",value:i(a.totalEquipments),icon:A,link:"/admin/equipments"},{title:"Occupied Rooms",value:i(a.occupiedRooms),icon:y,link:"/admin/monitoring"},{title:"Pending Requests",value:i(a.pendingRequests),icon:ne,link:"/admin/maintenance-requests"},{title:"For Repair",value:i(a.forRepair),icon:S,link:"/admin/repairs"},{title:"Active Users",value:i(a.activeUsers),icon:A,link:"/admin/users"},{title:"Total Users",value:i(a.totalUsers),icon:y,link:"/admin/users"}],n=["#16a34a","#facc15","#dc2626","#3b82f6","#9333ea"],l=s=>Object.entries(s).map(([t,b])=>({name:t,value:b})),[f,M]=r.useState(!1),x=k.details?k.details.filter(s=>s.is_active):[],O=f?x:x.slice(0,2);return e.jsxs(X,{children:[e.jsx(H,{children:e.jsx("title",{children:"Admin Dashboard"})}),e.jsx(J,{}),e.jsxs(Y,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx($,{}),e.jsx(W,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(Z,{children:e.jsx(ee,{children:e.jsx(se,{children:e.jsx(te,{href:"#","aria-current":"page",children:"Dashboard"})})})}),e.jsx("div",{className:"flex-1"}),e.jsx(G,{})]}),e.jsxs("main",{className:"w-full px-6 py-6 space-y-6",children:[e.jsxs("div",{className:"relative rounded-2xl bg-gradient-to-r from-[#A8D5BA] via-[#7FCF9E] to-[#59AC77] p-6 text-white shadow-lg",children:[e.jsxs("h1",{className:"text-3xl font-bold",children:["Welcome back, ",F.name.split(" ")[0],"."]}),e.jsx("p",{className:"text-sm opacity-90 mt-1",children:"Hereâ€™s a summary of your ICT inventory system."})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4",children:K.map((s,t)=>e.jsx(V,{href:s.link,className:"block",children:e.jsxs(d,{className:"rounded-xl shadow-sm bg-white hover:shadow-md transition-all duration-300 cursor-pointer p-3",children:[e.jsx(m,{className:"flex flex-row items-center justify-between space-y-0 pb-1",children:e.jsxs(h,{className:"text-xs font-medium flex items-center gap-1 text-gray-500",children:[e.jsx(s.icon,{className:"h-4 w-4 text-[hsl(142,34%,51%)]"}),s.title]})}),e.jsx(p,{children:I(s.value)})]})},t))}),e.jsxs("div",{className:"lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(d,{className:"rounded-2xl shadow-md bg-white",children:[e.jsx(m,{children:e.jsxs(h,{className:"flex items-center gap-2 text-[#2F4F2F]",children:[e.jsx(y,{className:"w-5 h-5 text-[#59AC77]"}),"Active Room Occupancy"]})}),e.jsx("div",{className:"space-y-6 p-4",children:x.length===0?e.jsx("p",{className:"text-[#3B5C47] text-sm text-center",children:"No active rooms right now"}):O.map(s=>e.jsxs("div",{className:"flex items-center gap-6 border-b pb-6 last:border-b-0",children:[e.jsx("img",{src:s.faculty_photo?`/storage/${s.faculty_photo}`:"/default-avatar.png",alt:"Faculty",className:"w-16 h-16 rounded-full object-cover border-4 border-[#59AC77]"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-base font-semibold text-[#2F4F2F]",children:["Room"," ",s.room_number]}),e.jsxs("p",{className:"text-sm text-[#3B5C47]",children:["Scanned by"," ",e.jsx("span",{className:"font-medium text-[#2F4F2F]",children:s.last_scanned_by??"Unknown"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:s.last_scanned_at?new Date(s.last_scanned_at).toLocaleString():"No scan time"})]})]},s.id))}),x.length>2&&e.jsx(ae,{className:"flex justify-center",children:e.jsx(Q,{variant:"outline",size:"sm",onClick:()=>M(!f),children:f?"Show Less":"View All Active Rooms"})})]}),e.jsxs(d,{children:[e.jsx(m,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-5 h-5 text-green-600"}),"Recent Activity"]})}),e.jsx(p,{children:e.jsx("ul",{className:"space-y-3 max-h-72 overflow-y-auto",children:Array.isArray(g)&&g.length>0?g.map((s,t)=>e.jsxs("li",{className:"text-sm border-b pb-2",children:[e.jsx("span",{className:"font-semibold",children:s.user?.name??"Unknown"})," ",s.action,e.jsx("span",{className:"block text-xs text-gray-500",children:s.timestamp})]},t)):e.jsx("li",{className:"text-gray-500",children:"No activity logs found"})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-1 gap-6",children:[e.jsxs(d,{className:"rounded-2xl shadow-md bg-white",children:[e.jsx(m,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5 text-emerald-600"}),"Equipment Condition by Type"]})}),e.jsx(p,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 h-72",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-center font-semibold mb-1",children:"Computers"}),e.jsx(u,{width:"100%",height:"90%",children:e.jsxs(N,{children:[e.jsx(v,{data:l(o.system_units),dataKey:"value",nameKey:"name",outerRadius:60,label:!0,children:l(o.system_units).map((s,t)=>e.jsx(C,{fill:n[t%n.length]},t))}),e.jsx(j,{})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-center font-semibold mb-1",children:"Peripherals"}),e.jsx(u,{width:"100%",height:"90%",children:e.jsxs(N,{children:[e.jsx(v,{data:l(o.peripherals),dataKey:"value",nameKey:"name",outerRadius:60,label:!0,children:l(o.peripherals).map((s,t)=>e.jsx(C,{fill:n[t%n.length]},t))}),e.jsx(j,{})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-center font-semibold mb-1",children:"Equipments"}),e.jsx(u,{width:"100%",height:"90%",children:e.jsxs(N,{children:[e.jsx(v,{data:l(o.equipments),dataKey:"value",nameKey:"name",outerRadius:60,label:!0,children:l(o.equipments).map((s,t)=>e.jsx(C,{fill:n[t%n.length]},t))}),e.jsx(j,{})]})})]})]})})]}),e.jsxs(d,{className:"rounded-2xl shadow-md bg-white",children:[e.jsx(m,{children:e.jsxs(h,{className:"flex items-center gap-2 text-[#2F4F2F]",children:[e.jsx(je,{className:"w-5 h-5 text-[#59AC77]"}),"Equipment Condition by Room"]})}),e.jsx(p,{children:e.jsx(u,{width:"100%",height:300,children:e.jsxs(de,{data:E,children:[e.jsx(me,{dataKey:"room"}),e.jsx(he,{}),e.jsx(j,{}),e.jsx(xe,{}),P.map((s,t)=>e.jsx(pe,{dataKey:s,stackId:"a",fill:n[t%n.length]},s))]})})})]})]})]})]})]})}export{$e as default};
