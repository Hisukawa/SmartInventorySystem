import{r as m,j as e,b as ae,c as te,H as le,L as _}from"./app-CWC0bpof.js";import{B as u}from"./button-aNfch2jA.js";import{T as ne,a as ie,b as F,c as g,d as ce,e as f}from"./table-C68DV-XP.js";import{I as V}from"./input-WWtXY93I.js";import{P as re,a as oe,F as de,b as me,S as M,c as P,d as z,e as R,f as b}from"./select-D_tpQaFO.js";import{F as O,M as he}from"./faculty-room-view-sidebar-Chkr6IF3.js";import{D as W,a as X,b as Z,c as G,d as xe}from"./dialog-lmLa_d--.js";import{f as D,c as ue}from"./index-BPU2-vgW.js";import{X as pe}from"./index-DySz9kAo.js";import"./index-ODbjVI-n.js";import"./index-CtiwVrLH.js";import"./dropdown-menu-DkN7cKsI.js";import"./index-Bi2mbzM4.js";import"./chevron-right-C2OYrkf8.js";import"./index-DwVepA8B.js";import"./index-BJV9HLPs.js";/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],fe=D("circle-check",je);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],T=D("eye",ge);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ve=D("file-text",be),J=m.forwardRef(({className:s,...a},n)=>e.jsx("textarea",{className:ue("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:n,...a}));J.displayName="Textarea";function we({open:s,onOpenChange:a,room:n,item:j,section:x,onSuccess:c}){const[r,h]=m.useState({condition:"",remarks:"",photo:null}),t=o=>{const l={"system-units":"system_unit",peripherals:"peripheral",equipment:"equipment"};o.preventDefault();const d=new FormData;d.append("reportable_type",l[x]||x),d.append("reportable_id",j.id),d.append("room_id",n.id),d.append("condition",r.condition),d.append("remarks",r.remarks),r.photo&&d.append("photo",r.photo),ae.post(route("reports.store"),d,{onSuccess:()=>{a(!1),c&&c()}})};return e.jsx(W,{open:s,onOpenChange:a,children:e.jsxs(X,{className:"max-w-md w-[95%] rounded-2xl p-6",children:[e.jsxs(Z,{children:[e.jsx(G,{children:"Report Item"}),e.jsx(xe,{children:"Fill out the details below to report an issue with this item."})]}),e.jsxs("form",{onSubmit:t,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Condition"}),e.jsx(V,{placeholder:"Enter or select condition...",className:"mt-1",value:r.condition,onChange:o=>h({...r,condition:o.target.value})}),e.jsx("div",{className:"flex gap-2 mt-2 flex-wrap",children:["Working","Needs Maintenance","Defective"].map(o=>e.jsx(u,{type:"button",variant:"outline",size:"sm",onClick:()=>h({...r,condition:o}),className:`${r.condition===o?"bg-primary text-white":""}`,children:o},o))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Remarks"}),e.jsx(J,{placeholder:"Enter remarks...",className:"mt-1",value:r.remarks,onChange:o=>h({...r,remarks:o.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Upload Photo"}),e.jsx(V,{type:"file",accept:"image/*",capture:"environment",className:"mt-1",onChange:o=>h({...r,photo:o.target.files[0]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(u,{type:"submit",children:"Save"})})]})]})})}function ye({open:s,onClose:a}){return e.jsx(W,{open:s,onOpenChange:a,children:e.jsxs(X,{className:"max-w-sm w-[90%] p-6 rounded-2xl shadow-xl text-center",children:[e.jsx("button",{onClick:a,className:"absolute right-4 top-4 text-gray-400 hover:text-gray-600"}),e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx(fe,{className:"w-16 h-16 text-green-500"})}),e.jsx(Z,{children:e.jsx(G,{className:"text-lg font-semibold text-center",children:"Reported successfully"})})]})})}function Ne({page:s,pageCount:a,onPageChange:n}){return e.jsxs("div",{className:"flex justify-end items-center gap-2",children:[e.jsx(u,{variant:"outline",size:"sm",disabled:s===1,onClick:()=>n(s-1),children:"Previous"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",s," of ",a]}),e.jsx(u,{variant:"outline",size:"sm",disabled:s===a,onClick:()=>n(s+1),children:"Next"})]})}function Se({filters:s,filterOptions:a,activeSection:n,onApplyFilters:j}){const[x,c]=m.useState(""),[r,h]=m.useState("");m.useEffect(()=>{s.condition?(c("condition"),h(s.condition)):s.unit_code&&n==="peripherals"?(c("unit_code"),h(s.unit_code)):(c(""),h(""))},[s,n]);const t=l=>{const d=l==="all"?"":l;h(d),x==="condition"?j(d,s.unit_code,s.search):x==="unit_code"&&j(s.condition,d,s.search)},o=()=>{const l=[{value:"condition",label:"Condition"}];return n==="peripherals"&&l.push({value:"unit_code",label:"Unit Code"}),l};return e.jsxs(re,{children:[e.jsx(oe,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4"}),"Filter",(s.condition||n==="peripherals"&&s.unit_code)&&e.jsx(pe,{className:"h-4 w-4 ml-1",onClick:l=>{l.stopPropagation(),c(""),h(""),j("","",s.search)}})]})}),e.jsxs(me,{className:"w-[calc(100vw-2rem)] sm:w-[400px] p-4",align:"start",sideOffset:10,children:[e.jsx("h4",{className:"font-medium mb-3 text-lg",children:"Filter Options"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs(M,{value:x,onValueChange:l=>{c(l),h("")},children:[e.jsx(P,{className:"w-full",children:e.jsx(z,{placeholder:"Select Field"})}),e.jsx(R,{children:o().map(l=>e.jsx(b,{value:l.value,children:l.label},l.value))})]}),x==="condition"&&e.jsxs(M,{value:r||"all",onValueChange:t,children:[e.jsx(P,{className:"w-full",children:e.jsx(z,{placeholder:"Select Condition"})}),e.jsxs(R,{children:[e.jsx(b,{value:"all",children:"All"}),a.conditions.map(l=>e.jsx(b,{value:l,children:l},l))]})]}),x==="unit_code"&&n==="peripherals"&&e.jsxs(M,{value:r||"all",onValueChange:t,children:[e.jsx(P,{className:"w-full",children:e.jsx(z,{placeholder:"Select Unit"})}),e.jsxs(R,{children:[e.jsx(b,{value:"all",children:"All"}),a.unit_codes.map(l=>e.jsx(b,{value:l,children:l},l))]})]})]})]})]})}function $e({room:s,equipments:a,systemUnits:n,peripherals:j,section:x,filters:c={},filterOptions:r={conditions:[],unit_codes:[]}}){const{auth:h}=te().props,[t,o]=m.useState(x||"system-units"),[l,d]=m.useState(!1),[q,E]=m.useState(!1),[K,H]=m.useState(!1),[Q,Y]=m.useState(null),[y,ee]=m.useState(c?.condition||""),[N,se]=m.useState(c?.unit_code||""),[S,I]=m.useState(c?.search||""),[v,L]=m.useState(1),w=10,U=t==="system-units"?n:t==="peripherals"?j:a,$=Math.ceil(U.length/w),A=U.slice((v-1)*w,v*w);m.useEffect(()=>{L(1),ee(c.condition||""),se(c.unit_code||""),I(c.search||"")},[t,c]);const B=(i=y,p=N,C=S)=>{const k=new URLSearchParams({section:t});i&&k.append("condition",i),p&&t==="peripherals"&&k.append("unit_code",p),C&&k.append("search",C),window.location.href=route("room.show",{roomPath:s.room_path,section:t,condition:i||void 0,unit_code:p||void 0,search:C||void 0})};return e.jsxs(e.Fragment,{children:[e.jsx(le,{title:`Room - ${s.room_name}`}),e.jsxs("div",{className:"flex h-screen overflow-hidden",children:[e.jsx("div",{className:"hidden md:flex",children:e.jsx(O,{room:s,active:t,user:h.user,onSelect:i=>{window.location.href=route("room.show",{roomPath:s.room_path,section:i})}})}),l&&e.jsxs("div",{className:"fixed inset-0 z-40 flex md:hidden",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:()=>d(!1)}),e.jsx("div",{className:"relative z-50 w-64 bg-white shadow-lg",children:e.jsx(O,{room:s,active:t,user:h.user,onSelect:i=>{window.location.href=route("room.show",{roomPath:s.room_path,section:i}),d(!1)}})})]}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-y-auto bg-gray-50",children:[" ",e.jsxs("div",{className:"bg-white p-4 border-b md:hidden flex items-center justify-between shadow-sm",children:[e.jsx(u,{variant:"outline",size:"icon",onClick:()=>d(!0),children:e.jsx(he,{className:"h-5 w-5"})}),e.jsx("h2",{className:"text-xl font-semibold text-green-700",children:s.room_name})]}),e.jsxs("div",{className:"p-5 max-w-full md:max-w-5xl lg:max-w-7xl mx-auto w-full",children:[" ",e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:t==="system-units"?"System Units":t==="peripherals"?"Peripherals":"Equipments"})}),e.jsxs("div",{className:"rounded-lg border overflow-hidden shadow-sm bg-white",children:[e.jsx("div",{className:"flex flex-col sm:flex-row gap-2 sm:justify-between sm:items-center p-4 border-b",children:e.jsxs("div",{className:"flex gap-2 items-center w-full sm:w-auto",children:[e.jsx(Se,{filters:{condition:y,unit_code:N,search:S},filterOptions:r,activeSection:t,onApplyFilters:B}),e.jsx(V,{placeholder:"Search...",value:S,onChange:i=>{const p=i.target.value;I(p),B(y,N,p)},className:"flex-1 min-w-0 sm:max-w-xs w-full"})]})}),e.jsxs(ne,{className:"min-w-full divide-y divide-gray-200",children:[e.jsx(ie,{className:"bg-gray-50",children:e.jsxs(F,{children:[e.jsx(g,{className:"w-20 text-center text-gray-600",children:"No"}),e.jsx(g,{className:"text-gray-600  whitespace-nowrap",children:t==="system-units"?"Unit Code":t==="peripherals"?"Peripheral Code":"Equipment Code"}),t!=="system-units"&&e.jsx(g,{className:"text-gray-600",children:"Type"}),e.jsx(g,{className:"text-gray-600",children:"Condition"}),e.jsx(g,{className:"text-gray-600",children:"Actions"})]})}),e.jsx(ce,{className:"divide-y divide-gray-200",children:A.length>0?A.map((i,p)=>e.jsxs(F,{children:[e.jsx(f,{className:"text-center",children:(v-1)*w+p+1}),e.jsx(f,{className:"font-medium text-gray-900 whitespace-nowrap",children:i.name}),t!=="system-units"&&e.jsx(f,{className:"text-gray-700",children:i.type}),e.jsx(f,{children:e.jsx(Ce,{condition:i.condition})}),e.jsxs(f,{className:"flex gap-2 py-3",children:[t==="system-units"&&e.jsx(_,{href:route("faculty.units.show",{room:s.id,unit:i.id}),children:e.jsxs(u,{size:"sm",variant:"outline",className:"flex items-center gap-1 text-blue-600 hover:bg-blue-50",children:[e.jsx(T,{className:"h-4 w-4"})," ","View"]})}),t==="peripherals"&&e.jsx(_,{href:route("faculty.peripherals.show",{room:s.id,peripheral:i.id}),children:e.jsxs(u,{size:"sm",variant:"outline",className:"flex items-center gap-1 text-blue-600 hover:bg-blue-50",children:[e.jsx(T,{className:"h-4 w-4"})," ","View"]})}),t==="equipments"&&e.jsx(_,{href:route("faculty.equipments.show",{room:s.id,equipment:i.id}),children:e.jsxs(u,{size:"sm",variant:"outline",className:"flex items-center gap-1 text-blue-600 hover:bg-blue-50",children:[e.jsx(T,{className:"h-4 w-4"})," ","View"]})}),e.jsxs(u,{size:"sm",variant:"outline",className:"flex items-center gap-1 text-red-600 hover:bg-red-50",onClick:()=>{Y(i),E(!0)},children:[e.jsx(ve,{className:"h-4 w-4"})," ","Report"]})]})]},i.id)):e.jsx(F,{children:e.jsx(f,{colSpan:t==="system-units"?4:5,className:"text-center text-muted-foreground py-4",children:"No data found."})})})]}),$>1&&e.jsx("div",{className:"flex justify-end p-4 bg-gray-50",children:e.jsx(Ne,{page:v,pageCount:$,onPageChange:L})})]})]})]})]})]}),q&&e.jsx(we,{open:q,onOpenChange:E,item:Q,section:t,room:s,onSuccess:()=>H(!0)}),e.jsx(ye,{open:K,onClose:()=>H(!1),message:"Report submitted successfully!"})]})}function Ce({condition:s}){if(!s)return null;const a=s.toLowerCase().trim();let n="bg-gray-100 text-gray-800";return a.includes("not working")||a.includes("broken")||a.includes("defect")?n="bg-red-100 text-red-800":a.includes("maint")||a.includes("pending")||a.includes("check")?n="bg-amber-100 text-amber-800":(a.includes("good")||a.includes("functional")||a==="working")&&(n="bg-green-100 text-green-800"),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold whitespace-nowrap ${n}`,children:s})}export{$e as default};
