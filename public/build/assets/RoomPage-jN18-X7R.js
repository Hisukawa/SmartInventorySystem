import{r,u as z,j as e,a as g}from"./app-C3VsFsTt.js";import{Q as k}from"./index-DdnaKDU0.js";import{S as b}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{N as ne}from"./Notification-rtvwq4gA.js";import{T as ce,a as de,b as E,c,d as me,e as d}from"./table-BmNaAHXp.js";import{B as t}from"./button-BmXEq83b.js";import{I as j}from"./input-BADFDdG6.js";import{D as M,a as O,b as xe,c as q}from"./dialog-CfV5B1hT.js";import{A as he}from"./app-sidebar-ChtJ8R5Y.js";import{B as ue,a as pe,b as fe,c as ge}from"./breadcrumb-bGVcSHy8.js";import{S as be,a as je,b as ve,c as Ne}from"./avatar-OHfmqxA4.js";import{P as we}from"./pen-DU9zZtJ4.js";import{T as Se}from"./trash-2-CBWtYQIX.js";import"./bell-CkgVZJYs.js";import"./utils-CN1jbD1S.js";import"./index-O2r-p2I9.js";import"./index-B73uNNmJ.js";import"./index-BXZAeJQK.js";import"./index-BxHVtKa3.js";import"./dropdown-menu-Bzxu232i.js";import"./index-C3GPpQXx.js";import"./chevron-right-Cu4RY9cH.js";import"./sparkles-Ds1eAusT.js";import"./keyboard-3Iz_hSti.js";import"./boxes-DAVU5RAf.js";import"./file-text-CYFAza4M.js";import"./users-DGBOMJfL.js";import"./chevron-down-CP7o9Et1.js";import"./index-f86eot_y.js";import"./index-D3wEqhFS.js";function as({rooms:n,search:I}){const[v,Q]=r.useState(I||""),[N,w]=r.useState(!1),[A,m]=r.useState(!1),[L,P]=r.useState(null),[x,S]=r.useState(""),[h,y]=r.useState(""),[$,R]=r.useState(!1),[C,_]=r.useState(""),{data:H,setData:U,post:F,reset:K,processing:X,errors:T}=z({room_number:""}),{data:Y,setData:D,put:G,processing:J,errors:B,reset:V}=z({room_number:""}),W=s=>{s.preventDefault(),F("/admin/rooms",{preserveScroll:!0,onSuccess:()=>{K(),_("Room added successfully!"),setTimeout(()=>_(""),5e3)}})},Z=s=>{s.preventDefault(),G(`/admin/rooms/${L.id}`,{preserveScroll:!0,onSuccess:()=>{m(!1),V(),b.fire({icon:"success",title:"Room updated!",showConfirmButton:!1,timer:1500})}})},ee=s=>{P(s),D("room_number",s.room_number),m(!0)},se=s=>{s.key==="Enter"&&g.get("/admin/rooms",{search:v})},te=(s,a)=>{s&&(S(s),y(a))},ae=()=>{const s=document.getElementById("qr-download"),o=new XMLSerializer().serializeToString(s),u=new Blob([o],{type:"image/svg+xml;charset=utf-8"}),ie=URL.createObjectURL(u),p=new Image;p.onload=()=>{const i=document.createElement("canvas"),l=i.getContext("2d");i.width=220,i.height=260,l.fillStyle="#fff",l.fillRect(0,0,i.width,i.height),l.drawImage(p,10,10,200,200),l.fillStyle="#000",l.font="bold 16px sans-serif",l.textAlign="center",l.fillText(`ROOM ${h}`,i.width/2,235);const le=i.toDataURL("image/png"),f=document.createElement("a");f.href=le,f.download=`room-${h}-qr.png`,f.click()},p.src=ie},re=async()=>{await navigator.clipboard.writeText(x),R(!0),setTimeout(()=>R(!1),2e3)},oe=s=>{b.fire({title:"Are you sure?",text:"This room will be permanently deleted.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(a=>{a.isConfirmed&&g.delete(`/admin/rooms/${s}`,{preserveScroll:!0,onSuccess:()=>{b.fire({icon:"success",title:"Deleted!",text:"The room has been deleted.",timer:1500,showConfirmButton:!1})}})})};return e.jsxs(be,{children:[e.jsx(he,{}),e.jsxs(je,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx(ve,{}),e.jsx(Ne,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(ue,{className:"",children:e.jsx(pe,{children:e.jsx(fe,{children:e.jsx(ge,{href:"/admin/rooms","aria-current":"page",className:"font-semibold text-foreground",children:"Room Lists"})})})}),e.jsx("div",{className:"flex-1"}),e.jsx(ne,{})]}),e.jsxs("main",{className:"w-full px-6 py-4 overflow-y-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h1",{className:"text-xl font-bold",children:"Room Management"})}),C&&e.jsx("div",{className:"mb-4 p-3 bg-green-100 text-green-800 rounded shadow text-sm",children:C}),e.jsx(M,{open:A,onOpenChange:m,children:e.jsxs(O,{children:[e.jsx(xe,{children:e.jsx(q,{children:"Edit Room"})}),e.jsxs("form",{onSubmit:Z,className:"space-y-4",children:[e.jsx(j,{placeholder:"e.g. 101",value:Y.room_number,onChange:s=>D("room_number",s.target.value)}),B.room_number&&e.jsx("p",{className:"text-sm text-red-500",children:B.room_number}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(t,{type:"button",variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsx(t,{type:"submit",disabled:J,children:"Update"})]})]})]})}),e.jsxs("div",{className:"flex transition-all duration-700 ease-in-out relative",children:[e.jsxs("div",{className:`flex-1 transition-all duration-700 ease-in-out ${N?"mr-[400px] sm:mr-[500px]":"mr-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 gap-2",children:[e.jsx(j,{placeholder:"Search rooms...",value:v,onChange:s=>Q(s.target.value),onKeyDown:se,className:"w-full sm:w-1/3"}),e.jsx(t,{onClick:()=>w(!0),className:"bg-[hsl(142,31%,51%)] hover:bg-[hsl(142,31%,45%)] text-white font-medium",children:"Add Room"})]}),e.jsx("div",{children:e.jsxs("div",{className:"rounded-md border transition-all duration-700 ease-in-out",children:[e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:e.jsxs(ce,{children:[e.jsx(de,{children:e.jsxs(E,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] hover:bg-[hsl(142,34%,80%)] h-10",children:[e.jsx(c,{className:"font-semibold",children:"#"}),e.jsx(c,{className:"font-semibold",children:"Room Name"}),e.jsx(c,{className:"font-semibold",children:"Room Code"}),e.jsx(c,{className:"font-semibold",children:"QR Code"}),e.jsx(c,{className:"font-semibold",children:"Actions"})]})}),e.jsx(me,{children:n.data.map((s,a)=>{const o=typeof s.room_path=="string"?`${window.location.origin}/room/${s.room_path}`:null;return e.jsxs(E,{children:[e.jsx(d,{children:(n.current_page-1)*n.per_page+a+1}),e.jsxs(d,{children:["ROOM"," ",s.room_number]}),e.jsx(d,{children:s.room_path}),e.jsx(d,{children:o?e.jsx("div",{className:"w-16 h-16 bg-white p-1 rounded cursor-pointer m-1",onClick:u=>{u.stopPropagation(),te(o,s.room_number)},children:e.jsx(k,{value:o,size:64})}):e.jsx("span",{className:"text-sm text-gray-500",children:"No QR"})}),e.jsxs(d,{className:"flex gap-2",children:[e.jsxs(t,{size:"sm",className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>ee(s),children:[e.jsx(we,{className:"h-4 w-4"}),"Edit"]}),e.jsxs(t,{size:"sm",variant:"destructive",className:"flex items-center gap-2",onClick:()=>oe(s.id),children:[e.jsx(Se,{className:"h-4 w-4"}),"Delete"]})]})]},s.id)})})]})}),e.jsxs("div",{className:"mt-2 flex flex-col sm:flex-row justify-between items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground m-2",children:["Page ",n.current_page," of"," ",n.last_page]}),e.jsx("div",{className:"flex flex-wrap justify-center items-center gap-2",children:n.links.map((s,a)=>{const o=s.label.replace("&laquo;","«").replace("&raquo;","»");return e.jsx(t,{variant:s.active?"default":"ghost",size:"sm",className:"min-w-[36px] px-3 py-1",onClick:()=>s.url&&g.visit(s.url,{preserveState:!0,preserveScroll:!0}),disabled:!s.url,dangerouslySetInnerHTML:{__html:o}},a)})})]})]})})]}),e.jsxs("div",{className:`fixed top-[56px] right-0 h-[calc(100vh-4rem)] w-[400px] sm:w-[500px] bg-white border-l shadow-lg z-40 p-4 overflow-y-auto transform transition-transform duration-700 ease-in-out ${N?"translate-x-0":"translate-x-full"}`,children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h2",{className:"text-lg font-semibold",children:"Add Room"})}),e.jsxs("form",{onSubmit:W,className:"space-y-4",children:[e.jsx(j,{placeholder:"e.g. 101",value:H.room_number,onChange:s=>U("room_number",s.target.value)}),T.room_number&&e.jsx("p",{className:"text-sm text-red-500",children:T.room_number}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(t,{type:"button",variant:"outline",onClick:()=>w(!1),children:"Cancel"}),e.jsx(t,{type:"submit",disabled:X,className:"bg-[hsl(142,31%,51%)] hover:bg-[hsl(142,31%,45%)] text-white font-medium",children:"Save"})]})]})]})]}),e.jsx(M,{open:!!x,onOpenChange:()=>{S(""),y("")},children:e.jsxs(O,{className:"max-w-sm text-center",children:[e.jsxs(q,{children:["ROOM ",h]}),e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"inline-block p-4 bg-white rounded cursor-pointer",onClick:s=>{s.stopPropagation(),re()},children:[e.jsx(k,{id:"qr-download",value:x,size:200}),e.jsx("p",{className:"text-xs mt-2 text-muted-foreground",children:"Click QR to copy link"})]}),$&&e.jsx("p",{className:"text-green-600 text-sm text-center mt-1",children:"Copied to clipboard!"}),e.jsx(t,{className:"mt-4",onClick:ae,children:"Download QR"})]})]})})]})]})]})}export{as as default};
