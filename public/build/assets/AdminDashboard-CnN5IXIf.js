import{r as n,b as $,j as e,H as W,L as G,c as m}from"./app-CDRG2MOt.js";import{S as J,a as Q,b as Z,c as ee}from"./avatar-D5Q-7NJI.js";import{N as se}from"./Notification-Caa1MWjc.js";import{A as te}from"./app-sidebar-CHMFXRs8.js";import{B as ae}from"./button-BywnXTkL.js";import{B as ie,a as re,b as ne,c as oe}from"./breadcrumb-CZ-LrLP-.js";import{C as x,b as h,c as p,a as j,e as le}from"./card-BR7yaGAq.js";import{u as ce,C as de,a as me,A as q,b as xe}from"./react-spring_web.modern-gp-0TzY9.js";import{B as he}from"./building-BxYfSKYB.js";import{M as pe}from"./mouse-D121w3xJ.js";import{M as F}from"./monitor-Q9ERRmo-.js";import{U as C}from"./users-vjFCbC_m.js";import{a as B}from"./createLucideIcon-DSlxCbT3.js";import{R as g,P as k,a as R,C as A,T as f,B as ue,X as je,Y as ge,L as fe,b as be}from"./PieChart-CNtwzUp-.js";import"./index-B784Eo5-.js";import"./index-62vIjlww.js";import"./input-B5uL7B-_.js";import"./index-BwdVc4lh.js";import"./index-D4YGHwzu.js";import"./dropdown-menu-kOtk1jiA.js";import"./index-DXlhiN4c.js";import"./chevron-right-BDXU5ylV.js";import"./index-D-TD7xZ_.js";import"./sparkles-B3EniOEE.js";import"./keyboard-ButXCeID.js";import"./user-BbaT8xIM.js";import"./file-text-BQnpPg-i.js";import"./chevron-down-cn-jc674.js";import"./with-selector-C7WFfv5d.js";/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]],ve=B("chart-no-axes-column-increasing",ye);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],we=B("chart-pie",Ne);function Ze(){const[a,S]=n.useState({totalRooms:0,totalSystemUnits:0,totalPeripherals:0,totalEquipments:0,occupiedRooms:0,pendingRequests:0,forRepair:0,activeUsers:0,totalUsers:0}),{auth:D}=$().props,L=D.user,[b,U]=n.useState([]),[_,E]=n.useState([]),[o,P]=n.useState({system_units:{},peripherals:{},equipments:{}}),[T,I]=n.useState([]),[K,M]=n.useState([]);n.useEffect(()=>{const s=async()=>{try{const c=await m.get("/admin/dashboard-stats");S(c.data);const v=await m.get("/admin/rooms-status");if(E(v.data),v.data.details){const w=v.data.details.filter(d=>d.is_active).length;S(d=>({...d,occupiedRooms:w}))}const X=await m.get("/admin/activity-logs");U(X.data);const Y=await m.get("/admin/equipment-condition");P(Y.data);const N=await m.get("/admin/equipment-condition-by-room");if(I(N.data),N.data.length>0){const w=Object.keys(N.data[0]).filter(d=>d!=="room");M(w)}}catch(c){console.error("Error fetching dashboard data:",c)}};s();const t=setInterval(s,5e3);return()=>clearInterval(t)},[]);const i=s=>ce({val:s,from:{val:0}}),O=s=>e.jsx(xe.p,{className:"text-lg font-bold text-black",children:s.val.to(t=>Math.floor(t))}),z=[{title:"Total Rooms",value:i(a.totalRooms),icon:he,link:"/admin/rooms"},{title:"Computers",value:i(a.totalSystemUnits),icon:de,link:"/admin/system-units"},{title:"Peripherals",value:i(a.totalPeripherals),icon:pe,link:"/admin/peripherals"},{title:"Room Equipments",value:i(a.totalEquipments),icon:F,link:"/admin/equipments"},{title:"Occupied Rooms",value:i(a.occupiedRooms),icon:C,link:"/admin/monitoring"},{title:"Pending Requests",value:i(a.pendingRequests),icon:me,link:"/admin/maintenance-requests"},{title:"For Repair",value:i(a.forRepair),icon:q,link:"/admin/repairs"},{title:"Active Users",value:i(a.activeUsers),icon:F,link:"/admin/users"},{title:"Total Users",value:i(a.totalUsers),icon:C,link:"/admin/users"}],r=["#16a34a","#facc15","#dc2626","#3b82f6","#9333ea"],l=s=>Object.entries(s).map(([t,c])=>({name:t,value:c})),[y,H]=n.useState(!1),u=_.details?_.details.filter(s=>s.is_active):[],V=y?u:u.slice(0,2);return e.jsxs(J,{children:[e.jsx(W,{children:e.jsx("title",{children:"Admin Dashboard"})}),e.jsx(te,{}),e.jsxs(Q,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx(Z,{}),e.jsx(ee,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(ie,{children:e.jsx(re,{children:e.jsx(ne,{children:e.jsx(oe,{href:"#","aria-current":"page",children:"Dashboard"})})})}),e.jsx("div",{className:"flex-1"}),e.jsx(se,{})]}),e.jsxs("main",{className:"w-full px-6 py-6 space-y-6",children:[e.jsxs("div",{className:"relative rounded-2xl bg-gradient-to-r from-[#A8D5BA] via-[#7FCF9E] to-[#59AC77] p-6 text-white shadow-lg",children:[e.jsxs("h1",{className:"text-3xl font-bold",children:["Welcome back, ",L.name.split(" ")[0],"."]}),e.jsx("p",{className:"text-sm opacity-90 mt-1",children:"Hereâ€™s a summary of your ICT inventory system."})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4",children:z.map((s,t)=>e.jsx(G,{href:s.link,className:"block",children:e.jsxs(x,{className:"rounded-xl shadow-sm bg-white hover:shadow-md transition-all duration-300 cursor-pointer p-3",children:[e.jsx(h,{className:"flex flex-row items-center justify-between space-y-0 pb-1",children:e.jsxs(p,{className:"text-xs font-medium flex items-center gap-1 text-gray-500",children:[e.jsx(s.icon,{className:"h-4 w-4 text-[hsl(142,34%,51%)]"}),s.title]})}),e.jsx(j,{children:O(s.value)})]})},t))}),e.jsxs("div",{className:"lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(x,{className:"rounded-2xl shadow-md bg-white",children:[e.jsx(h,{children:e.jsxs(p,{className:"flex items-center gap-2 text-[#2F4F2F]",children:[e.jsx(C,{className:"w-5 h-5 text-[#59AC77]"}),"Active Room Occupancy"]})}),e.jsx("div",{className:"space-y-6 p-4",children:u.length===0?e.jsx("p",{className:"text-[#3B5C47] text-sm text-center",children:"No active rooms right now"}):V.map(s=>e.jsxs("div",{className:"flex items-center gap-6 border-b pb-6 last:border-b-0",children:[e.jsx("img",{src:s.faculty_photo?`/storage/${s.faculty_photo}`:"/default-avatar.png",alt:"Faculty",className:"w-16 h-16 rounded-full object-cover border-4 border-[#59AC77]"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-base font-semibold text-[#2F4F2F]",children:["Room"," ",s.room_number]}),e.jsxs("p",{className:"text-sm text-[#3B5C47]",children:["Scanned by"," ",e.jsx("span",{className:"font-medium text-[#2F4F2F]",children:s.last_scanned_by??"Unknown"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:s.last_scanned_at?new Date(s.last_scanned_at).toLocaleString():"No scan time"})]})]},s.id))}),u.length>2&&e.jsx(le,{className:"flex justify-center",children:e.jsx(ae,{variant:"outline",size:"sm",onClick:()=>H(!y),children:y?"Show Less":"View All Active Rooms"})})]}),e.jsxs(x,{children:[e.jsx(h,{children:e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5 text-green-600"}),"Recent Activity"]})}),e.jsx(j,{children:e.jsx("ul",{className:"space-y-3 max-h-72 overflow-y-auto",children:Array.isArray(b)&&b.length>0?b.map((s,t)=>e.jsxs("li",{className:"text-sm border-b pb-2",children:[e.jsx("span",{className:"font-semibold",children:s.user?.name??"Unknown"})," ",s.action,e.jsx("span",{className:"block text-xs text-gray-500",children:s.timestamp})]},t)):e.jsx("li",{className:"text-gray-500",children:"No activity logs found"})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-1 gap-6",children:[e.jsxs(x,{className:"rounded-2xl shadow-md bg-white",children:[e.jsx(h,{children:e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(we,{className:"w-5 h-5 text-emerald-600"}),"Equipment Condition by Type"]})}),e.jsx(j,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 h-72",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-center font-semibold mb-1",children:"Computers"}),e.jsx(g,{width:"100%",height:"90%",children:e.jsxs(k,{children:[e.jsx(R,{data:l(o.system_units),dataKey:"value",nameKey:"name",outerRadius:60,label:!0,children:l(o.system_units).map((s,t)=>e.jsx(A,{fill:r[t%r.length]},t))}),e.jsx(f,{})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-center font-semibold mb-1",children:"Peripherals"}),e.jsx(g,{width:"100%",height:"90%",children:e.jsxs(k,{children:[e.jsx(R,{data:l(o.peripherals),dataKey:"value",nameKey:"name",outerRadius:60,label:!0,children:l(o.peripherals).map((s,t)=>e.jsx(A,{fill:r[t%r.length]},t))}),e.jsx(f,{})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-center font-semibold mb-1",children:"Equipments"}),e.jsx(g,{width:"100%",height:"90%",children:e.jsxs(k,{children:[e.jsx(R,{data:l(o.equipments),dataKey:"value",nameKey:"name",outerRadius:60,label:!0,children:l(o.equipments).map((s,t)=>e.jsx(A,{fill:r[t%r.length]},t))}),e.jsx(f,{})]})})]})]})})]}),e.jsxs(x,{className:"rounded-2xl shadow-md bg-white",children:[e.jsx(h,{children:e.jsxs(p,{className:"flex items-center gap-2 text-[#2F4F2F]",children:[e.jsx(ve,{className:"w-5 h-5 text-[#59AC77]"}),"Equipment Condition by Room"]})}),e.jsx(j,{children:e.jsx(g,{width:"100%",height:300,children:e.jsxs(ue,{data:T,children:[e.jsx(je,{dataKey:"room"}),e.jsx(ge,{}),e.jsx(f,{}),e.jsx(fe,{}),K.map((s,t)=>e.jsx(be,{dataKey:s,stackId:"a",fill:r[t%r.length]},s))]})})})]})]})]})]})]})}export{Ze as default};
