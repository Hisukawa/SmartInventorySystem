import{r as g,j as e,L as k,a as _}from"./app-BxkzuFFm.js";import{B as u}from"./button-MNpR33hQ.js";import{C as D,a as V}from"./card-CsaFu_bw.js";import{S as z,a as I,b as E,c as L}from"./avatar-CgRQPBgt.js";import{S as T}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{N as q}from"./Notification-31YdMFa9.js";import{T as O,a as $,b as F,c as i,d as H,e as n}from"./table-DOV716M_.js";import{B as M,a as Y,b as K,c as A,d as U}from"./breadcrumb-DArj93Q0.js";import{A as X}from"./app-sidebar-CngLVym_.js";import{I as G}from"./input-D913zPIt.js";import{P as J,a as Q,b as W,S as b,c as f,d as y,e as v,f as m}from"./select-DIlFD00J.js";import{P as Z,T as ee}from"./trash-2-zdL8Kdkz.js";import{F as se}from"./funnel-CvlkejIq.js";import{X as P}from"./index-BTrL-S-B.js";import"./index-B_1wNrb6.js";import"./index-tVPEYKut.js";import"./createLucideIcon-CoOq4lWn.js";import"./index-DAI1LT-3.js";import"./dropdown-menu-ClzKCFNt.js";import"./index-D3Xaqd4Q.js";import"./chevron-right-BSNrGoLQ.js";import"./index-CnwiZp1W.js";import"./sparkles-Is_cD38G.js";import"./keyboard-HKn5bocU.js";import"./user-DDl4G_7S.js";import"./file-text-r3cdJJOw.js";import"./chevron-down-Bo0wquTw.js";import"./index-BdQq_4o_.js";import"./index-D0Am1Ygk.js";function le({filters:a,filterOptions:h,onApplyFilters:w,onResetFilters:N}){const[o,t]=g.useState(""),[p,r]=g.useState("");g.useEffect(()=>{a.condition?(t("condition"),r(a.condition)):a.room?(t("room"),r(a.room)):a.faculty?(t("faculty"),r(a.faculty)):a.reportable_type?(t("reportable_type"),r(a.reportable_type)):(t(""),r(""))},[a]);const x=l=>{const c=l==="all"?"":l;r(c);let S={...a};o&&(S[o]=c),w(S)},j=()=>{t(""),r(""),N()},C=[{value:"condition",label:"Condition"},{value:"room",label:"Room"},{value:"faculty",label:"Faculty"},{value:"reportable_type",label:"Report Type"}];return e.jsxs(J,{children:[e.jsx(Q,{asChild:!0,children:e.jsxs(u,{className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",children:[e.jsx(se,{className:"h-4 w-4"}),"Filter",(a.condition||a.room||a.faculty||a.reportable_type)&&e.jsx(P,{className:"h-4 w-4 ml-1 cursor-pointer",onClick:l=>{l.stopPropagation(),l.preventDefault(),j()}})]})}),e.jsxs(W,{className:"w-[calc(100vw-2rem)] sm:w-[400px] p-4",children:[e.jsx("h4",{className:"font-medium mb-3 text-lg",children:"Filter Options"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs(b,{value:o,onValueChange:l=>{t(l),r("")},children:[e.jsx(f,{className:"w-full",children:e.jsx(y,{placeholder:"Select Field"})}),e.jsx(v,{children:C.map(l=>e.jsx(m,{value:l.value,children:l.label},l.value))})]}),o==="condition"&&e.jsxs(b,{value:p||"all",onValueChange:x,children:[e.jsx(f,{className:"w-full",children:e.jsx(y,{placeholder:"Select Condition"})}),e.jsxs(v,{children:[e.jsx(m,{value:"all",children:"All"}),h.conditions.map((l,c)=>e.jsx(m,{value:l,children:l},c))]})]}),o==="room"&&e.jsxs(b,{value:p||"all",onValueChange:x,children:[e.jsx(f,{className:"w-full",children:e.jsx(y,{placeholder:"Select Room"})}),e.jsxs(v,{children:[e.jsx(m,{value:"all",children:"All"}),Object.entries(h.rooms).map(([l,c])=>e.jsxs(m,{value:l,children:["Room ",c]},l))]})]}),o==="faculty"&&e.jsxs(b,{value:p||"all",onValueChange:x,children:[e.jsx(f,{className:"w-full",children:e.jsx(y,{placeholder:"Select Faculty"})}),e.jsxs(v,{children:[e.jsx(m,{value:"all",children:"All"}),Object.entries(h.faculties).map(([l,c])=>e.jsx(m,{value:l,children:c},l))]})]}),o==="reportable_type"&&e.jsxs(b,{value:p||"all",onValueChange:x,children:[e.jsx(f,{className:"w-full",children:e.jsx(y,{placeholder:"Select Type"})}),e.jsxs(v,{children:[e.jsx(m,{value:"all",children:"All"}),h.reportable_types.map(l=>e.jsx(m,{value:l,children:l},l))]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(u,{size:"sm",variant:"outline",onClick:j,className:"w-auto px-3",children:[e.jsx(P,{className:"mr-1 h-4 w-4"})," Reset"]})})]})]})]})}function Pe({reports:a,filters:h={},filterOptions:w}){const[N,o]=g.useState(h.search||""),[t,p]=g.useState(1),r=10,x=Math.ceil(a.length/r),j=a.slice((t-1)*r,t*r);function C(s){const d=Object.fromEntries(Object.entries(s).filter(([R,B])=>B!==""&&B!==void 0));_.get(route("admin.reports.index"),{...d,search:N||void 0})}function l(){o(""),_.get(route("admin.reports.index"))}function c(s){s.key==="Enter"&&C(h)}function S(s){T.fire({title:"Are you sure?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!"}).then(d=>{d.isConfirmed&&_.delete(`/admin/faculty-reports/${s}`)})}return e.jsxs(z,{children:[e.jsx(X,{}),e.jsxs(I,{children:[e.jsx("header",{className:"sticky top-0 z-20 bg-white border-b px-6 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{}),e.jsx(L,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(M,{children:e.jsx(Y,{children:e.jsxs(K,{children:[e.jsx(A,{href:"#","aria-current":"page",children:"Reports"}),e.jsx(U,{}),e.jsx(A,{href:"/admin/faculty/reports","aria-current":"page",className:"font-semibold text-foreground",children:"Faculty Reports"})]})})}),e.jsx("div",{className:"flex-1"}),e.jsx(q,{})]})}),e.jsx("main",{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-5",children:"Faculty Reports"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-4",children:[e.jsx(le,{filters:h,filterOptions:w,onApplyFilters:C,onResetFilters:l}),e.jsx(G,{placeholder:"Search reports...",value:N,onChange:s=>o(s.target.value),onKeyDown:c,className:`flex-1 min-w-0 sm:max-w-xs w-full 
             border-[hsl(142,34%,51%)] text-[hsl(142,34%,20%)] 
             focus:border-[hsl(142,34%,45%)] focus:ring-[hsl(142,34%,45%)] 
             placeholder:text-[hsl(142,34%,40%)]`})]}),e.jsx(D,{children:e.jsxs(V,{className:"p-0",children:[e.jsxs(O,{children:[e.jsx($,{children:e.jsxs(F,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] hover:bg-[hsl(142,34%,80%)]",children:[e.jsx(i,{children:"#"}),e.jsx(i,{children:"Faculty"}),e.jsx(i,{children:"Reports Type"}),e.jsx(i,{children:"Reports ID"}),e.jsx(i,{children:"Type"}),e.jsx(i,{children:"Code"}),e.jsx(i,{children:"Condition"}),e.jsx(i,{children:"Remarks"}),e.jsx(i,{children:"Room"}),e.jsx(i,{children:"Date"}),e.jsx(i,{children:"Actions"})]})}),e.jsx(H,{children:j.length>0?j.map((s,d)=>e.jsxs(F,{children:[e.jsx(n,{children:(t-1)*r+d+1}),e.jsx(n,{children:s.user?.name||"N/A"}),e.jsx(n,{children:s.reportable_type}),e.jsx(n,{children:s.reportable_id}),e.jsx(n,{children:s.reportable_type==="peripheral"?s.reportable?.type:s.reportable_type==="system_unit"?"System Unit":s.reportable_type==="equipment"?s.reportable?.equipment_type:"N/A"}),e.jsx(n,{children:s.reportable_type==="peripheral"?s.reportable?.peripheral_code:s.reportable_type==="system_unit"?s.reportable?.unit_code:s.reportable_type==="equipment"?s.reportable?.equipment_code:"N/A"}),e.jsx(n,{children:s.condition}),e.jsx(n,{children:s.remarks}),e.jsxs(n,{children:["ROOM"," ",s.room?s.room.room_number:"N/A"]}),e.jsx(n,{children:new Date(s.created_at).toLocaleDateString()}),e.jsx(n,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{href:`/admin/faculty-reports/${s.id}/edit`,children:e.jsxs(u,{size:"sm",className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",children:[e.jsx(Z,{className:"h-4 w-4"}),"Edit"]})}),e.jsxs(u,{size:"sm",variant:"destructive",className:"flex items-center gap-2",onClick:()=>{T.fire({title:`Delete report #${s.id}?`,text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(R=>{R.isConfirmed&&(S(s.id),T.fire("Deleted!",`Report #${s.id} has been deleted.`,"success"))})},children:[e.jsx(ee,{className:"h-4 w-4"}),"Delete"]})]})})]},s.id)):e.jsx(F,{children:e.jsx(n,{colSpan:"11",className:"text-center",children:"No reports found."})})})]}),e.jsxs("div",{className:"flex justify-center mt-4 space-x-2",children:[e.jsx(u,{variant:"outline",size:"sm",disabled:t===1,onClick:()=>p(t-1),children:"Previous"}),[...Array(x)].map((s,d)=>e.jsx(u,{variant:t===d+1?"default":"outline",size:"sm",onClick:()=>p(d+1),children:d+1},d)),e.jsx(u,{variant:"outline",size:"sm",disabled:t===x,onClick:()=>p(t+1),children:"Next"})]})]})})]})})]})]})}export{Pe as default};
