import{r as f,j as e,L as k,R as O,a as R,u as V}from"./app-BvBd1GnC.js";import{B as o}from"./button-CdkOSgzJ.js";import{C as I,c as L}from"./card-FpVxRCYl.js";import{S as M,a as $,b as H,c as G}from"./avatar-DqCZNyzw.js";import{S as q}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{T as K,a as U,b as T,c as j,d as X,e as x}from"./table-Cd_JvZus.js";import{B as Y,a as J,b as Q,c as z,d as W}from"./breadcrumb-CV0RqJMr.js";import{T as Z}from"./technician-app-sidebar-BSG-o9bz.js";import{I as w}from"./input-BwOZc7Zq.js";import{P as ee,a as se,b as te}from"./popover-CkXzF60R.js";import{S as b,a as v,b as g,c as N,d as c}from"./select-C-VRlBsC.js";import{E as ie}from"./eye-DBriTnfK.js";import{P as ne}from"./pen-BIq37BLs.js";import{T as re}from"./trash-2-kve934S6.js";import{F as ae}from"./funnel-D2PQU6F9.js";import{X as le}from"./index-DvOpYEn3.js";import"./index-LbrfRVPk.js";import"./utils-CBfrqCZ4.js";import"./createLucideIcon-Cv1oO-Fl.js";import"./index-DehNsO9t.js";import"./index-BFcwglcI.js";import"./index-DyOr2Q4q.js";import"./dropdown-menu-BUQvar8H.js";import"./index-Q3iTcOAL.js";import"./chevron-right-Cs5U5o47.js";import"./index-CoVr6EPs.js";import"./index-Cb-Ljacu.js";import"./index-Ds5tNIIP.js";import"./boxes-BwU1BbTo.js";import"./index-CsNJ2CsO.js";import"./chevron-down-aIWWTnPz.js";function oe({filters:r,filterOptions:u,onApplyFilters:d}){const[m,l]=f.useState(""),a=()=>{const n={type:void 0,condition:void 0,room_id:void 0};l(""),d(n)};return e.jsxs(ee,{children:[e.jsx(se,{asChild:!0,children:e.jsxs(o,{variant:"outline",size:"sm",children:[e.jsx(ae,{className:"mr-2 h-4 w-4"}),"Filters"]})}),e.jsx(te,{className:"w-72",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(b,{value:m,onValueChange:l,children:[e.jsx(v,{children:e.jsx(g,{placeholder:"Select filter field"})}),e.jsxs(N,{children:[e.jsx(c,{value:"type",children:"Type"}),e.jsx(c,{value:"condition",children:"Condition"}),e.jsx(c,{value:"room",children:"Room"})]})]}),m==="type"&&e.jsxs(b,{value:r.type||"all",onValueChange:n=>d({...r,type:n==="all"?void 0:n}),children:[e.jsx(v,{children:e.jsx(g,{placeholder:"Select Type"})}),e.jsxs(N,{children:[e.jsx(c,{value:"all",children:"All"}),u.types.map(n=>e.jsx(c,{value:n,children:n},n))]})]}),m==="condition"&&e.jsxs(b,{value:r.condition||"all",onValueChange:n=>d({...r,condition:n==="all"?void 0:n}),children:[e.jsx(v,{children:e.jsx(g,{placeholder:"Select Condition"})}),e.jsxs(N,{children:[e.jsx(c,{value:"all",children:"All"}),u.conditions.map(n=>e.jsx(c,{value:n,children:n},n))]})]}),m==="room"&&e.jsxs(b,{value:r.room_id||"all",onValueChange:n=>d({...r,room_id:n==="all"?void 0:n}),children:[e.jsx(v,{children:e.jsx(g,{placeholder:"Select Room"})}),e.jsxs(N,{children:[e.jsx(c,{value:"all",children:"All"}),Object.entries(u.rooms).map(([n,p])=>e.jsx(c,{value:n,children:p},n))]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(o,{size:"sm",variant:"outline",onClick:a,className:"flex items-center gap-1",children:[e.jsx(le,{className:"h-4 w-4"}),"Reset All"]})})]})})]})}function Le({equipments:r,search:u,existingRooms:d,conditions:m,filters:l={}}){const[a,n]=f.useState(u||""),[p,C]=f.useState(null),[i,E]=f.useState(1),S=10,A=f.useMemo(()=>{const s=t=>[...new Set(t.filter(h=>h))].sort();return{types:s(r.map(t=>t.type)),conditions:s(r.map(t=>t.condition)),rooms:Object.fromEntries(d.map(t=>[String(t.id),t.room_number]))}},[r,d]);function _(s){const t=Object.fromEntries(Object.entries({...s,search:a||void 0}).filter(([,h])=>h!==""&&h!==void 0));R.get("/technician/equipments",t,{preserveState:!0,replace:!0})}const D=s=>{s.key==="Enter"&&_(l)},B=f.useMemo(()=>{if(!a)return r;const s=a.toLowerCase();return r.filter(t=>[t.equipment_code,t.type,t.brand,t.model,t.serial_number,t.condition,t.room?.room_number].filter(Boolean).some(h=>h.toLowerCase().includes(s)))},[r,a]),y=Math.ceil(B.length/S)||1,P=B.slice((i-1)*S,i*S);function F(s){q.fire({title:"Are you sure?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(t=>{t.isConfirmed&&R.delete(`/technician/equipments/${s}`,{onSuccess:()=>{q.fire({icon:"success",title:"Deleted!",text:"Equipment deleted successfully.",timer:2e3,showConfirmButton:!1})}})})}return e.jsxs(M,{children:[e.jsx(Z,{}),e.jsxs($,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx(H,{}),e.jsx(G,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(Y,{children:e.jsx(J,{children:e.jsxs(Q,{children:[e.jsx(z,{href:"#",children:"Assets"}),e.jsx(W,{}),e.jsx(z,{href:"/technician/equipments","aria-current":"page",className:"font-semibold text-foreground",children:"Equipments"})]})})}),e.jsx("div",{className:"flex-1"})]}),e.jsx("main",{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-5",children:"Equipments"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(oe,{filters:l,filterOptions:A,onApplyFilters:_}),e.jsx(w,{placeholder:"Search equipments...",value:a,onChange:s=>n(s.target.value),onKeyDown:D,className:"w-64"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(k,{href:"/technician/equipments/create",children:e.jsx(o,{className:"text-sm sm:text-base px-3 py-1 sm:py-2 bg-[hsl(142,31%,51%)] hover:bg-[hsl(142,31%,45%)] text-white font-medium",children:"Add Equipment"})})})]}),e.jsx(I,{children:e.jsxs(L,{className:"p-0",children:[e.jsxs(K,{children:[e.jsx(U,{children:e.jsxs(T,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] hover:bg-[hsl(142,34%,80%)]",children:[e.jsx(j,{children:"#"}),e.jsx(j,{children:"Equipment Code"}),e.jsx(j,{children:"Type"}),e.jsx(j,{children:"Brand"}),e.jsx(j,{children:"Condition"}),e.jsx(j,{children:"Room"}),e.jsx(j,{className:"text-center whitespace-nowrap",children:"Actions"})]})}),e.jsx(X,{children:P.length>0?P.map((s,t)=>e.jsxs(T,{children:[e.jsx(x,{children:(i-1)*S+t+1}),e.jsx(x,{children:s.equipment_code}),e.jsx(x,{children:s.type}),e.jsx(x,{children:s.brand}),e.jsx(x,{children:s.condition}),e.jsx(x,{children:s.room?`ROOM ${s.room.room_number}`:"N/A"}),e.jsx(x,{className:"text-center",children:e.jsxs("div",{className:"hidden sm:flex gap-2 justify-center",children:[e.jsx(k,{href:`/technician/equipments/${s.id}`,children:e.jsxs(o,{size:"sm",className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",children:[e.jsx(ie,{className:"h-4 w-4"}),"View"]})}),e.jsxs(o,{size:"sm",className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>C(s),children:[e.jsx(ne,{className:"h-4 w-4"}),"Edit"]}),e.jsxs(o,{size:"sm",variant:"destructive",className:"flex items-center gap-2",onClick:()=>F(s.id),children:[e.jsx(re,{className:"h-4 w-4"}),"Delete"]})]})})]},s.id)):e.jsx(T,{children:e.jsx(x,{colSpan:"9",className:"text-center",children:"No equipments found."})})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",i," of ",y]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{size:"sm",variant:"outline",disabled:i===1,onClick:()=>E(i-1),children:"Previous"}),Array.from({length:y},(s,t)=>t+1).filter(s=>s===1||s===y||s>=i-2&&s<=i+2).map((s,t,h)=>e.jsxs(O.Fragment,{children:[t>0&&h[t]-h[t-1]>1&&e.jsx("span",{className:"px-2",children:"..."}),e.jsx(o,{size:"sm",variant:i===s?"default":"outline",onClick:()=>E(s),children:s})]},s)),e.jsx(o,{size:"sm",variant:"outline",disabled:i===y,onClick:()=>E(i+1),children:"Next"})]})]})]})})]})}),p&&e.jsx(ce,{equipment:p,rooms:d,conditions:m,onClose:()=>C(null)})]})]})}function ce({equipment:r,rooms:u,conditions:d,onClose:m}){const{data:l,setData:a,put:n,processing:p}=V({equipment_code:r.equipment_code||"",type:r.type||"",brand:r.brand||"",condition:r.condition||"",room_id:r.room_id||"",isCustomCondition:!1}),C=i=>{i.preventDefault(),n(route("technician.equipments.update",r.id),{onSuccess:()=>{q.fire("Updated!","Equipment updated successfully.","success"),m()}})};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Edit Equipment"}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsx(w,{placeholder:"Equipment Code",value:l.equipment_code,onChange:i=>a("equipment_code",i.target.value)}),e.jsx(w,{placeholder:"Type",value:l.type,onChange:i=>a("type",i.target.value)}),e.jsx(w,{placeholder:"Brand",value:l.brand,onChange:i=>a("brand",i.target.value)}),e.jsx("input",{type:"text",list:"conditionOptions",className:"w-full border rounded p-2",placeholder:"Enter or select condition",value:l.condition,onChange:i=>a("condition",i.target.value)}),e.jsxs("datalist",{id:"conditionOptions",children:[e.jsx("option",{value:"Good"}),e.jsx("option",{value:"Fair"}),e.jsx("option",{value:"Needs Repair"}),e.jsx("option",{value:"Broken"})]}),e.jsxs(b,{value:String(l.room_id),onValueChange:i=>a("room_id",i),children:[e.jsx(v,{children:e.jsx(g,{placeholder:"Select Room"})}),e.jsx(N,{children:u.map(i=>e.jsxs(c,{value:String(i.id),children:["Room ",i.room_number]},i.id))})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(o,{type:"button",variant:"outline",onClick:m,disabled:p,children:"Cancel"}),e.jsx(o,{type:"submit",disabled:p,children:"Save"})]})]})]})})}export{Le as default};
