import{u as z,j as e,H as F,r as b,L as B,R as M,a as _}from"./app-H-wY-NW9.js";import{B as j}from"./button-DnnPw930.js";import{C as O,a as I}from"./card-CYpEJxXX.js";import{S as L,a as V,b as H,c as $}from"./index-BVsxLG7p.js";import{S as k}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{T as K,a as G,b as w,c as u,d as U,e as c}from"./table-BajdndW5.js";import{B as X,a as Y,b as J,c as P,d as Q}from"./breadcrumb-CRZExBcx.js";import{T as W}from"./technician-app-sidebar-BW9zkWua.js";import{I as Z}from"./input-XWYP2LjR.js";import{P as ee,a as se,b as ne,S as N,c as C,d as S,e as y,f as h}from"./select-CqNmYnJo.js";import{F as te}from"./funnel-Bmq2PRQZ.js";import{X as ie}from"./index-BJkBXNhU.js";import"./index-Bnlh0LNp.js";import"./index-D0uq1nVa.js";import"./createLucideIcon-CHwcNv2z.js";import"./index-De6kIHHZ.js";import"./dropdown-menu-B5A3IWLs.js";import"./index-DwF3FW-u.js";import"./chevron-right-cOmDiQMH.js";import"./index-CHuEt-ae.js";import"./user-Cj0A8JBB.js";import"./send-8m-NC0oR.js";import"./index-Bdmhu-26.js";function le({rooms:l}){const{data:o,setData:r,post:d,errors:a}=z({type:"",brand:"",condition:"",room_number:""}),f=[{label:"Good",value:"good",color:"text-green-600"},{label:"Needs Repair",value:"repair",color:"text-yellow-600"},{label:"Defective",value:"defective",color:"text-red-600"}],i=["System Unit","Monitor","Keyboard","Mouse","Projector"],p=n=>{n.preventDefault(),d("/equipments")};return e.jsxs("div",{className:"max-w-xl mx-auto p-6 bg-white shadow rounded-2xl",children:[e.jsx(F,{title:"Add Equipment"}),e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Register Equipment"}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Type"}),e.jsx("input",{list:"type-list",className:"w-full border p-2 rounded",value:o.type,onChange:n=>r("type",n.target.value)}),e.jsx("datalist",{id:"type-list",children:i.map((n,m)=>e.jsx("option",{value:n},m))}),a.type&&e.jsx("p",{className:"text-red-600",children:a.type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Brand"}),e.jsx("input",{type:"text",className:"w-full border p-2 rounded",value:o.brand,onChange:n=>r("brand",n.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Condition"}),e.jsxs("select",{className:"w-full border p-2 rounded",value:o.condition,onChange:n=>r("condition",n.target.value),children:[e.jsx("option",{value:"",children:"Select Condition"}),f.map((n,m)=>e.jsx("option",{value:n.value,children:n.label},m))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 font-medium",children:"Room"}),e.jsx("input",{list:"room-list",className:"w-full border p-2 rounded",value:o.room_number,onChange:n=>r("room_number",n.target.value)}),e.jsx("datalist",{id:"room-list",children:l.map((n,m)=>e.jsx("option",{value:n.room_number},m))})]}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg",children:"Save"})]})]})}function re({filters:l,filterOptions:o,onApplyFilters:r}){const[d,a]=b.useState(""),f=()=>{const i={type:void 0,condition:void 0,room_id:void 0};a(""),r(i)};return e.jsxs(ee,{children:[e.jsx(se,{asChild:!0,children:e.jsxs(j,{variant:"outline",size:"sm",children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),"Filters"]})}),e.jsx(ne,{className:"w-72",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(N,{value:d,onValueChange:a,children:[e.jsx(C,{children:e.jsx(S,{placeholder:"Select filter field"})}),e.jsxs(y,{children:[e.jsx(h,{value:"type",children:"Type"}),e.jsx(h,{value:"condition",children:"Condition"}),e.jsx(h,{value:"room",children:"Room"})]})]}),d==="type"&&e.jsxs(N,{value:l.type||"all",onValueChange:i=>r({...l,type:i==="all"?void 0:i}),children:[e.jsx(C,{children:e.jsx(S,{placeholder:"Select Type"})}),e.jsxs(y,{children:[e.jsx(h,{value:"all",children:"All"}),o.types.map(i=>e.jsx(h,{value:i,children:i},i))]})]}),d==="condition"&&e.jsxs(N,{value:l.condition||"all",onValueChange:i=>r({...l,condition:i==="all"?void 0:i}),children:[e.jsx(C,{children:e.jsx(S,{placeholder:"Select Condition"})}),e.jsxs(y,{children:[e.jsx(h,{value:"all",children:"All"}),o.conditions.map(i=>e.jsx(h,{value:i,children:i},i))]})]}),d==="room"&&e.jsxs(N,{value:l.room_id||"all",onValueChange:i=>r({...l,room_id:i==="all"?void 0:i}),children:[e.jsx(C,{children:e.jsx(S,{placeholder:"Select Room"})}),e.jsxs(y,{children:[e.jsx(h,{value:"all",children:"All"}),Object.entries(o.rooms).map(([i,p])=>e.jsx(h,{value:i,children:p},i))]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(j,{size:"sm",variant:"outline",onClick:f,className:"flex items-center gap-1",children:[e.jsx(ie,{className:"h-4 w-4"}),"Reset All"]})})]})})]})}function _e({equipments:l,search:o,existingRooms:r,filters:d={}}){const[a,f]=b.useState(o||""),[i,p]=b.useState(null),[n,m]=b.useState(1),v=10,R=b.useMemo(()=>{const s=t=>[...new Set(t.filter(x=>x))].sort();return{types:s(l.map(t=>t.type)),conditions:s(l.map(t=>t.condition)),rooms:Object.fromEntries(r.map(t=>[String(t.id),t.room_number]))}},[l,r]);function q(s){const t=Object.fromEntries(Object.entries({...s,search:a||void 0}).filter(([,x])=>x!==""&&x!==void 0));_.get("/technician/equipments",t,{preserveState:!0,replace:!0})}const A=s=>{s.key==="Enter"&&q(d)},T=b.useMemo(()=>{if(!a)return l;const s=a.toLowerCase();return l.filter(t=>[t.equipment_code,t.type,t.brand,t.model,t.serial_number,t.condition,t.room?.room_number].filter(Boolean).some(x=>x.toLowerCase().includes(s)))},[l,a]),g=Math.ceil(T.length/v)||1,E=T.slice((n-1)*v,n*v);function D(s){k.fire({title:"Are you sure?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(t=>{t.isConfirmed&&_.delete(`/technician/equipments/${s}`,{onSuccess:()=>{k.fire({icon:"success",title:"Deleted!",text:"Equipment deleted successfully.",timer:2e3,showConfirmButton:!1})}})})}return e.jsxs(L,{children:[e.jsx(W,{}),e.jsxs(V,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx(H,{}),e.jsx($,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(X,{children:e.jsx(Y,{children:e.jsxs(J,{children:[e.jsx(P,{href:"#",children:"Assets"}),e.jsx(Q,{}),e.jsx(P,{href:"/technician/equipments","aria-current":"page",className:"font-semibold text-foreground",children:"Equipments"})]})})}),e.jsx("div",{className:"flex-1"})]}),e.jsx("main",{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-5",children:"Equipments"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(re,{filters:d,filterOptions:R,onApplyFilters:q}),e.jsx(Z,{placeholder:"Search equipments...",value:a,onChange:s=>f(s.target.value),onKeyDown:A,className:"w-64"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(B,{href:"/technician/equipments/create",children:e.jsx(j,{children:"Add Equipment"})})})]}),e.jsx(O,{children:e.jsxs(I,{children:[e.jsxs(K,{children:[e.jsx(G,{children:e.jsxs(w,{children:[e.jsx(u,{children:"#"}),e.jsx(u,{children:"Equipment Code"}),e.jsx(u,{children:"Type"}),e.jsx(u,{children:"Brand"}),e.jsx(u,{children:"Model"}),e.jsx(u,{children:"Serial Number"}),e.jsx(u,{children:"Condition"}),e.jsx(u,{children:"Room"}),e.jsx(u,{children:"Actions"})]})}),e.jsx(U,{children:E.length>0?E.map((s,t)=>e.jsxs(w,{children:[e.jsx(c,{children:(n-1)*v+t+1}),e.jsx(c,{children:s.equipment_code}),e.jsx(c,{children:s.type}),e.jsx(c,{children:s.brand}),e.jsx(c,{children:s.model}),e.jsx(c,{children:s.serial_number}),e.jsx(c,{children:s.condition}),e.jsx(c,{children:s.room?`ROOM ${s.room.room_number}`:"N/A"}),e.jsxs(c,{className:"space-x-2",children:[e.jsx(B,{href:`/technician/equipments/${s.id}`,children:e.jsx(j,{variant:"secondary",size:"sm",children:"View"})}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>p(s),children:"Edit"}),e.jsx(j,{variant:"destructive",size:"sm",onClick:()=>D(s.id),children:"Delete"})]})]},s.id)):e.jsx(w,{children:e.jsx(c,{colSpan:"9",className:"text-center",children:"No equipments found."})})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",n," of ",g]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{size:"sm",variant:"outline",disabled:n===1,onClick:()=>m(n-1),children:"Previous"}),Array.from({length:g},(s,t)=>t+1).filter(s=>s===1||s===g||s>=n-2&&s<=n+2).map((s,t,x)=>e.jsxs(M.Fragment,{children:[t>0&&x[t]-x[t-1]>1&&e.jsx("span",{className:"px-2",children:"..."}),e.jsx(j,{size:"sm",variant:n===s?"default":"outline",onClick:()=>m(s),children:s})]},s)),e.jsx(j,{size:"sm",variant:"outline",disabled:n===g,onClick:()=>m(n+1),children:"Next"})]})]})]})})]})}),i&&e.jsx(le,{equipment:i,rooms:r,onClose:()=>p(null)})]})]})}export{_e as default};
