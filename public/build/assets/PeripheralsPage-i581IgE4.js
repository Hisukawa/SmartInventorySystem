import{r as u,j as e,L as R,R as I,a as w}from"./app-CvYAaXE4.js";import{B as m}from"./button-ByIpfzLT.js";import{C as L,a as M}from"./card-CICRxx_7.js";import{S as O,a as U,b as $,c as q}from"./index-Dt3N524-.js";import{S as k}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{N as H}from"./Notification-Dci1R-5w.js";import{T as K,a as X,b as y,c as o,d as Y,e as a}from"./table-CTrDeHFm.js";import{B as G,a as J,b as Q,c as z,d as W}from"./breadcrumb-CGKBgSLU.js";import{A as Z}from"./app-sidebar-W3OsBovA.js";import{I as ee}from"./input-CfVp7Oww.js";import se from"./EditPeripheralModal-CJ4Av7f7.js";import{P as re,a as ie,b as le,S as f,c as v,d as b,e as S,f as n}from"./select-CyX0fXDo.js";import{F as ne}from"./funnel-BEQSIRX3.js";import{X as te}from"./index-BYeNgevf.js";import"./index-BlnhrZ5s.js";import"./index-DVY2WT84.js";import"./createLucideIcon-CGz97te6.js";import"./index-BuAS3bmi.js";import"./dropdown-menu-FMNMyDeg.js";import"./index-BBWrwkiU.js";import"./chevron-right-C0_gjrgv.js";import"./index-BJ4fUgmt.js";import"./dialog-BOvLvhDx.js";import"./label-BZhEI0Lo.js";import"./index-xApRNt0y.js";function ae({filters:l,filterOptions:j,onApplyFilters:c}){const[h,p]=u.useState(""),x=()=>{const r={type:void 0,condition:void 0,room_id:void 0,unit_code:void 0};p(""),c(r)};return e.jsxs(re,{children:[e.jsx(ie,{asChild:!0,children:e.jsxs(m,{variant:"outline",size:"sm",children:[e.jsx(ne,{className:"mr-2 h-4 w-4"}),"Filters"]})}),e.jsx(le,{className:"w-72",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(f,{value:h,onValueChange:p,children:[e.jsx(v,{children:e.jsx(b,{placeholder:"Select filter field"})}),e.jsxs(S,{children:[e.jsx(n,{value:"type",children:"Type"}),e.jsx(n,{value:"condition",children:"Condition"}),e.jsx(n,{value:"room",children:"Room"}),e.jsx(n,{value:"unit",children:"Unit"})]})]}),h==="type"&&e.jsxs(f,{value:l.type||"all",onValueChange:r=>c({...l,type:r==="all"?void 0:r}),children:[e.jsx(v,{children:e.jsx(b,{placeholder:"Select Type"})}),e.jsxs(S,{children:[e.jsx(n,{value:"all",children:"All"}),j.types.map(r=>e.jsx(n,{value:r,children:r},r))]})]}),h==="condition"&&e.jsxs(f,{value:l.condition||"all",onValueChange:r=>c({...l,condition:r==="all"?void 0:r}),children:[e.jsx(v,{children:e.jsx(b,{placeholder:"Select Condition"})}),e.jsxs(S,{children:[e.jsx(n,{value:"all",children:"All"}),j.conditions.map(r=>e.jsx(n,{value:r,children:r},r))]})]}),h==="room"&&e.jsxs(f,{value:l.room_id||"all",onValueChange:r=>c({...l,room_id:r==="all"?void 0:r}),children:[e.jsx(v,{children:e.jsx(b,{placeholder:"Select Room"})}),e.jsxs(S,{children:[e.jsx(n,{value:"all",children:"All"}),Object.entries(j.rooms).map(([r,C])=>e.jsxs(n,{value:r,children:["Room ",C]},r))]})]}),h==="unit"&&e.jsxs(f,{value:l.unit_code||"all",onValueChange:r=>c({...l,unit_code:r==="all"?void 0:r}),children:[e.jsx(v,{children:e.jsx(b,{placeholder:"Select Unit"})}),e.jsxs(S,{children:[e.jsx(n,{value:"all",children:"All"}),j.units.map(r=>e.jsx(n,{value:r,children:r},r))]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(m,{size:"sm",variant:"outline",onClick:x,className:"flex items-center gap-1",children:[e.jsx(te,{className:"h-4 w-4"}),"Reset All"]})})]})})]})}function ze({peripherals:l,search:j,existingRooms:c,existingUnits:h,filters:p={}}){const[x,r]=u.useState(j||""),[C,_]=u.useState(null),[t,P]=u.useState(1),g=10,E=u.useMemo(()=>{const s=i=>[...new Set(i.filter(d=>d))].sort();return{types:s(l.map(i=>i.type)),conditions:s(l.map(i=>i.condition)),rooms:Object.fromEntries(c.map(i=>[String(i.id),i.room_number])),units:s(l.map(i=>i.unit_code))}},[l,c]);function T(s){const i=Object.fromEntries(Object.entries({...s,search:x||void 0}).filter(([,d])=>d!==""&&d!==void 0));w.get("/admin/peripherals",i,{preserveState:!0,replace:!0})}function V(){r(""),w.get("/admin/peripherals",{},{preserveState:!0,replace:!0})}const D=s=>{s.key==="Enter"&&T(p)},B=u.useMemo(()=>{if(!x)return l;const s=x.toLowerCase();return l.filter(i=>[i.peripheral_code,i.type,i.serial_number,i.condition,i.room?.room_number,i.unit_code].filter(Boolean).some(d=>d.toLowerCase().includes(s)))},[l,x]),N=Math.ceil(B.length/g)||1,A=B.slice((t-1)*g,t*g);function F(s){k.fire({title:"Are you sure?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(i=>{i.isConfirmed&&w.delete(`/admin/peripherals/${s}`,{onSuccess:()=>{k.fire({icon:"success",title:"Deleted!",text:"Peripheral deleted successfully.",timer:2e3,showConfirmButton:!1})}})})}return e.jsxs(O,{children:[e.jsx(Z,{}),e.jsxs(U,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx($,{}),e.jsx(q,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(G,{children:e.jsx(J,{children:e.jsxs(Q,{children:[e.jsx(z,{href:"#",children:"Assets"}),e.jsx(W,{}),e.jsx(z,{href:"/admin/peripherals","aria-current":"page",className:"font-semibold text-foreground",children:"Peripherals"})]})})}),e.jsx("div",{className:"flex-1"}),e.jsx(H,{})]}),e.jsx("main",{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-5",children:"Peripherals"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(ae,{filters:p,filterOptions:E,onApplyFilters:T,onReset:V}),e.jsx(ee,{placeholder:"Search peripherals...",value:x,onChange:s=>r(s.target.value),onKeyDown:D,className:"w-64"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(R,{href:"/admin/peripherals/create",children:e.jsx(m,{children:"Add Peripheral"})})})]}),e.jsx(L,{children:e.jsxs(M,{children:[e.jsxs(K,{children:[e.jsx(X,{children:e.jsxs(y,{children:[e.jsx(o,{children:"#"}),e.jsx(o,{children:"Peripheral Code"}),e.jsx(o,{children:"Type"}),e.jsx(o,{children:"Brand"}),e.jsx(o,{children:"Model"}),e.jsx(o,{children:"Serial Number"}),e.jsx(o,{children:"Condition"}),e.jsx(o,{children:"Room"}),e.jsx(o,{children:"Units"}),e.jsx(o,{children:"Actions"})]})}),e.jsx(Y,{children:A.length>0?A.map((s,i)=>e.jsxs(y,{children:[e.jsx(a,{children:(t-1)*g+i+1}),e.jsx(a,{children:s.peripheral_code}),e.jsx(a,{children:s.type}),e.jsx(a,{children:s.brand}),e.jsx(a,{children:s.model}),e.jsx(a,{children:s.serial_number}),e.jsx(a,{children:s.condition}),e.jsx(a,{children:s.room?`ROOM ${s.room.room_number}`:"N/A"}),e.jsx(a,{children:s.unit?s.unit.unit_code:"N/A"}),e.jsxs(a,{className:"space-x-2",children:[e.jsx(R,{href:`/admin/peripherals/${s.id}`,children:e.jsx(m,{variant:"secondary",size:"sm",children:"View"})}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>_(s),children:"Edit"}),e.jsx(m,{variant:"destructive",size:"sm",onClick:()=>F(s.id),children:"Delete"})]})]},s.id)):e.jsx(y,{children:e.jsx(a,{colSpan:"8",className:"text-center",children:"No peripherals found."})})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",t," of ",N]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{size:"sm",variant:"outline",disabled:t===1,onClick:()=>P(t-1),children:"Previous"}),Array.from({length:N},(s,i)=>i+1).filter(s=>s===1||s===N?!0:s>=t-2&&s<=t+2).map((s,i,d)=>e.jsxs(I.Fragment,{children:[i>0&&d[i]-d[i-1]>1&&e.jsx("span",{className:"px-2",children:"..."}),e.jsx(m,{size:"sm",variant:t===s?"default":"outline",onClick:()=>P(s),children:s})]},s)),e.jsx(m,{size:"sm",variant:"outline",disabled:t===N,onClick:()=>P(t+1),children:"Next"})]})]})]})})]})}),C&&e.jsx(se,{peripheral:C,rooms:c,units:h,onClose:()=>_(null)})]})]})}export{ze as default};
