import{r as a,b as Y,j as e,H as $,L as W,c as o}from"./app-ZZeD7AEa.js";import{S as G,a as J,b as Q,c as Z}from"./avatar-_p9bR5M7.js";import{N as ee}from"./Notification-CXAoybks.js";import{T as se}from"./technician-app-sidebar-7Tl2ALno.js";import{B as te}from"./button-D2XOgySb.js";import{B as ae,a as ie,b as ne,c as oe}from"./breadcrumb-CyFgCU8j.js";import{C as r,b as c,c as l,a as m,e as re}from"./card-Dp9uM7vm.js";import{u as ce,C as le,a as de,b as me}from"./react-spring_web.modern-B5VMf9Fj.js";import{B as he}from"./building-wOxzAvmb.js";import{M as xe}from"./mouse-C3uW4i91.js";import{M as pe}from"./monitor-yGA84J8g.js";import{U as y}from"./users-BK4lCMFV.js";import{c as ue}from"./createLucideIcon-CspqRzmy.js";import{R as v,j as je,T as w,L as C,B as fe,X as ge,Y as be,k as Ne}from"./BarChart-DGMgcotl.js";import{P as ye,a as ve}from"./PieChart-ClKgQ6Gb.js";import"./index-CGT50vQy.js";import"./utils-CBfrqCZ4.js";import"./input-Dich0nct.js";import"./index-DecKJaCt.js";import"./index-Ra53VMD9.js";import"./index-BB61If3p.js";import"./dropdown-menu-DHaW0RBu.js";import"./index-CwxihIIj.js";import"./chevron-right-CxLV49xI.js";import"./index-B4Nfmim5.js";import"./index-Ba96PHSF.js";import"./bell-4wUnqQjq.js";import"./index-Cy1c7VRs.js";import"./house-y2PHMtxH.js";import"./user-DPZ2GJ56.js";import"./log-out-DT0aVyDc.js";import"./boxes-DT35St24.js";import"./with-selector-CLVOsOiC.js";/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],R=ue("activity",we);function as(){const[i,S]=a.useState({totalRooms:0,totalSystemUnits:0,totalPeripherals:0,totalEquipments:0,occupiedRooms:0,pendingRequests:0,forRepair:0}),{auth:k}=Y().props,A=k.user,[h,D]=a.useState([]),[j,L]=a.useState({details:[]}),[f,_]=a.useState({system_units:{},peripherals:{},equipments:{}}),[B,F]=a.useState([]),[q,T]=a.useState([]),[O,E]=a.useState([]),[x,I]=a.useState(!1),d=j.details?j.details.filter(s=>s.is_active):[],P=x?d:d.slice(0,2),g=async()=>{try{const s=await o.get("/technician/dashboard-stats");S(s.data);const t=await o.get("/technician/activity-logs");D(t.data);const p=await o.get("/technician/rooms-status");L(p.data);const K=await o.get("/technician/equipment-condition");_(K.data);const u=await o.get("/technician/equipment-condition-by-room");if(F(u.data),u.data.length>0){const z=Object.keys(u.data[0]).filter(X=>X!=="room");T(z)}const V=await o.get("/technician/notifications");E(V.data)}catch(s){console.error("Error fetching dashboard data:",s)}};a.useEffect(()=>{g();const s=setInterval(g,5e3);return()=>clearInterval(s)},[]);const n=s=>ce({val:s,from:{val:0}}),M=s=>e.jsx(me.p,{className:"text-lg font-bold text-black",children:s.val.to(t=>Math.floor(t))}),U=[{title:"Total Rooms",value:n(i.totalRooms),icon:he,link:"/technician/rooms"},{title:"Computers",value:n(i.totalSystemUnits),icon:le,link:"/technician/units"},{title:"Peripherals",value:n(i.totalPeripherals),icon:xe,link:"/technician/peripherals"},{title:"Room Equipments",value:n(i.totalEquipments),icon:pe,link:"/technician/equipments"},{title:"Occupied Rooms",value:n(i.occupiedRooms),icon:y,link:"/technician/monitoring"},{title:"Pending Requests",value:n(i.pendingRequests),icon:de,link:"/technician/maintenance-requests"},{title:"For Repair",value:n(i.forRepair),icon:R,link:"/technician/repairs"}],H={Functional:"#16a34a",Defective:"#dc2626","Needs Maintenance":"#facc15"},b=["#16a34a","#facc15","#dc2626","#3b82f6","#9333ea"],N=s=>Object.entries(s).map(([t,p])=>({name:t,value:p}));return e.jsxs(G,{children:[e.jsx($,{children:e.jsx("title",{children:"Technician Dashboard"})}),e.jsx(se,{}),e.jsxs(J,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx(Q,{}),e.jsx(Z,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(ae,{children:e.jsx(ie,{children:e.jsx(ne,{children:e.jsx(oe,{href:"#","aria-current":"page",children:"Technician Dashboard"})})})}),e.jsx("div",{className:"flex-1"}),e.jsx(ee,{notifications:O})]}),e.jsxs("main",{className:"w-full px-6 py-6 space-y-6",children:[e.jsxs("div",{className:"relative rounded-2xl bg-gradient-to-r from-[#A8D5BA] via-[#7FCF9E] to-[#59AC77] p-6 text-white shadow-lg",children:[e.jsxs("h1",{className:"text-3xl font-bold",children:["Welcome back, ",A.name.split(" ")[0],"."]}),e.jsx("p",{className:"text-sm opacity-90 mt-1",children:"Hereâ€™s a summary of your ICT inventory system."})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4",children:U.map((s,t)=>e.jsx(W,{href:s.link,className:"block",children:e.jsxs(r,{className:"rounded-xl shadow-sm bg-white hover:shadow-md transition-all duration-300 cursor-pointer p-3",children:[e.jsx(c,{className:"flex flex-row items-center justify-between space-y-0 pb-1",children:e.jsxs(l,{className:"text-xs font-medium flex items-center gap-1 text-gray-500",children:[e.jsx(s.icon,{className:"h-4 w-4 text-[hsl(142,34%,51%)]"}),s.title]})}),e.jsx(m,{children:M(s.value)})]})},t))}),e.jsxs("div",{className:"lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(r,{className:"rounded-2xl shadow-md bg-white",children:[e.jsx(c,{children:e.jsxs(l,{className:"flex items-center gap-2 text-[#2F4F2F]",children:[e.jsx(y,{className:"w-5 h-5 text-[#59AC77]"}),"Active Room Occupancy"]})}),e.jsx("div",{className:"space-y-6 p-4",children:d.length===0?e.jsx("p",{className:"text-[#3B5C47] text-sm text-center",children:"No active rooms right now"}):P.map(s=>e.jsxs("div",{className:"flex items-center gap-6 border-b pb-6 last:border-b-0",children:[e.jsx("img",{src:s.faculty_photo?`/storage/${s.faculty_photo}`:"/default-avatar.png",alt:"Faculty",className:"w-16 h-16 rounded-full object-cover border-4 border-[#59AC77]"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-base font-semibold text-[#2F4F2F]",children:["Room"," ",s.room_number]}),e.jsxs("p",{className:"text-sm text-[#3B5C47]",children:["Scanned by"," ",e.jsx("span",{className:"font-medium text-[#2F4F2F]",children:s.last_scanned_by??"Unknown"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:s.last_scanned_at?new Date(s.last_scanned_at).toLocaleString():"No scan time"})]})]},s.id))}),d.length>2&&e.jsx(re,{className:"flex justify-center",children:e.jsx(te,{variant:"outline",size:"sm",onClick:()=>I(!x),children:x?"Show Less":"View All Active Rooms"})})]}),e.jsxs(r,{children:[e.jsx(c,{children:e.jsxs(l,{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-5 h-5 text-green-600"}),"Recent Activity"]})}),e.jsx(m,{children:e.jsx("ul",{className:"space-y-3 max-h-72 overflow-y-auto",children:Array.isArray(h)&&h.length>0?h.map((s,t)=>e.jsxs("li",{className:"text-sm border-b pb-2",children:[e.jsx("span",{className:"font-semibold",children:s.user?.name??"Unknown"})," ",s.action,e.jsx("span",{className:"block text-xs text-gray-500",children:s.timestamp})]},t)):e.jsx("li",{className:"text-gray-500",children:"No activity logs found"})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(r,{children:[e.jsx(c,{children:e.jsx(l,{children:"Equipment Condition"})}),e.jsx(m,{className:"h-[300px]",children:e.jsx(v,{width:"100%",height:"100%",children:e.jsxs(ye,{children:[e.jsx(ve,{data:N(f.equipments),cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,dataKey:"value",label:!0,children:N(f.equipments).map((s,t)=>e.jsx(je,{fill:H[s.name]||"#3b82f6"},`cell-${t}`))}),e.jsx(w,{}),e.jsx(C,{})]})})})]}),e.jsxs(r,{children:[e.jsx(c,{children:e.jsx(l,{children:"Condition by Room"})}),e.jsx(m,{className:"h-[300px]",children:e.jsx(v,{width:"100%",height:"100%",children:e.jsxs(fe,{data:B,children:[e.jsx(ge,{dataKey:"room"}),e.jsx(be,{}),e.jsx(w,{}),e.jsx(C,{}),q.map((s,t)=>e.jsx(Ne,{dataKey:s,stackId:"a",fill:b[t%b.length]},s))]})})})]})]})]})]})]})}export{as as default};
