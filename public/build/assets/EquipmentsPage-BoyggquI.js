import{r as g,u as R,j as e,a as T,R as D}from"./app-BspBoVLj.js";import{B as c}from"./button-nEGy-Tvv.js";import{A}from"./app-sidebar-pEzaVf9W.js";import{S as F,a as z,b as V,c as M}from"./avatar-Cn7juoxD.js";import{S as k}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{I as E}from"./input-Dhk1TQv0.js";import{N as L}from"./Notification-Cjxy831N.js";import{T as $,a as U,b as q,c as f,d as H,e as p}from"./table-Cfj94J7U.js";import{B as Q,a as Y,b as K,c as O,d as X}from"./breadcrumb-lu-ZXrGu.js";import{P as G,a as J,b as W,S as C,c as S,d as w,e as _,f as u}from"./select-DB6YqFsv.js";import{E as Z}from"./eye-BuZ_vB9s.js";import{P as ee}from"./pen-B4wX4NbQ.js";import{T as se}from"./trash-2-DQ74V0N3.js";import{X as le}from"./index-Dw8YL-uq.js";import"./index-7t4Kha0i.js";import"./index-DazmWLnE.js";import"./utils-CGZYKiJE.js";import"./dropdown-menu-Btp35w_w.js";import"./index-4mYg_PsO.js";import"./index-CmBAzxYO.js";import"./chevron-right-C3CnR4PJ.js";import"./sparkles-DQjGELTC.js";import"./keyboard-J1wJJM9o.js";import"./user-Bbsq8BUw.js";import"./file-text-B2UJJIGo.js";import"./users-Dba9jg26.js";import"./chevron-down-fO4XE9Ea.js";import"./index-HEjLux-k.js";import"./index-DlEJG45v.js";import"./index-ChaAKtuD.js";function te({filters:i,filterOptions:x,onApplyFilters:d}){const[o,j]=g.useState(""),[n,r]=g.useState(""),h=l=>{const m=l==="all"?"":l;r(m),o==="type"?d({...i,type:m}):o==="condition"?d({...i,condition:m}):o==="room"&&d({...i,room_id:m})},b=()=>{j(""),r(""),d({type:"",condition:"",room_id:""})};return e.jsxs(G,{children:[e.jsx(J,{asChild:!0,children:e.jsx(c,{size:"sm",className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",children:"Filters"})}),e.jsx(W,{className:"w-72",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(C,{value:o,onValueChange:l=>{j(l),r("")},children:[e.jsx(S,{children:e.jsx(w,{placeholder:"Select filter field"})}),e.jsxs(_,{children:[e.jsx(u,{value:"type",children:"Type"}),e.jsx(u,{value:"condition",children:"Condition"}),e.jsx(u,{value:"room",children:"Room"})]})]}),o==="type"&&e.jsxs(C,{value:n||"all",onValueChange:h,children:[e.jsx(S,{children:e.jsx(w,{placeholder:"Select Type"})}),e.jsxs(_,{children:[e.jsx(u,{value:"all",children:"All"}),x.types.map(l=>e.jsx(u,{value:l,children:l},l))]})]}),o==="condition"&&e.jsxs(C,{value:n||"all",onValueChange:h,children:[e.jsx(S,{children:e.jsx(w,{placeholder:"Select Condition"})}),e.jsxs(_,{children:[e.jsx(u,{value:"all",children:"All"}),x.conditions.map(l=>e.jsx(u,{value:l,children:l},l))]})]}),o==="room"&&e.jsxs(C,{value:n||"all",onValueChange:h,children:[e.jsx(S,{children:e.jsx(w,{placeholder:"Select Room"})}),e.jsxs(_,{children:[e.jsx(u,{value:"all",children:"All"}),Object.entries(x.rooms).map(([l,m])=>e.jsxs(u,{value:l,children:["Room ",m]},l))]})]}),(o||n)&&e.jsx("div",{className:"flex justify-end",children:e.jsxs(c,{size:"sm",variant:"outline",onClick:b,className:"flex items-center gap-1 text-red-600 hover:bg-red-50",children:[e.jsx(le,{className:"w-4 h-4"}),"Reset"]})})]})})]})}const ne=[{label:"Functional",color:"bg-green-500"},{label:"Defective",color:"bg-red-500"},{label:"Intermittent Issue",color:"bg-yellow-500"},{label:"Needs Cleaning",color:"bg-blue-500"},{label:"For Replacement",color:"bg-orange-500"},{label:"For Disposal",color:"bg-gray-500"},{label:"Condemn",color:"bg-black"}];function De({equipments:i,existingRooms:x,filters:d={}}){const[o,j]=g.useState(""),[n,r]=g.useState(1),[h,b]=g.useState(null),l=10,{delete:m}=R(),N=s=>ne.find(a=>a.label.toLowerCase()===s.toLowerCase())||{label:s,color:"bg-gray-400"},t=g.useMemo(()=>{const s=a=>[...new Set(a.filter(Boolean))].sort();return{types:s(i.map(a=>a.type)),conditions:s(i.map(a=>a.condition)),rooms:Object.fromEntries(x.map(a=>[String(a.id),a.room_number]))}},[i,x]);function P(s){const a=Object.fromEntries(Object.entries({...s,search:o||void 0}).filter(([,v])=>v!==""&&v!==void 0));T.get("/equipments",a,{preserveState:!0,replace:!0})}const y=Math.ceil(i.length/l)||1,I=i.slice((n-1)*l,n*l);function B(s){k.fire({title:"Are you sure?",text:`Delete equipment ${s.equipment_code}?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!"}).then(a=>{a.isConfirmed&&m(route("equipments.destroy",s.equipment_code),{onSuccess:()=>{k.fire("Deleted!","Equipment has been deleted.","success")}})})}return e.jsxs(F,{children:[e.jsx(A,{}),e.jsxs(z,{children:[e.jsx("header",{className:"sticky top-0 z-20 bg-white border-b px-6 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{}),e.jsx(M,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(Q,{children:e.jsx(Y,{children:e.jsxs(K,{children:[e.jsx(O,{href:"#","aria-current":"page",children:"Assets"}),e.jsx(X,{}),e.jsx(O,{href:"/equipments","aria-current":"page",className:"font-semibold text-foreground",children:"Equipments"})]})})}),e.jsx("div",{className:"flex-1"}),e.jsx(L,{})]})}),e.jsxs("main",{className:"w-full px-6 py-4",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Equipments"}),e.jsxs("div",{className:"flex justify-between items-center mb-4 gap-2",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(te,{filters:d,filterOptions:t,onApplyFilters:P}),e.jsx(E,{placeholder:"Search Equipment Code...",value:o,onChange:s=>j(s.target.value),onKeyDown:s=>s.key==="Enter"&&P(d),className:`text-sm sm:text-base px-2 sm:px-3 py-1 sm:py-2 flex-1 max-w-xs
               border-[hsl(142,34%,51%)] text-[hsl(142,34%,20%)]
               focus:border-[hsl(142,34%,45%)] focus:ring-[hsl(142,34%,45%)]
               placeholder:text-[hsl(142,34%,40%)]`})]}),e.jsx(c,{className:"text-sm sm:text-base px-3 py-1 sm:py-2 bg-[hsl(142,31%,51%)] hover:bg-[hsl(142,31%,45%)] text-white font-medium",onClick:()=>T.visit("/equipments/addequipment"),children:"Add Equipment"})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border",children:e.jsxs($,{children:[e.jsx(U,{children:e.jsxs(q,{className:"bg-[hsl(142,34%,85%)] text-[hsl(142,34%,25%)] hover:bg-[hsl(142,34%,80%)]",children:[e.jsx(f,{children:"#"}),e.jsx(f,{children:"Equipment Code"}),e.jsx(f,{children:"Equipment Name"})," ",e.jsx(f,{children:"Room"}),e.jsx(f,{children:"Type"}),e.jsx(f,{children:"Condition"}),e.jsx(f,{className:"text-center",children:"Actions"})]})}),e.jsx(H,{children:I.length>0?I.map((s,a)=>e.jsxs(q,{children:[e.jsx(p,{children:(n-1)*l+a+1}),e.jsx(p,{children:s.equipment_code}),e.jsx(p,{children:s.equipment_name})," ",e.jsxs(p,{children:["ROOM"," ",s.room?.room_number||"N/A"]}),e.jsx(p,{children:s.type}),e.jsx(p,{children:s.condition?e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium text-white ${N(s.condition).color}`,children:N(s.condition).label}):"N/A"}),e.jsx(p,{className:"text-center",children:e.jsxs("div",{className:"hidden sm:flex gap-2 justify-center",children:[e.jsxs(c,{size:"sm",className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>T.visit(`/equipments/view/${s.equipment_code}`),children:[e.jsx(Z,{className:"h-4 w-4"}),"View"]}),e.jsxs(c,{size:"sm",className:"flex items-center gap-2 bg-[hsl(142,34%,51%)] text-white border-none hover:bg-[hsl(142,34%,45%)]",onClick:()=>b(s),children:[e.jsx(ee,{className:"h-4 w-4"}),"Edit"]}),e.jsxs(c,{size:"sm",variant:"destructive",className:"flex items-center gap-2",onClick:()=>B(s),children:[e.jsx(se,{className:"h-4 w-4"}),"Delete"]})]})})]},s.id)):e.jsx(q,{children:e.jsx(p,{colSpan:7,className:"text-center py-4",children:"No equipments found."})})})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mt-4 gap-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",n," of ",y]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(c,{size:"sm",variant:"outline",disabled:n===1,onClick:()=>r(s=>s-1),children:"Previous"}),Array.from({length:y},(s,a)=>a+1).filter(s=>s===1||s===y?!0:s>=n-2&&s<=n+2).map((s,a,v)=>e.jsxs(D.Fragment,{children:[a>0&&v[a]-v[a-1]>1&&e.jsx("span",{className:"px-1",children:"..."}),e.jsx(c,{size:"sm",variant:n===s?"default":"outline",onClick:()=>r(s),children:s})]},s)),e.jsx(c,{size:"sm",variant:"outline",disabled:n===y,onClick:()=>r(s=>s+1),children:"Next"})]})]}),h&&e.jsx(ae,{equipment:h,rooms:x,onClose:()=>b(null)})]})]})]})}function ae({equipment:i,rooms:x,onClose:d}){const o=["Furniture","Appliances","Networking","Safety"],j=[{label:"Functional",color:"bg-green-500"},{label:"Defective",color:"bg-red-500"},{label:"Intermittent Issue",color:"bg-yellow-500"},{label:"Needs Cleaning",color:"bg-blue-500"},{label:"For Replacement",color:"bg-orange-500"},{label:"For Disposal",color:"bg-gray-500"},{label:"Condemn",color:"bg-black"}],{data:n,setData:r,put:h,processing:b,errors:l}=R({equipment_code:i.equipment_code||"",equipment_name:i.equipment_name||"",brand:i.brand||"",type:i.type||"",condition:i.condition||"",room_id:i.room_id||""}),m=j.map(t=>t.label),N=t=>{t.preventDefault(),h(route("equipments.update",i.equipment_code),{onSuccess:()=>{k.fire("Updated!","Equipment updated successfully.","success"),d()}})};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Edit Equipment"}),e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Equipment Code"}),e.jsx(E,{value:n.equipment_code,onChange:t=>r("equipment_code",t.target.value),disabled:!0}),l.equipment_code&&e.jsx("p",{className:"text-red-500 text-sm",children:l.equipment_code})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Equipment Name"}),e.jsx(E,{value:n.equipment_name,onChange:t=>r("equipment_name",t.target.value)}),l.equipment_name&&e.jsx("p",{className:"text-red-500 text-sm",children:l.equipment_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Brand"}),e.jsx(E,{value:n.brand,onChange:t=>r("brand",t.target.value)}),l.brand&&e.jsx("p",{className:"text-red-500 text-sm",children:l.brand})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type"}),e.jsxs("select",{className:"w-full border rounded px-2 py-1",value:n.type,onChange:t=>{r("type",t.target.value),r("condition","")},children:[e.jsx("option",{value:"",children:"Select Type"}),o.map(t=>e.jsx("option",{value:t,children:t},t))]}),l.type&&e.jsx("p",{className:"text-red-500 text-sm",children:l.type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Condition"}),e.jsxs("select",{className:`w-full border rounded px-2 py-1 ${j.find(t=>t.label===n.condition)?.color||""}`,value:n.condition,onChange:t=>r("condition",t.target.value),disabled:!n.type,children:[e.jsx("option",{value:"",children:n.type?"Select Condition":"Select a type first"}),m.map(t=>e.jsx("option",{value:t,children:t},t))]}),l.condition&&e.jsx("p",{className:"text-red-500 text-sm",children:l.condition})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Room"}),e.jsxs("select",{className:"w-full border rounded px-2 py-1",value:n.room_id,onChange:t=>r("room_id",t.target.value),children:[e.jsx("option",{value:"",children:"Select Room"}),x.map(t=>e.jsxs("option",{value:t.id,children:["Room ",t.room_number]},t.id))]}),l.room_id&&e.jsx("p",{className:"text-red-500 text-sm",children:l.room_id})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(c,{type:"button",variant:"outline",onClick:d,disabled:b,children:"Cancel"}),e.jsx(c,{type:"submit",disabled:b,children:"Save"})]})]})]})})}export{De as default};
