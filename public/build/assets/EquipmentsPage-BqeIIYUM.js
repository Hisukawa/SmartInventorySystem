import{r as f,u as P,j as e,b as S}from"./app-C0XdXA0J.js";import{B as c}from"./button-BPqFPK39.js";import{A as O}from"./app-sidebar-Ck5rTmDK.js";import{S as A,a as I}from"./index-zMHTj9UI.js";import{c as B}from"./createLucideIcon-BCu-nbLj.js";import{S as _}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{I as E}from"./input-DqOQop4i.js";import{T as F,a as M,b as w,c as b,d as U,e as h}from"./table-D_aESPQC.js";import"./breadcrumb-qTgwz4yN.js";import{P as H,a as L,b as $,S as g,c as y,d as N,e as C,f as u}from"./select-Y12CvIO-.js";import{X as K}from"./index-BRMVOgf5.js";import"./index-j3oB_HmV.js";import"./chevron-right-ooT0d6gX.js";import"./dropdown-menu-CQp2Hajl.js";import"./index-C1_Jc2EK.js";import"./index-CAwKmQg7.js";import"./index-Chgum_Jf.js";import"./index-BtmB9NlC.js";import"./index-B-VHIbCJ.js";import"./index-Br6QqdWa.js";const D=[{label:"Functional",color:"bg-green-500"},{label:"Defective",color:"bg-red-500"},{label:"Under Maintenance",color:"bg-yellow-500"},{label:"Needs Upgrade",color:"bg-blue-500"},{label:"For Disposal",color:"bg-gray-500"}];function X({filters:i,filterOptions:d,onApplyFilters:r}){const[n,m]=f.useState(""),[a,x]=f.useState(""),o=s=>{const p=s==="all"?"":s;x(p),n==="type"?r({...i,type:p}):n==="condition"?r({...i,condition:p}):n==="room"&&r({...i,room_id:p})},j=()=>{m(""),x(""),r({type:"",condition:"",room_id:""})};return e.jsxs(H,{children:[e.jsx(L,{asChild:!0,children:e.jsx(c,{variant:"outline",size:"sm",children:"Filters"})}),e.jsx($,{className:"w-72",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(g,{value:n,onValueChange:s=>{m(s),x("")},children:[e.jsx(y,{children:e.jsx(N,{placeholder:"Select filter field"})}),e.jsxs(C,{children:[e.jsx(u,{value:"type",children:"Type"}),e.jsx(u,{value:"condition",children:"Condition"}),e.jsx(u,{value:"room",children:"Room"})]})]}),n==="type"&&e.jsxs(g,{value:a||"all",onValueChange:o,children:[e.jsx(y,{children:e.jsx(N,{placeholder:"Select Type"})}),e.jsxs(C,{children:[e.jsx(u,{value:"all",children:"All"}),d.types.map(s=>e.jsx(u,{value:s,children:s},s))]})]}),n==="condition"&&e.jsxs(g,{value:a||"all",onValueChange:o,children:[e.jsx(y,{children:e.jsx(N,{placeholder:"Select Condition"})}),e.jsxs(C,{children:[e.jsx(u,{value:"all",children:"All"}),d.conditions.map(s=>e.jsx(u,{value:s,children:s},s))]})]}),n==="room"&&e.jsxs(g,{value:a||"all",onValueChange:o,children:[e.jsx(y,{children:e.jsx(N,{placeholder:"Select Room"})}),e.jsxs(C,{children:[e.jsx(u,{value:"all",children:"All"}),Object.entries(d.rooms).map(([s,p])=>e.jsxs(u,{value:s,children:["Room ",p]},s))]})]}),(n||a)&&e.jsx("div",{className:"flex justify-end",children:e.jsxs(c,{size:"sm",variant:"outline",onClick:j,className:"flex items-center gap-1 text-red-600 hover:bg-red-50",children:[e.jsx(K,{className:"w-4 h-4"}),"Reset"]})})]})})]})}function he({equipments:i,existingRooms:d,filters:r={}}){const[n,m]=f.useState(""),[a,x]=f.useState(1),[o,j]=f.useState(null),s=10,{delete:p}=P(),R=f.useMemo(()=>{const t=l=>[...new Set(l.filter(Boolean))].sort();return{types:t(i.map(l=>l.type)),conditions:t(i.map(l=>l.condition)),rooms:Object.fromEntries(d.map(l=>[String(l.id),l.room_number]))}},[i,d]);function q(t){const l=Object.fromEntries(Object.entries({...t,search:n||void 0}).filter(([,v])=>v!==""&&v!==void 0));S.get("/equipments",l,{preserveState:!0,replace:!0})}const T=Math.ceil(i.length/s)||1,k=i.slice((a-1)*s,a*s),V=t=>{const l=D.find(v=>v.label.toLowerCase()===t.toLowerCase());return l?l.color:"bg-muted"};function z(t){_.fire({title:"Are you sure?",text:`Delete equipment ${t.equipment_code}?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!"}).then(l=>{l.isConfirmed&&p(route("equipments.destroy",t.equipment_code),{onSuccess:()=>{_.fire("Deleted!","Equipment has been deleted.","success")}})})}return e.jsxs(A,{children:[e.jsx(O,{}),e.jsx(I,{children:e.jsxs("main",{className:"w-full px-6 py-4",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Equipments"}),e.jsxs("div",{className:"flex justify-between items-center mb-4 gap-2",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(X,{filters:r,filterOptions:R,onApplyFilters:q}),e.jsx(E,{placeholder:"Search Equipment Code...",value:n,onChange:t=>m(t.target.value),onKeyDown:t=>t.key==="Enter"&&q(r),className:"text-sm sm:text-base px-2 sm:px-3 py-1 sm:py-2 flex-1 max-w-xs"})]}),e.jsx(c,{className:"text-sm sm:text-base px-3 py-1 sm:py-2",onClick:()=>S.visit("/equipments/addequipment"),children:"Add Equipment"})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border",children:e.jsxs(F,{children:[e.jsx(M,{children:e.jsxs(w,{children:[e.jsx(b,{children:"#"}),e.jsx(b,{children:"Equipment Code"}),e.jsx(b,{children:"Room"}),e.jsx(b,{children:"Type"}),e.jsx(b,{children:"Condition"}),e.jsx(b,{className:"text-center",children:"Actions"})]})}),e.jsx(U,{children:k.length>0?k.map((t,l)=>e.jsxs(w,{children:[e.jsx(h,{children:(a-1)*s+l+1}),e.jsx(h,{children:t.equipment_code}),e.jsxs(h,{children:["ROOM"," ",t.room?.room_number||"N/A"]}),e.jsx(h,{children:t.type}),e.jsx(h,{children:t.condition&&e.jsxs("div",{className:"mt-1 text-sm flex items-center gap-2",children:[e.jsx("span",{className:B("inline-block w-3 h-3 rounded-full",V(t.condition))}),e.jsx("span",{className:"capitalize",children:t.condition})]})}),e.jsx(h,{className:"text-center",children:e.jsxs("div",{className:"hidden sm:flex gap-2 justify-center",children:[e.jsx(c,{size:"sm",variant:"secondary",onClick:()=>S.visit(`/equipments/view/${t.equipment_code}`),children:"View"}),e.jsx(c,{size:"sm",variant:"secondary",onClick:()=>j(t),children:"Edit"}),e.jsx(c,{size:"sm",variant:"destructive",onClick:()=>z(t),children:"Delete"})]})})]},t.id)):e.jsx(w,{children:e.jsx(h,{colSpan:6,className:"text-center py-4",children:"No equipments found."})})})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mt-4 gap-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",a," of ",T]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{size:"sm",variant:"outline",disabled:a===1,onClick:()=>x(t=>t-1),children:"Previous"}),e.jsx(c,{size:"sm",variant:"outline",disabled:a===T,onClick:()=>x(t=>t+1),children:"Next"})]})]}),o&&e.jsx(Y,{equipment:o,rooms:d,onClose:()=>j(null)})]})})]})}function Y({equipment:i,rooms:d,onClose:r}){const{data:n,setData:m,put:a,processing:x,errors:o}=P({equipment_code:i.equipment_code||"",type:i.type||"",condition:i.condition||"",room_id:i.room_id||""}),j=s=>{s.preventDefault(),a(route("equipments.update",i.equipment_code),{onSuccess:()=>{_.fire("Updated!","Equipment updated successfully.","success"),r()}})};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Edit Equipment"}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Equipment Code"}),e.jsx(E,{value:n.equipment_code,onChange:s=>m("equipment_code",s.target.value)}),o.equipment_code&&e.jsx("p",{className:"text-red-500 text-sm",children:o.equipment_code})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type"}),e.jsx(E,{value:n.type,onChange:s=>m("type",s.target.value)}),o.type&&e.jsx("p",{className:"text-red-500 text-sm",children:o.type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Condition"}),e.jsxs("select",{className:"w-full border rounded px-2 py-1",value:n.condition,onChange:s=>m("condition",s.target.value),children:[e.jsx("option",{value:"",children:"Select Condition"}),D.map(s=>e.jsx("option",{value:s.label,children:s.label},s.label))]}),o.condition&&e.jsx("p",{className:"text-red-500 text-sm",children:o.condition})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Room"}),e.jsxs("select",{className:"w-full border rounded px-2 py-1",value:n.room_id,onChange:s=>m("room_id",s.target.value),children:[e.jsx("option",{value:"",children:"Select Room"}),d.map(s=>e.jsxs("option",{value:s.id,children:["Room ",s.room_number]},s.id))]}),o.room_id&&e.jsx("p",{className:"text-red-500 text-sm",children:o.room_id})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(c,{type:"button",variant:"outline",onClick:r,disabled:x,children:"Cancel"}),e.jsx(c,{type:"submit",disabled:x,children:"Save"})]})]})]})})}export{he as default};
