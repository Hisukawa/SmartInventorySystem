import{r as v,u as B,j as e,b as w,R as A}from"./app-C14pEbIc.js";import{B as o}from"./button-Cw8qonis.js";import{A as O}from"./app-sidebar-J7-TOyzA.js";import{S as I,a as F,b as M,c as L}from"./index-EtwFZ-9e.js";import{c as U}from"./createLucideIcon-DD4XNeQi.js";import{S as E}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{I as q}from"./input-BDv_Pay6.js";import{T as H,a as $,b as _,c as f,d as K,e as j}from"./table-DZvbDZP_.js";import{B as X,a as Y,b as G,c as P,d as J}from"./breadcrumb-DvTs8vkP.js";import{P as Q,a as W,b as Z,S as N,c as y,d as S,e as C,f as u}from"./select-Dug7gIvE.js";import{X as ee}from"./index-B8veTWXp.js";import"./index-SLsyAYoV.js";import"./chevron-right-BHCys-vX.js";import"./dropdown-menu-C70s4moA.js";import"./index-Br9z1QJI.js";import"./index-DjpBsoSC.js";import"./index-B618UseJ.js";import"./index-DBxdUadj.js";import"./index-C7BKEmSB.js";import"./index-qr7Lzce4.js";const R=[{label:"Functional",color:"bg-green-500"},{label:"Defective",color:"bg-red-500"},{label:"Under Maintenance",color:"bg-yellow-500"},{label:"Needs Upgrade",color:"bg-blue-500"},{label:"For Disposal",color:"bg-gray-500"}];function se({filters:a,filterOptions:m,onApplyFilters:c}){const[n,x]=v.useState(""),[i,d]=v.useState(""),r=t=>{const h=t==="all"?"":t;d(h),n==="type"?c({...a,type:h}):n==="condition"?c({...a,condition:h}):n==="room"&&c({...a,room_id:h})},b=()=>{x(""),d(""),c({type:"",condition:"",room_id:""})};return e.jsxs(Q,{children:[e.jsx(W,{asChild:!0,children:e.jsx(o,{variant:"outline",size:"sm",children:"Filters"})}),e.jsx(Z,{className:"w-72",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(N,{value:n,onValueChange:t=>{x(t),d("")},children:[e.jsx(y,{children:e.jsx(S,{placeholder:"Select filter field"})}),e.jsxs(C,{children:[e.jsx(u,{value:"type",children:"Type"}),e.jsx(u,{value:"condition",children:"Condition"}),e.jsx(u,{value:"room",children:"Room"})]})]}),n==="type"&&e.jsxs(N,{value:i||"all",onValueChange:r,children:[e.jsx(y,{children:e.jsx(S,{placeholder:"Select Type"})}),e.jsxs(C,{children:[e.jsx(u,{value:"all",children:"All"}),m.types.map(t=>e.jsx(u,{value:t,children:t},t))]})]}),n==="condition"&&e.jsxs(N,{value:i||"all",onValueChange:r,children:[e.jsx(y,{children:e.jsx(S,{placeholder:"Select Condition"})}),e.jsxs(C,{children:[e.jsx(u,{value:"all",children:"All"}),m.conditions.map(t=>e.jsx(u,{value:t,children:t},t))]})]}),n==="room"&&e.jsxs(N,{value:i||"all",onValueChange:r,children:[e.jsx(y,{children:e.jsx(S,{placeholder:"Select Room"})}),e.jsxs(C,{children:[e.jsx(u,{value:"all",children:"All"}),Object.entries(m.rooms).map(([t,h])=>e.jsxs(u,{value:t,children:["Room ",h]},t))]})]}),(n||i)&&e.jsx("div",{className:"flex justify-end",children:e.jsxs(o,{size:"sm",variant:"outline",onClick:b,className:"flex items-center gap-1 text-red-600 hover:bg-red-50",children:[e.jsx(ee,{className:"w-4 h-4"}),"Reset"]})})]})})]})}function Se({equipments:a,existingRooms:m,filters:c={}}){const[n,x]=v.useState(""),[i,d]=v.useState(1),[r,b]=v.useState(null),t=10,{delete:h}=B(),z=v.useMemo(()=>{const s=l=>[...new Set(l.filter(Boolean))].sort();return{types:s(a.map(l=>l.type)),conditions:s(a.map(l=>l.condition)),rooms:Object.fromEntries(m.map(l=>[String(l.id),l.room_number]))}},[a,m]);function k(s){const l=Object.fromEntries(Object.entries({...s,search:n||void 0}).filter(([,p])=>p!==""&&p!==void 0));w.get("/equipments",l,{preserveState:!0,replace:!0})}const g=Math.ceil(a.length/t)||1,T=a.slice((i-1)*t,i*t),D=s=>{const l=R.find(p=>p.label.toLowerCase()===s.toLowerCase());return l?l.color:"bg-muted"};function V(s){E.fire({title:"Are you sure?",text:`Delete equipment ${s.equipment_code}?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!"}).then(l=>{l.isConfirmed&&h(route("equipments.destroy",s.equipment_code),{onSuccess:()=>{E.fire("Deleted!","Equipment has been deleted.","success")}})})}return e.jsxs(I,{children:[e.jsx(O,{}),e.jsxs(F,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx(M,{}),e.jsx(L,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(X,{children:e.jsx(Y,{children:e.jsxs(G,{children:[e.jsx(P,{href:"#",children:"Assets"}),e.jsx(J,{}),e.jsx(P,{href:"/equipments","aria-current":"page",className:"font-semibold text-foreground",children:"Equipments"})]})})})]}),e.jsxs("main",{className:"w-full px-6 py-4",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Equipments"}),e.jsxs("div",{className:"flex justify-between items-center mb-4 gap-2",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(se,{filters:c,filterOptions:z,onApplyFilters:k}),e.jsx(q,{placeholder:"Search Equipment Code...",value:n,onChange:s=>x(s.target.value),onKeyDown:s=>s.key==="Enter"&&k(c),className:"text-sm sm:text-base px-2 sm:px-3 py-1 sm:py-2 flex-1 max-w-xs"})]}),e.jsx(o,{className:"text-sm sm:text-base px-3 py-1 sm:py-2",onClick:()=>w.visit("/equipments/addequipment"),children:"Add Equipment"})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border",children:e.jsxs(H,{children:[e.jsx($,{children:e.jsxs(_,{children:[e.jsx(f,{children:"#"}),e.jsx(f,{children:"Equipment Code"}),e.jsx(f,{children:"Room"}),e.jsx(f,{children:"Type"}),e.jsx(f,{children:"Condition"}),e.jsx(f,{className:"text-center",children:"Actions"})]})}),e.jsx(K,{children:T.length>0?T.map((s,l)=>e.jsxs(_,{children:[e.jsx(j,{children:(i-1)*t+l+1}),e.jsx(j,{children:s.equipment_code}),e.jsxs(j,{children:["ROOM"," ",s.room?.room_number||"N/A"]}),e.jsx(j,{children:s.type}),e.jsx(j,{children:s.condition&&e.jsxs("div",{className:"mt-1 text-sm flex items-center gap-2",children:[e.jsx("span",{className:U("inline-block w-3 h-3 rounded-full",D(s.condition))}),e.jsx("span",{className:"capitalize",children:s.condition})]})}),e.jsx(j,{className:"text-center",children:e.jsxs("div",{className:"hidden sm:flex gap-2 justify-center",children:[e.jsx(o,{size:"sm",variant:"secondary",onClick:()=>w.visit(`/equipments/view/${s.equipment_code}`),children:"View"}),e.jsx(o,{size:"sm",variant:"secondary",onClick:()=>b(s),children:"Edit"}),e.jsx(o,{size:"sm",variant:"destructive",onClick:()=>V(s),children:"Delete"})]})})]},s.id)):e.jsx(_,{children:e.jsx(j,{colSpan:6,className:"text-center py-4",children:"No equipments found."})})})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mt-4 gap-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",i," of ",g]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(o,{size:"sm",variant:"outline",disabled:i===1,onClick:()=>d(s=>s-1),children:"Previous"}),Array.from({length:g},(s,l)=>l+1).filter(s=>s===1||s===g?!0:s>=i-2&&s<=i+2).map((s,l,p)=>e.jsxs(A.Fragment,{children:[l>0&&p[l]-p[l-1]>1&&e.jsx("span",{className:"px-1",children:"..."}),e.jsx(o,{size:"sm",variant:i===s?"default":"outline",onClick:()=>d(s),children:s})]},s)),e.jsx(o,{size:"sm",variant:"outline",disabled:i===g,onClick:()=>d(s=>s+1),children:"Next"})]})]}),r&&e.jsx(te,{equipment:r,rooms:m,onClose:()=>b(null)})]})]})]})}function te({equipment:a,rooms:m,onClose:c}){const{data:n,setData:x,put:i,processing:d,errors:r}=B({equipment_code:a.equipment_code||"",type:a.type||"",condition:a.condition||"",room_id:a.room_id||""}),b=t=>{t.preventDefault(),i(route("equipments.update",a.equipment_code),{onSuccess:()=>{E.fire("Updated!","Equipment updated successfully.","success"),c()}})};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Edit Equipment"}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Equipment Code"}),e.jsx(q,{value:n.equipment_code,onChange:t=>x("equipment_code",t.target.value)}),r.equipment_code&&e.jsx("p",{className:"text-red-500 text-sm",children:r.equipment_code})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type"}),e.jsx(q,{value:n.type,onChange:t=>x("type",t.target.value)}),r.type&&e.jsx("p",{className:"text-red-500 text-sm",children:r.type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Condition"}),e.jsxs("select",{className:"w-full border rounded px-2 py-1",value:n.condition,onChange:t=>x("condition",t.target.value),children:[e.jsx("option",{value:"",children:"Select Condition"}),R.map(t=>e.jsx("option",{value:t.label,children:t.label},t.label))]}),r.condition&&e.jsx("p",{className:"text-red-500 text-sm",children:r.condition})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Room"}),e.jsxs("select",{className:"w-full border rounded px-2 py-1",value:n.room_id,onChange:t=>x("room_id",t.target.value),children:[e.jsx("option",{value:"",children:"Select Room"}),m.map(t=>e.jsxs("option",{value:t.id,children:["Room ",t.room_number]},t.id))]}),r.room_id&&e.jsx("p",{className:"text-red-500 text-sm",children:r.room_id})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(o,{type:"button",variant:"outline",onClick:c,disabled:d,children:"Cancel"}),e.jsx(o,{type:"submit",disabled:d,children:"Save"})]})]})]})})}export{Se as default};
