import{r as u,j as e,L as R,R as I,b as _}from"./app-C14pEbIc.js";import{B as h}from"./button-Cw8qonis.js";import{C as L,c as M}from"./card-B5T1P_9G.js";import{S as D,a as O,b as U,c as $}from"./index-EtwFZ-9e.js";import{S as q}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{T as H,a as K,b as w,c as o,d as X,e as t}from"./table-DZvbDZP_.js";import{B as Y,a as G,b as J,c as k,d as Q}from"./breadcrumb-DvTs8vkP.js";import{A as W}from"./app-sidebar-J7-TOyzA.js";import{I as Z}from"./input-BDv_Pay6.js";import ee from"./EditPeripheralModal-CvUlCTBn.js";import{P as re,a as se,b as ie,S as f,c as v,d as b,e as S,f as n}from"./select-Dug7gIvE.js";import{F as le}from"./funnel-BE0FmFtT.js";import{X as ne}from"./index-B8veTWXp.js";import"./index-SLsyAYoV.js";import"./createLucideIcon-DD4XNeQi.js";import"./index-Br9z1QJI.js";import"./index-DjpBsoSC.js";import"./index-B618UseJ.js";import"./dropdown-menu-C70s4moA.js";import"./index-DBxdUadj.js";import"./chevron-right-BHCys-vX.js";import"./index-C7BKEmSB.js";import"./dialog-Clcedail.js";import"./label-CNoom4Ip.js";import"./index-qr7Lzce4.js";function ae({filters:l,filterOptions:j,onApplyFilters:c}){const[m,p]=u.useState(""),x=()=>{const s={type:void 0,condition:void 0,room_id:void 0,unit_code:void 0};p(""),c(s)};return e.jsxs(re,{children:[e.jsx(se,{asChild:!0,children:e.jsxs(h,{variant:"outline",size:"sm",children:[e.jsx(le,{className:"mr-2 h-4 w-4"}),"Filters"]})}),e.jsx(ie,{className:"w-72",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(f,{value:m,onValueChange:p,children:[e.jsx(v,{children:e.jsx(b,{placeholder:"Select filter field"})}),e.jsxs(S,{children:[e.jsx(n,{value:"type",children:"Type"}),e.jsx(n,{value:"condition",children:"Condition"}),e.jsx(n,{value:"room",children:"Room"}),e.jsx(n,{value:"unit",children:"Unit"})]})]}),m==="type"&&e.jsxs(f,{value:l.type||"all",onValueChange:s=>c({...l,type:s==="all"?void 0:s}),children:[e.jsx(v,{children:e.jsx(b,{placeholder:"Select Type"})}),e.jsxs(S,{children:[e.jsx(n,{value:"all",children:"All"}),j.types.map(s=>e.jsx(n,{value:s,children:s},s))]})]}),m==="condition"&&e.jsxs(f,{value:l.condition||"all",onValueChange:s=>c({...l,condition:s==="all"?void 0:s}),children:[e.jsx(v,{children:e.jsx(b,{placeholder:"Select Condition"})}),e.jsxs(S,{children:[e.jsx(n,{value:"all",children:"All"}),j.conditions.map(s=>e.jsx(n,{value:s,children:s},s))]})]}),m==="room"&&e.jsxs(f,{value:l.room_id||"all",onValueChange:s=>c({...l,room_id:s==="all"?void 0:s}),children:[e.jsx(v,{children:e.jsx(b,{placeholder:"Select Room"})}),e.jsxs(S,{children:[e.jsx(n,{value:"all",children:"All"}),Object.entries(j.rooms).map(([s,C])=>e.jsxs(n,{value:s,children:["Room ",C]},s))]})]}),m==="unit"&&e.jsxs(f,{value:l.unit_code||"all",onValueChange:s=>c({...l,unit_code:s==="all"?void 0:s}),children:[e.jsx(v,{children:e.jsx(b,{placeholder:"Select Unit"})}),e.jsxs(S,{children:[e.jsx(n,{value:"all",children:"All"}),j.units.map(s=>e.jsx(n,{value:s,children:s},s))]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(h,{size:"sm",variant:"outline",onClick:x,className:"flex items-center gap-1",children:[e.jsx(ne,{className:"h-4 w-4"}),"Reset All"]})})]})})]})}function ke({peripherals:l,search:j,existingRooms:c,existingUnits:m,filters:p={}}){const[x,s]=u.useState(j||""),[C,y]=u.useState(null),[a,P]=u.useState(1),g=10,z=u.useMemo(()=>{const r=i=>[...new Set(i.filter(d=>d))].sort();return{types:r(l.map(i=>i.type)),conditions:r(l.map(i=>i.condition)),rooms:Object.fromEntries(c.map(i=>[String(i.id),i.room_number])),units:r(l.map(i=>i.unit_code))}},[l,c]);function T(r){const i=Object.fromEntries(Object.entries({...r,search:x||void 0}).filter(([,d])=>d!==""&&d!==void 0));_.get("/admin/peripherals",i,{preserveState:!0,replace:!0})}function E(){s(""),_.get("/admin/peripherals",{},{preserveState:!0,replace:!0})}const V=r=>{r.key==="Enter"&&T(p)},B=u.useMemo(()=>{if(!x)return l;const r=x.toLowerCase();return l.filter(i=>[i.peripheral_code,i.type,i.serial_number,i.condition,i.room?.room_number,i.unit_code].filter(Boolean).some(d=>d.toLowerCase().includes(r)))},[l,x]),N=Math.ceil(B.length/g)||1,A=B.slice((a-1)*g,a*g);function F(r){q.fire({title:"Are you sure?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(i=>{i.isConfirmed&&_.delete(`/admin/peripherals/${r}`)})}return e.jsxs(D,{children:[e.jsx(W,{}),e.jsxs(O,{children:[e.jsxs("header",{className:"flex h-16 items-center gap-2 px-4 border-b bg-white",children:[e.jsx(U,{}),e.jsx($,{orientation:"vertical",className:"h-6 mx-3"}),e.jsx(Y,{children:e.jsx(G,{children:e.jsxs(J,{children:[e.jsx(k,{href:"#",children:"Assets"}),e.jsx(Q,{}),e.jsx(k,{href:"/admin/peripherals","aria-current":"page",className:"font-semibold text-foreground",children:"Peripherals"})]})})})]}),e.jsx("main",{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-5",children:"Peripherals"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(ae,{filters:p,filterOptions:z,onApplyFilters:T,onReset:E}),e.jsx(Z,{placeholder:"Search peripherals...",value:x,onChange:r=>s(r.target.value),onKeyDown:V,className:"w-64"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(R,{href:"/admin/peripherals/create",children:e.jsx(h,{children:"Add Peripheral"})})})]}),e.jsx(L,{children:e.jsxs(M,{children:[e.jsxs(H,{children:[e.jsx(K,{children:e.jsxs(w,{children:[e.jsx(o,{children:"#"}),e.jsx(o,{children:"Peripheral Code"}),e.jsx(o,{children:"Type"}),e.jsx(o,{children:"Brand"}),e.jsx(o,{children:"Model"}),e.jsx(o,{children:"Serial Number"}),e.jsx(o,{children:"Condition"}),e.jsx(o,{children:"Room"}),e.jsx(o,{children:"Units"}),e.jsx(o,{children:"Actions"})]})}),e.jsx(X,{children:A.length>0?A.map((r,i)=>e.jsxs(w,{children:[e.jsx(t,{children:(a-1)*g+i+1}),e.jsx(t,{children:r.peripheral_code}),e.jsx(t,{children:r.type}),e.jsx(t,{children:r.brand}),e.jsx(t,{children:r.model}),e.jsx(t,{children:r.serial_number}),e.jsx(t,{children:r.condition}),e.jsx(t,{children:r.room?`ROOM ${r.room.room_number}`:"N/A"}),e.jsx(t,{children:r.unit_code}),e.jsxs(t,{className:"space-x-2",children:[e.jsx(R,{href:`/admin/peripherals/${r.id}`,children:e.jsx(h,{variant:"secondary",size:"sm",children:"View"})}),e.jsx(h,{variant:"outline",size:"sm",onClick:()=>y(r),children:"Edit"}),e.jsx(h,{variant:"destructive",size:"sm",onClick:()=>F(r.id),children:"Delete"})]})]},r.id)):e.jsx(w,{children:e.jsx(t,{colSpan:"8",className:"text-center",children:"No peripherals found."})})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",a," of ",N]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{size:"sm",variant:"outline",disabled:a===1,onClick:()=>P(a-1),children:"Previous"}),Array.from({length:N},(r,i)=>i+1).filter(r=>r===1||r===N?!0:r>=a-2&&r<=a+2).map((r,i,d)=>e.jsxs(I.Fragment,{children:[i>0&&d[i]-d[i-1]>1&&e.jsx("span",{className:"px-2",children:"..."}),e.jsx(h,{size:"sm",variant:a===r?"default":"outline",onClick:()=>P(r),children:r})]},r)),e.jsx(h,{size:"sm",variant:"outline",disabled:a===N,onClick:()=>P(a+1),children:"Next"})]})]})]})})]})}),C&&e.jsx(ee,{peripheral:C,rooms:c,units:m,onClose:()=>y(null)})]})]})}export{ke as default};
